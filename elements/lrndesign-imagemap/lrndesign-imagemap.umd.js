!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@polymer/polymer/polymer-element.js"),require("@polymer/polymer/lib/utils/render-status.js"),require("@polymer/polymer/lib/legacy/polymer.dom.js"),require("@polymer/iron-ajax/iron-ajax.js"),require("@polymer/iron-a11y-keys/iron-a11y-keys.js"),require("@lrnwebcomponents/simple-modal/simple-modal.js")):"function"==typeof define&&define.amd?define(["exports","@polymer/polymer/polymer-element.js","@polymer/polymer/lib/utils/render-status.js","@polymer/polymer/lib/legacy/polymer.dom.js","@polymer/iron-ajax/iron-ajax.js","@polymer/iron-a11y-keys/iron-a11y-keys.js","@lrnwebcomponents/simple-modal/simple-modal.js"],t):t((e=e||self).LrndesignImagemap={},e.polymerElement_js,null,e.polymer_dom_js)}(this,function(e,t,n,o){"use strict";function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e,t,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e}(e,t);if(o){var l=Object.getOwnPropertyDescriptor(o,t);return l.get?l.get.call(n):l.value}})(e,t,n||e)}function d(){var e,t,n=(e=['\n    <style>\n      :host {\n        display: block;\n      }\n      :host #buttons {\n        position: absolute;\n        left: -999999px;\n        top: 0;\n        overflow: hidden;\n        opacity: 0;\n      }\n      /*::slotted([hotspot]) {\n        display: none;\n      }*/\n      @media print {\n        :host > #svg {\n          display: none;\n        }\n        /*::slotted(#screen-only) {\n          display: none;\n        }\n        ::slotted([hotspot]) {\n          display: block;\n        }*/\n      }\n    </style>\n    <relative-heading\n      hidden$="[[!label]]"\n      id="heading"\n      subtopic-of$="[[subtopicOf]]"\n      tag$="[[tag]]"\n      text$="[[label]]"\n    >\n    </relative-heading>\n    <div id="desc"><slot name="desc"></slot></div>\n    <div id="svg"></div>\n    <div id="buttons"></div>\n    <slot></slot>\n    <iron-ajax\n      auto=""\n      id="get_svg"\n      url="[[src]]"\n      handle-as="text"\n      on-response="_getSVGHandler"\n    ></iron-ajax>'],(t=['\n    <style>\n      :host {\n        display: block;\n      }\n      :host #buttons {\n        position: absolute;\n        left: -999999px;\n        top: 0;\n        overflow: hidden;\n        opacity: 0;\n      }\n      /*::slotted([hotspot]) {\n        display: none;\n      }*/\n      @media print {\n        :host > #svg {\n          display: none;\n        }\n        /*::slotted(#screen-only) {\n          display: none;\n        }\n        ::slotted([hotspot]) {\n          display: block;\n        }*/\n      }\n    </style>\n    <relative-heading\n      hidden\\$="[[!label]]"\n      id="heading"\n      subtopic-of\\$="[[subtopicOf]]"\n      tag\\$="[[tag]]"\n      text\\$="[[label]]"\n    >\n    </relative-heading>\n    <div id="desc"><slot name="desc"></slot></div>\n    <div id="svg"></div>\n    <div id="buttons"></div>\n    <slot></slot>\n    <iron-ajax\n      auto=""\n      id="get_svg"\n      url="[[src]]"\n      handle-as="text"\n      on-response="_getSVGHandler"\n    ></iron-ajax>'])||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}})));return d=function(){return n},n}var c=function(e){function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),e=s(this,r(n).call(this)),import("@lrnwebcomponents/relative-heading/relative-heading.js"),import("@lrnwebcomponents/lrndesign-imagemap/lib/lrndesign-imagemap-hotspot.js"),e}var c,u,p;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(n,t.PolymerElement),c=n,p=[{key:"template",get:function(){return t.html(d())}},{key:"tag",get:function(){return"lrndesign-imagemap"}},{key:"properties",get:function(){return{label:{type:String,value:null},src:{type:String,value:null},hotspotDetails:{type:Array,value:[]},subtopicOf:{type:String,value:null,reflectToAttribute:!0},tag:{type:String,value:null,reflectToAttribute:!0}}}}],(u=[{key:"connectedCallback",value:function(){var e=this;a(r(n.prototype),"connectedCallback",this).call(this),window.SimpleModal.requestAvailability(),window.addEventListener("simple-modal-closed",function(t){t.detail.invokedBy===e&&e.closeHotspot()})}},{key:"disconnectedCallback",value:function(){var e=this;window.removeEventListener("simple-modal-closed",function(t){t.detail.invokedBy===e&&e.closeHotspot()}),a(r(n.prototype),"disconnectedCallback",this).call(this)}},{key:"_getSVGHandler",value:function(e){var t=this,n=this,l=document.createElement("div"),r=function(e,t){return null===e.getAttribute("id")&&e.setAttribute("id",t),e.getAttribute("id")},i=function(e,t,o){var l=function(l){var i="title"===l?"label":l,s=(e=null!==e?e:n).querySelector("#"+i),a=t.querySelector(l);return null===a&&(a=document.createElement(l),t.prepend(a)),null!==e.getAttribute(i)?a.innerHTML=e.getAttribute(i):null!==s&&""!==s.innerHTML&&(a.innerHTML=s.innerHTML),r(a,o+"-"+i)};t.setAttribute("aria-labelledby",l("desc")+" "+l("label"))};l.innerHTML=e.detail.response;var s=l.querySelector("svg"),a=r(s,"svg-"+Date.now()),d=o.dom(n).querySelectorAll("lrndesign-imagemap-hotspot");i(n,s,a),this.shadowRoot.querySelector("#svg").appendChild(s);for(var c=function(e){var o=d[e].getAttribute("hotspot-id"),l=s.querySelector("#"+o),r=s.cloneNode(!0);i(d[e],r,o),d[e].appendChild(r),d[e].querySelector("#"+o).classList.add("selected"),d[e].setParentHeading(n.shadowRoot.querySelector("#heading"));for(var a=0;a<d.length;a++)d[e].querySelector("#"+d[a].getAttribute("hotspot-id")).classList.add("hotspot");var c=document.createElement("button");c.setAttribute("tabindex",0),c.setAttribute("aria-label",d[e].label),n.shadowRoot.querySelector("#buttons").appendChild(c),c.addEventListener("focus",function(){l.classList.add("focus")}),c.addEventListener("blur",function(){l.classList.remove("focus")}),l.classList.add("hotspot"),l.addEventListener("click",function(n){t.openHotspot(l,d[e])}),c.addEventListener("keyup",function(n){13!==n.keyCode&&32!==n.keyCode||l.classList.contains("selected")||t.openHotspot(l,d[e])})},u=0;u<d.length;u++)c(u)}},{key:"openHotspot",value:function(e,t){var n=t.shadowRoot.querySelector("#desc").querySelector("slot").assignedNodes({flatten:!0}),o=document.createElement("div");for(var l in n)o.appendChild(n[l].cloneNode(!0));var r=new CustomEvent("simple-modal-show",{bubbles:!0,cancelable:!0,detail:{title:t.getAttribute("label"),elements:{content:o},invokedBy:this,clone:!1}});this.dispatchEvent(r),this.__activeHotspot=e,this.resetHotspots(),e.classList.add("selected")}},{key:"closeHotspot",value:function(){this.resetHotspots(),this.__activeHotspot.focus()}},{key:"resetHotspots",value:function(){for(var e=this.querySelectorAll('.hotspot[role="button"]'),t=0;t<e.length;t++)e[t].classList.remove("selected")}}])&&l(c.prototype,u),p&&l(c,p),n}();window.customElements.define(c.tag,c),e.LrndesignImagemap=c,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=lrndesign-imagemap.umd.js.map
