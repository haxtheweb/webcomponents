{"version":3,"file":"filtered-image.umd.js","sources":["filtered-image.umd.js"],"sourcesContent":["/**\n * Copyright 2019 The Pennsylvania State University\n * @license Apache-2.0, see License.md for full text.\n */\nimport { html, PolymerElement } from \"@polymer/polymer/polymer-element.js\";\nimport { SimpleColorsPolymer } from \"@lrnwebcomponents/simple-colors/lib/simple-colors-polymer.js\";\n/**\n * `filtered-image`\n * `An image using an SVG filter. Can be used to make background images have more contrast with text.`\n *\n * @microcopy - language worth noting:\n *  -\n *\n * @customElement\n * @polymer\n * @demo demo/index.html\n * @demo demo/filters.html Filters\n */\nclass FilteredImage extends SimpleColorsPolymer {\n  \n  // render function\n  static get template() {\n    return html`\n<style>\n:host {\n  display: block;\n}\n:host([hidden]) {\n  display: none;\n}\n        </style>\n<style>\n</style>\n<svg id=\"svg\" viewBox$=\"[[viewBox]]\"> \n  <rect id=\"rect\" x=\"0\" y=\"0\"></rect>\n  <filter id$=\"[[__id]]\">\n    <feColorMatrix\n      id=\"matrix\"\n      type=\"matrix\"\n      values=\" 1   0   0   0   0\n               0   1   0   0   0\n               0   0   1   0   0\n               0   0   0   1   0 \"/>\n\n  </filter>      \n  <image id=\"image\" filter$=\"url(#[[__id]])\" x=\"0\" y=\"0\"></image>\n</svg>`;\n  }\n\n  // haxProperty definition\n  static get haxProperties() {\n    return {\n  \"canScale\": true,\n  \"canPosition\": true,\n  \"canEditSource\": false,\n  \"gizmo\": {\n    \"title\": \"Filtered image\",\n    \"description\": \"An image using an SVG filter. Can be used to make background images have more contrast with text.\",\n    \"icon\": \"icons:android\",\n    \"color\": \"green\",\n    \"groups\": [\"Image\"],\n    \"handles\": [\n      {\n        \"type\": \"todo:read-the-docs-for-usage\"\n      }\n    ],\n    \"meta\": {\n      \"author\": \"nikkimk\",\n      \"owner\": \"The Pennsylvania State University\"\n    }\n  },\n  \"settings\": {\n    \"quick\": [\n      {\n        \"property\": \"src\",\n        \"description\": \"\",\n        \"inputMethod\": \"textfield\",\n        \"required\": true,\n        \"icon\": \"icons:link\",\n        \"validationType\": \"url\"\n      },\n      {\n        \"property\": \"alt\",\n        \"description\": \"\",\n        \"inputMethod\": \"alt\",\n        \"required\": true,\n        \"icon\": \"icons:accessibility\"\n      }\n    ],\n    \"configure\": [\n      {\n        \"property\": \"src\",\n        \"description\": \"\",\n        \"inputMethod\": \"textfield\",\n        \"required\": true,\n        \"icon\": \"icons:link\",\n        \"validationType\": \"url\"\n      },\n      {\n        \"property\": \"alt\",\n        \"description\": \"\",\n        \"inputMethod\": \"alt\",\n        \"required\": true,\n        \"icon\": \"icons:accessibility\"\n      }\n    ],\n    \"advanced\": []\n  }\n}\n;\n  }\n  // properties available to the custom element for data binding\n    static get properties() {\n    let props = {\n  \"src\": {\n    \"name\": \"src\",\n    \"type\": String,\n    \"value\": \"\",\n    \"observer\": \"_srcChanged\"\n  },\n  \"__id\": {\n    \"name\": \"__id\",\n    \"type\": String,\n    \"computed\": \"_getID(src,matrix)\"\n  },\n  \"alt\": {\n    \"name\": \"alt\",\n    \"type\": String,\n    \"value\": \"\"\n  },\n  \"height\": {\n    \"name\": \"width\",\n    \"type\": String,\n    \"value\": \"\",\n    \"observer\": \"_heightChanged\"\n  },\n  \"width\": {\n    \"name\": \"unset\",\n    \"type\": String,\n    \"value\": \"\",\n    \"observer\": \"_widthChanged\"\n  },\n  \"viewBox\": {\n    \"name\": \"viewBox\",\n    \"type\": String,\n    \"computed\": \"_getViewBox(height,width)\"\n  },\n  \"color\": {\n    \"name\": \"color\",\n    \"type\": String,\n    \"value\": \"#ffffff\"\n  },\n  \"strength\": {\n    \"name\": \"strength\",\n    \"type\": Number,\n    \"value\": 1\n  },\n  \"contrast\": {\n    \"name\": \"contrast\",\n    \"type\": Number,\n    \"value\": 0\n  },\n  /*\"__filters\": {\n    \"name\": \"__filters\",\n    \"type\": Array,\n    \"value\": {\n      \"red\": [0.750,0.0500,0.000],\n      \"pink\": [0.650,0.0300,0.270],\n      \"purple\": [0.400,0.000,0.650],\n      \"deep-purple\": [0.175,0.000,0.600],\n      \"indigo\": [0.025,0.000,0.675],\n      \"blue\": [0.000,0.100,0.700],\n      \"light-blue\": [0.000,0.200,0.850],\n      \"cyan\": [0.000,0.450,0.750],\n      \"teal\": [0.000,0.550,0.200],\n      \"green\": [0.000,0.650,0.050],\n      \"light-green\": [0.075,0.625,0.000],\n      \"lime\": [0.250,0.750,0.000],\n      \"yellow\": [0.850,0.850,0.000],\n      \"amber\": [0.800,0.500,0.000],\n      \"orange\": [0.850,0.150,0.000],\n      \"deep-orange\": [0.950,0.050,0.000],\n      \"brown\": [0.200,0.100,0.075],\n      \"blue-grey\": [0.100,0.200,0.300]\n    }\n  },*/\n  \"__matrix\": {\n    \"name\": \"matrix\",\n    \"type\": Array,\n    \"computed\": \"_getMatrix(color,contrast,strength)\"\n  }\n}\n;\n    if (super.properties) {\n      props = Object.assign(props, super.properties);\n    }\n    return props;\n  }\n\n  /**\n   * Store the tag name to make it easier to obtain directly.\n   * @notice function name must be here for tooling to operate correctly\n   */\n  static get tag() {\n    return \"filtered-image\";\n  }\n  /**\n   * life cycle, element is afixed to the DOM\n   */\n  connectedCallback() {\n    super.connectedCallback();\n    this._srcChanged();\n  }\n  _heightChanged() {\n    let svg = this.shadowRoot.querySelector(\"#svg\"),\n      image = svg.querySelector(\"#image\"),\n      rect = svg.querySelector(\"#rect\");\n    svg.setAttribute(\"height\", this.height);\n    image.setAttribute(\"height\", this.height);\n    rect.setAttribute(\"height\", this.height);\n  }\n  _widthChanged() {\n    let svg = this.shadowRoot.querySelector(\"#svg\"),\n      image = svg.querySelector(\"#image\"),\n      rect = svg.querySelector(\"#rect\");\n    svg.setAttribute(\"width\", this.width);\n    image.setAttribute(\"width\", this.width);\n    rect.setAttribute(\"width\", this.width);\n  }\n  _getViewBox(height, width) {\n    return `0 0 ${width} ${height}`;\n  }\n  _srcChanged() {\n    let svg = this.shadowRoot.querySelector(\"#svg\"),\n      image = svg.querySelector(\"#image\");\n    image.setAttribute(\"href\", this.src);\n    image.setAttribute(\"xlink:href\", this.src);\n  }\n  _getMatrix(color, contrast, strength) {\n    let values = [\n        [1, 0, 0, 0, 0],\n        [0, 1, 0, 0, 0],\n        [0, 0, 1, 0, 0],\n        [0, 0, 0, 1, 0]\n      ],\n      svg = this.shadowRoot.querySelector(\"#svg\"),\n      matrix = svg.querySelector(\"#matrix\"),\n      rgba = null;\n    if (color.startsWith(\"#\") && color.length > 6) {\n      if (color.length === 7) color += \"ff\";\n      values[0][0] = parseInt(color.substring(1, 3), 16) / 255;\n      values[1][1] = parseInt(color.substring(3, 5), 16) / 255;\n      values[2][2] = parseInt(color.substring(5, 7), 16) / 255;\n      values[3][3] = parseInt(color.substring(7, 9), 16) / 255;\n    } else if (color.startsWith(\"#\")) {\n      if (color.length === 4) color += \"f\";\n      values[0][0] =\n        parseInt(color.substring(1, 2) + color.substring(1, 2), 16) / 255;\n      values[1][1] =\n        parseInt(color.substring(2, 3) + color.substring(2, 3), 16) / 255;\n      values[2][2] =\n        parseInt(color.substring(3, 4) + color.substring(3, 4), 16) / 255;\n      values[3][3] =\n        parseInt(color.substring(4, 5) + color.substring(4, 5), 16) / 255;\n    } else if (color.startsWith(\"rgb\")) {\n      let temp = color.replace(/rgba?\\(/g, \"\").replace(/\\)/g, \"\");\n      rgba = temp.split(\",\");\n      values[0][0] = parseInt(rgba[0] / 255);\n      values[1][1] = parseInt(rgba[1] / 255);\n      values[2][2] = parseInt(rgba[2] / 255);\n      values[3][3] = values[3][3] || \"1\";\n    }\n    //console.log(values);\n\n    if (contrast !== 0) {\n      values[0][3] = (values[0][0] * contrast) / 100;\n      values[1][3] = (values[1][1] * contrast) / 100;\n      values[2][3] = (values[2][2] * contrast) / 100;\n    }\n    if (strength !== 1) {\n      let adjust = function(val, strength) {\n        let diff = 1 - val,\n          pct = diff / 100,\n          adjustment = pct * (1 - strength);\n        return val + (1 - val) * 0.01 * (1 - strength);\n      };\n      values[0][0] = values[0][0] + (1 - strength) * (1 - values[0][0]);\n      values[1][1] = values[1][1] + (1 - strength) * (1 - values[1][1]);\n      values[2][2] = values[2][2] + (1 - strength) * (1 - values[2][2]);\n    }\n\n    console.log(values);\n\n    matrix.setAttribute(\n      \"values\",\n      JSON.stringify(values).replace(/[,\\[\\]]/g, \" \")\n    );\n    return values;\n  }\n  _getID(src, matrix) {\n    let id = \"svg\" + Math.random();\n    return id.replace(/0./g, \"-\");\n  }\n}\nwindow.customElements.define(FilteredImage.tag, FilteredImage);\nexport { FilteredImage };\n"],"names":["FilteredImage","SimpleColorsPolymer","html","props","String","Number","Array","Object","assign","_srcChanged","svg","this","shadowRoot","querySelector","image","rect","setAttribute","height","width","src","color","contrast","strength","values","matrix","rgba","startsWith","length","parseInt","substring","replace","split","console","log","JSON","stringify","Math","random","window","customElements","define","tag"],"mappings":"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"}