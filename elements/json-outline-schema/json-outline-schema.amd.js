define(["exports","./lib/json-outline-schema-item.js"],function(_exports,_jsonOutlineSchemaItem){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.JsonOutlineSchema=void 0;window.JSONOutlineSchema=window.JSONOutlineSchema||{};window.JSONOutlineSchema.requestAvailability=function(){if(!window.JSONOutlineSchema.instance){window.JSONOutlineSchema.instance=document.createElement("json-outline-schema");document.body.appendChild(window.JSONOutlineSchema.instance)}return window.JSONOutlineSchema.instance};var JsonOutlineSchema=function(_HTMLElement){babelHelpers.inherits(JsonOutlineSchema,_HTMLElement);babelHelpers.createClass(JsonOutlineSchema,[{key:"html",get:function get(){return"\n<style>:host {\n  display: block;\n  font-family: monospace;\n  white-space: pre;\n  margin: 1em 0px;\n}\n\n:host([hidden]) {\n  display: none;\n}\n</style>\n<slot></slot>"}}],[{key:"properties",get:function get(){return{}}},{key:"tag",get:function get(){return"json-outline-schema"}}]);function JsonOutlineSchema(){var _this,delayRender=0<arguments.length&&arguments[0]!==void 0?arguments[0]:!1;babelHelpers.classCallCheck(this,JsonOutlineSchema);_this=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(JsonOutlineSchema).call(this));_this.tag=JsonOutlineSchema.tag;_this._queue=[];_this.template=document.createElement("template");_this.attachShadow({mode:"open"});if(!delayRender){_this.render()}_this.__ready=!1;_this.file=null;_this.id=_this.generateUUID();_this.title="New site";_this.author="";_this.description="";_this.license="by-sa";_this.metadata={};_this.items=[];_this.__debug=!1;window.JSONOutlineSchema.instance=babelHelpers.assertThisInitialized(babelHelpers.assertThisInitialized(_this));return _this}babelHelpers.createClass(JsonOutlineSchema,[{key:"connectedCallback",value:function connectedCallback(){if(window.ShadyCSS){window.ShadyCSS.styleElement(this)}if(this._queue.length){this._processQueue()}window.addEventListener("json-outline-schema-debug-toggle",this._toggleDebug.bind(this));var evt=new CustomEvent("json-outline-schema-ready",{bubbles:!0,cancelable:!1,detail:!0});this.dispatchEvent(evt);this.__ready=!0}},{key:"_copyAttribute",value:function _copyAttribute(name,to){var recipients=this.shadowRoot.querySelectorAll(to),value=this.getAttribute(name),fname=null==value?"removeAttribute":"setAttribute",_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _iterator=recipients[Symbol.iterator](),_step,node;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){node=_step.value;node[fname](name,value)}}catch(err){_didIteratorError=!0;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&null!=_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}}},{key:"_queueAction",value:function _queueAction(action){this._queue.push(action)}},{key:"_processQueue",value:function _processQueue(){var _this2=this;this._queue.forEach(function(action){_this2["_".concat(action.type)](action.data)});this._queue=[]}},{key:"_setProperty",value:function _setProperty(_ref){var name=_ref.name,value=_ref.value;this[name]=value}},{key:"render",value:function render(){this.shadowRoot.innerHTML=null;this.template.innerHTML=this.html;if(window.ShadyCSS){window.ShadyCSS.prepareTemplate(this.template,this.tag)}this.shadowRoot.appendChild(this.template.content.cloneNode(!0))}},{key:"disconnectedCallback",value:function disconnectedCallback(){window.removeEventListener("json-outline-schema-debug-toggle",this._toggleDebug.bind(this));var evt=new CustomEvent("json-outline-schema-unready",{bubbles:!0,cancelable:!1,detail:!0});this.dispatchEvent(evt)}},{key:"clone",value:function clone(){var schema={id:this.id,title:this.title,author:this.author,description:this.description,license:this.license,metadata:this.metadata,items:this.items},obj=JSON.parse(JSON.stringify(schema));return obj}},{key:"newItem",value:function newItem(){return new _jsonOutlineSchemaItem.JSONOutlineSchemaItem}},{key:"addItem",value:function addItem(item){var safeItem=this.validateItem(item);count=array_push(this.items,safeItem);return count}},{key:"validateItem",value:function validateItem(item){var tmp=new _jsonOutlineSchemaItem.JSONOutlineSchemaItem;for(var key in tmp){if(babelHelpers.typeof(item[key])!==("undefined"===typeof void 0?"undefined":babelHelpers.typeof(void 0))){tmp[key]=item[key]}}return tmp}},{key:"removeItem",value:function removeItem(id){for(var key in this.items){if(this.items[key].id==id){var tmp=this.items[key];delete this.items[key];return tmp}}return!1}},{key:"updateItem",value:function updateItem(item){var save=1<arguments.length&&arguments[1]!==void 0?arguments[1]:!1,safeItem=this.validateItem(item);for(var key in this.items){if(this.items[key].id==safeItem.id){this.items[key]=safeItem;if(save){return this.save()}return!0}}return!1}},{key:"load",value:function load(location){if(location){this.file=location;var fileData=json_decode(file_get_contents(location));for(var key in fileData){if(babelHelpers.typeof(this[key])!==("undefined"===typeof void 0?"undefined":babelHelpers.typeof(void 0))&&"items"!==key){this[key]=fileData[key]}}if(isset(fileData.items)){for(var key in fileData.items){var newItem=new _jsonOutlineSchemaItem.JSONOutlineSchemaItem;newItem.id=item.id;newItem.indent=item.indent;newItem.location=item.location;newItem.order=item.order;newItem.parent=item.parent;newItem.title=item.title;newItem.description=item.description;newItem.metadata=item.metadata;this.items[key]=newItem}}return!0}return!1}},{key:"save",value:function save(){var schema={id:this.id,title:this.title,author:this.author,description:this.description,license:this.license,metadata:this.metadata,items:this.items};return JSON.stringify(schema,null,2)}},{key:"generateUUID",value:function generateUUID(){return"ss-s-s-s-sss".replace(/s/g,this._uuidPart)}},{key:"_uuidPart",value:function _uuidPart(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}},{key:"_toggleDebug",value:function _toggleDebug(e){this.__debug=!this.__debug;this._triggerDebugPaint(this.__debug)}},{key:"_triggerDebugPaint",value:function _triggerDebugPaint(debug){if(debug){var obj={file:this.file,id:this.id,title:this.title,author:this.author,description:this.description,license:this.license,metadata:this.metadata,items:this.items},span=document.createElement("span");span.innerHTML=JSON.stringify(obj,null,2);this.shadowRoot.appendChild(span.cloneNode(!0))}else{this.render()}}},{key:"attributeChangedCallback",value:function attributeChangedCallback(attr,oldValue,newValue){if(this.__debug){this.render();this._triggerDebugPaint(this.__debug)}}},{key:"updateMetadata",value:function updateMetadata(key,value){this.metadata[key]=value;if(this.__debug){this.render();this._triggerDebugPaint(this.__debug)}}},{key:"file",get:function get(){return this.getAttribute("file")},set:function set(newValue){if(this.__ready){this.setAttribute("file",newValue)}}},{key:"id",get:function get(){return this.getAttribute("id")},set:function set(newValue){if(this.__ready){this.setAttribute("id",newValue)}}},{key:"title",get:function get(){return this.getAttribute("title")},set:function set(newValue){if(this.__ready){this.setAttribute("title",newValue)}}},{key:"author",get:function get(){return this.getAttribute("author")},set:function set(newValue){if(this.__ready){this.setAttribute("author",newValue)}}},{key:"description",get:function get(){return this.getAttribute("description")},set:function set(newValue){if(this.__ready){this.setAttribute("description",newValue)}}},{key:"license",get:function get(){return this.getAttribute("license")},set:function set(newValue){if(this.__ready){this.setAttribute("license",newValue)}}}],[{key:"observedAttributes",get:function get(){return["file","id","title","author","description","license"]}}]);return JsonOutlineSchema}(babelHelpers.wrapNativeSuper(HTMLElement));_exports.JsonOutlineSchema=JsonOutlineSchema;window.customElements.define(JsonOutlineSchema.tag,JsonOutlineSchema)});