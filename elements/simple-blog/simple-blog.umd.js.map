{"version":3,"file":"simple-blog.umd.js","sources":["simple-blog.umd.js"],"sourcesContent":["import { html, css } from \"lit-element/lit-element.js\";\nimport { HAXCMSLitElementTheme } from \"@lrnwebcomponents/haxcms-elements/lib/core/HAXCMSLitElementTheme.js\";\nimport { store } from \"@lrnwebcomponents/haxcms-elements/lib/core/haxcms-site-store.js\";\nimport { autorun, toJS } from \"mobx/lib/mobx.module.js\";\nimport { SimpleColorsSuper } from \"@lrnwebcomponents/simple-colors/simple-colors.js\";\nimport \"@lrnwebcomponents/simple-blog/lib/simple-blog-post.js\";\nimport \"@polymer/iron-pages/iron-pages.js\";\nimport \"@lrnwebcomponents/anchor-behaviors/anchor-behaviors.js\";\n\n/**\n * `simple-blog`\n * `A simple blog and associated elements`\n * @demo demo/index.html\n * @customElement simple-blog\n */\nclass SimpleBlog extends SimpleColorsSuper(HAXCMSLitElementTheme) {\n  /**\n   * LitElement constructable styles enhancement\n   */\n  static get styles() {\n    return [\n      ...super.styles,\n      css`\n        html,\n        body {\n          background-color: #fafafa;\n        }\n        :host {\n          display: block;\n          font-family: \"Roboto\", \"Noto\", sans-serif;\n          -webkit-font-smoothing: antialiased;\n          font-size: 14px;\n          background-color: #fafafa;\n          font-family: \"Open Sans\", \"MundoSans\", helvetica neue, Arial,\n            Helvetica, sans-serif;\n          margin: 0;\n          padding: 0;\n          text-rendering: optimizeLegibility;\n          -webkit-font-smoothing: antialiased;\n          -moz-font-feature-settings: \"liga=1, dlig=1\";\n          -ms-font-feature-settings: \"liga\", \"dlig\";\n          -webkit-font-feature-settings: \"liga\", \"dlig\";\n          -o-font-feature-settings: \"liga\", \"dlig\";\n          font-feature-settings: \"liga\", \"dlig\";\n        }\n        #backbutton {\n          position: fixed;\n          top: 0px;\n          left: 0px;\n          padding: 2px;\n          width: 40px;\n          height: 40px;\n          margin: 8px;\n          z-index: 1000;\n          color: black;\n          background-color: rgba(250, 250, 250, 0.5);\n          opacity: 0.5;\n          border-radius: 50%;\n          transition: all 0.6s linear;\n        }\n        #backbutton:focus,\n        #backbutton:hover {\n          opacity: 1;\n          color: white;\n          background-color: var(--haxcms-color, black);\n        }\n        iron-pages,\n        iron-pages section {\n          width: 100vw;\n          height: 100vh;\n        }\n        simple-blog-post {\n          transition: all 0.6s ease-in-out;\n          visibility: hidden;\n        }\n        :host([selected-page=\"0\"]) simple-blog-post {\n          opacity: 0;\n          visibility: hidden;\n        }\n        :host([selected-page=\"1\"]) simple-blog-post {\n          visibility: visible;\n          opacity: 1;\n        }\n        a,\n        a:active,\n        a:hover,\n        a:focus {\n          color: inherit;\n        }\n      `\n    ];\n  }\n  /**\n   * Store the tag name to make it easier to obtain directly.\n   * @notice function name must be here for tooling to operate correctly\n   */\n  static get tag() {\n    return \"simple-blog\";\n  }\n  // render function\n  render() {\n    return html`\n      <iron-pages .selected=\"${this.selectedPage}\">\n        <section>\n          <simple-blog-header></simple-blog-header>\n          <simple-blog-listing></simple-blog-listing>\n        </section>\n        <section>\n          <paper-icon-button\n            id=\"backbutton\"\n            icon=\"icons:arrow-back\"\n            @click=\"${this._goBack}\"\n          ></paper-icon-button>\n          <simple-tooltip\n            for=\"backbutton\"\n            position=\"right\"\n            offset=\"14\"\n            animation-delay=\"0\"\n            >Back to listing\n          </simple-tooltip>\n          <simple-blog-post ?edit-mode=\"${this.editMode}\"\n            ><slot></slot\n          ></simple-blog-post>\n          <simple-blog-footer id=\"footer\"></simple-blog-footer>\n        </section>\n      </iron-pages>\n    `;\n  }\n  /**\n   * Mix in an opened status\n   */\n  static get properties() {\n    return {\n      ...super.properties,\n      selectedPage: {\n        type: Number,\n        reflect: true,\n        attribute: \"selected-page\"\n      }\n    };\n  }\n  constructor() {\n    super();\n    this.__disposer = [];\n    this.selectedPage = 0;\n    setTimeout(() => {\n      import(\"@lrnwebcomponents/simple-blog/lib/simple-blog-header.js\");\n      import(\"@polymer/paper-icon-button/paper-icon-button.js\");\n      import(\"@lrnwebcomponents/simple-blog/lib/simple-blog-footer.js\");\n      import(\"@lrnwebcomponents/simple-blog/lib/simple-blog-listing.js\");\n    }, 0);\n  }\n  /**\n   * LitElement ready\n   */\n  firstUpdated(changedProperties) {\n    if (super.firstUpdated) {\n      super.firstUpdated(changedProperties);\n    }\n    // bc of async rendering and this being in a shadow of a shadow\n    // we need to pause to ensure its painted\n    setTimeout(() => {\n      this.contentContainer = this.shadowRoot\n        .querySelector(\"simple-blog-post\")\n        .shadowRoot.querySelector(\"#contentcontainer\");\n    }, 0);\n  }\n  /**\n   * attached life cycle\n   */\n  connectedCallback() {\n    super.connectedCallback();\n    autorun(reaction => {\n      this.activeId = toJS(store.activeId);\n      this.__disposer.push(reaction);\n    });\n    autorun(reaction => {\n      let location = toJS(store.location);\n      this._locationChanged(location);\n      this.__disposer.push(reaction);\n    });\n  }\n  /**\n   * detatched life cycle\n   */\n  disconnectedCallback() {\n    // clean up state\n    for (var i in this.__disposer) {\n      this.__disposer[i].dispose();\n    }\n    super.disconnectedCallback();\n  }\n  /**\n   * Listen for router location changes\n   */\n  _locationChanged(location) {\n    if (!location || typeof location.route === \"undefined\") return;\n    const name = location.route.name;\n    if (name === \"home\" || name === \"404\") {\n      this.selectedPage = 0;\n    } else {\n      window.scrollTo({\n        top: 0,\n        left: 0\n      });\n      this.selectedPage = 1;\n      // @todo hacky timing thing\n      setTimeout(() => {\n        // try scrolling to the target ID after content gets imported\n        window.AnchorBehaviors.getTarget(store.themeElement);\n      }, 1000);\n    }\n    setTimeout(() => {\n      var evt = document.createEvent(\"UIEvents\");\n      evt.initUIEvent(\"resize\", true, false, window, 0);\n      window.dispatchEvent(evt);\n    }, 50);\n  }\n  /**\n   * Reset the active item to reset state\n   */\n  _goBack(e) {\n    const prevActiveItemId = store.activeId;\n    window.history.pushState(null, null, store.location.baseUrl);\n    window.dispatchEvent(new PopStateEvent(\"popstate\"));\n    // should help account for starting on a page where popstate isn't set\n    // and also generate data model mirroring\n    if (prevActiveItemId) {\n      setTimeout(() => {\n        let active = this.shadowRoot\n          .querySelector(\"simple-blog-listing\")\n          .shadowRoot.querySelector(\n            'simple-blog-overview[item-id=\"' + prevActiveItemId + '\"]'\n          );\n        if (active) {\n          active.scrollIntoView(true);\n          active.focus();\n        }\n      }, 100);\n    } else {\n      window.scrollTo({\n        top: 0,\n        left: 0\n      });\n    }\n    const evt = new CustomEvent(\"json-outline-schema-active-item-changed\", {\n      bubbles: true,\n      cancelable: true,\n      composed: true,\n      detail: {}\n    });\n    this.dispatchEvent(evt);\n    this.selectedPage = 0;\n  }\n}\nwindow.customElements.define(SimpleBlog.tag, SimpleBlog);\nexport { SimpleBlog };\n"],"names":["SimpleBlog","__disposer","selectedPage","setTimeout","SimpleColorsSuper","HAXCMSLitElementTheme","html","this","_goBack","editMode","css","type","Number","reflect","attribute","changedProperties","_this2","contentContainer","shadowRoot","querySelector","autorun","reaction","_this3","activeId","toJS","store","push","location","_locationChanged","i","dispose","route","name","window","scrollTo","top","left","AnchorBehaviors","getTarget","themeElement","evt","document","createEvent","initUIEvent","dispatchEvent","e","prevActiveItemId","history","pushState","baseUrl","PopStateEvent","active","_this4","scrollIntoView","focus","CustomEvent","bubbles","cancelable","composed","detail","customElements","define","tag"],"mappings":"+oLAeMA,yKAgIGC,WAAa,KACbC,aAAe,EACpBC,WAAW,kBACF,kEACA,0DACA,kEACA,6DACN,iPAvIkBC,oBAAkBC,qEAsFhCC,WACoBC,KAAKL,aASdK,KAAKC,QASeD,KAAKE,qFAlGzCC,+CA2EK,kbAqCLR,aAAc,CACZS,KAAMC,OACNC,SAAS,EACTC,UAAW,+DAkBJC,qGAEUA,GAIrBZ,WAAW,WACTa,EAAKC,iBAAmBD,EAAKE,WAC1BC,cAAc,oBACdD,WAAWC,cAAc,sBAC3B,gHAOHC,UAAQ,SAAAC,GACNC,EAAKC,SAAWC,OAAKC,QAAMF,UAC3BD,EAAKrB,WAAWyB,KAAKL,KAEvBD,UAAQ,SAAAC,OACFM,EAAWH,OAAKC,QAAME,UAC1BL,EAAKM,iBAAiBD,GACtBL,EAAKrB,WAAWyB,KAAKL,wDAQlB,IAAIQ,KAAKtB,KAAKN,gBACZA,WAAW4B,GAAGC,4GAONH,MACVA,QAAsC,IAAnBA,EAASI,WAC3BC,EAAOL,EAASI,MAAMC,KACf,SAATA,GAA4B,QAATA,OAChB9B,aAAe,GAEpB+B,OAAOC,SAAS,CACdC,IAAK,EACLC,KAAM,SAEHlC,aAAe,EAEpBC,WAAW,WAET8B,OAAOI,gBAAgBC,UAAUb,QAAMc,eACtC,MAELpC,WAAW,eACLqC,EAAMC,SAASC,YAAY,YAC/BF,EAAIG,YAAY,UAAU,GAAM,EAAOV,OAAQ,GAC/CA,OAAOW,cAAcJ,IACpB,qCAKGK,cACAC,EAAmBrB,QAAMF,SAC/BU,OAAOc,QAAQC,UAAU,KAAM,KAAMvB,QAAME,SAASsB,SACpDhB,OAAOW,cAAc,IAAIM,cAAc,aAGnCJ,EACF3C,WAAW,eACLgD,EAASC,EAAKlC,WACfC,cAAc,uBACdD,WAAWC,cACV,iCAAmC2B,EAAmB,MAEtDK,IACFA,EAAOE,gBAAe,GACtBF,EAAOG,UAER,KAEHrB,OAAOC,SAAS,CACdC,IAAK,EACLC,KAAM,QAGJI,EAAM,IAAIe,YAAY,0CAA2C,CACrEC,SAAS,EACTC,YAAY,EACZC,UAAU,EACVC,OAAQ,UAELf,cAAcJ,QACdtC,aAAe,WAGxB+B,OAAO2B,eAAeC,OAAO7D,EAAW8D,IAAK9D"}