!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@lrnwebcomponents/rich-text-editor/rich-text-editor.js"),require("@lrnwebcomponents/code-editor/code-editor.js"),require("lit"),require("@lrnwebcomponents/simple-colors/simple-colors.js"),require("@lrnwebcomponents/undo-manager/undo-manager.js"),require("@lrnwebcomponents/hal-9000/hal-9000.js"),require("@lrnwebcomponents/simple-popover/lib/simple-tour.js"),require("@lrnwebcomponents/utils/utils.js"),require("mobx"),require("@lrnwebcomponents/hax-body-behaviors/hax-body-behaviors.js"),require("@lrnwebcomponents/i18n-manager/lib/I18NMixin.js"),require("@lrnwebcomponents/micro-frontend-registry/lib/microServices.js"),require("@lrnwebcomponents/super-daemon/super-daemon.js"),require("@lrnwebcomponents/media-behaviors/media-behaviors.js"),require("@lrnwebcomponents/simple-toast/simple-toast.js"),require("@lrnwebcomponents/editable-table/editable-table.js"),require("@lrnwebcomponents/iframe-loader/iframe-loader.js"),require("@lrnwebcomponents/rich-text-editor/lib/toolbars/rich-text-editor-toolbar.js"),require("@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-prompt-button.js"),require("@lrnwebcomponents/hax-iconset/lib/simple-hax-iconset.js"),require("@lrnwebcomponents/simple-popover/lib/SimpleTourFinder.js"),require("@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-button.js"),require("@lrnwebcomponents/absolute-position-behavior/absolute-position-behavior.js"),require("@lrnwebcomponents/simple-icon/lib/simple-icons.js"),require("@lrnwebcomponents/simple-icon/lib/simple-iconset.js"),require("@lrnwebcomponents/hax-body/lib/hax-toolbar.js"),require("@lrnwebcomponents/simple-toolbar/lib/simple-toolbar-menu-item.js"),require("@lrnwebcomponents/simple-toolbar/lib/simple-toolbar-menu.js"),require("@lrnwebcomponents/hax-body/lib/hax-ui-styles.js"),require("@lrnwebcomponents/hax-body/lib/hax-toolbar-item.js"),require("@lrnwebcomponents/hax-body/lib/hax-context-item.js"),require("@lrnwebcomponents/hax-body/lib/hax-toolbar-menu.js"),require("@lrnwebcomponents/simple-toolbar/simple-toolbar.js"),require("@lrnwebcomponents/simple-icon/lib/simple-icon-lite.js"),require("@lrnwebcomponents/utils/utils"),require("@lrnwebcomponents/grid-plate/grid-plate.js"),require("@lrnwebcomponents/media-image/media-image.js")):"function"==typeof define&&define.amd?define(["exports","@lrnwebcomponents/rich-text-editor/rich-text-editor.js","@lrnwebcomponents/code-editor/code-editor.js","lit","@lrnwebcomponents/simple-colors/simple-colors.js","@lrnwebcomponents/undo-manager/undo-manager.js","@lrnwebcomponents/hal-9000/hal-9000.js","@lrnwebcomponents/simple-popover/lib/simple-tour.js","@lrnwebcomponents/utils/utils.js","mobx","@lrnwebcomponents/hax-body-behaviors/hax-body-behaviors.js","@lrnwebcomponents/i18n-manager/lib/I18NMixin.js","@lrnwebcomponents/micro-frontend-registry/lib/microServices.js","@lrnwebcomponents/super-daemon/super-daemon.js","@lrnwebcomponents/media-behaviors/media-behaviors.js","@lrnwebcomponents/simple-toast/simple-toast.js","@lrnwebcomponents/editable-table/editable-table.js","@lrnwebcomponents/iframe-loader/iframe-loader.js","@lrnwebcomponents/rich-text-editor/lib/toolbars/rich-text-editor-toolbar.js","@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-prompt-button.js","@lrnwebcomponents/hax-iconset/lib/simple-hax-iconset.js","@lrnwebcomponents/simple-popover/lib/SimpleTourFinder.js","@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-button.js","@lrnwebcomponents/absolute-position-behavior/absolute-position-behavior.js","@lrnwebcomponents/simple-icon/lib/simple-icons.js","@lrnwebcomponents/simple-icon/lib/simple-iconset.js","@lrnwebcomponents/hax-body/lib/hax-toolbar.js","@lrnwebcomponents/simple-toolbar/lib/simple-toolbar-menu-item.js","@lrnwebcomponents/simple-toolbar/lib/simple-toolbar-menu.js","@lrnwebcomponents/hax-body/lib/hax-ui-styles.js","@lrnwebcomponents/hax-body/lib/hax-toolbar-item.js","@lrnwebcomponents/hax-body/lib/hax-context-item.js","@lrnwebcomponents/hax-body/lib/hax-toolbar-menu.js","@lrnwebcomponents/simple-toolbar/simple-toolbar.js","@lrnwebcomponents/simple-icon/lib/simple-icon-lite.js","@lrnwebcomponents/utils/utils","@lrnwebcomponents/grid-plate/grid-plate.js","@lrnwebcomponents/media-image/media-image.js"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).HaxBody={},e.$$0,null,e.lit,e.simpleColors_js,e.undoManager_js,e.$$1,e.simpleTour_js,e.utils_js,e.mobx,e.haxBodyBehaviors_js,e.I18NMixin_js,e.microServices_js,e.superDaemon_js,null,null,null,null,e.richTextEditorToolbar_js,e.richTextEditorPromptButton_js,null,e.SimpleTourFinder_js,e.richTextEditorButton_js,null,null,e.simpleIconset_js,null,null,e.simpleToolbarMenu_js,e.haxUiStyles_js,e.haxToolbarItem_js,null,null,e.simpleToolbar_js,null,e.utils)}(this,(function(e,t,n,o,a,i,r,s,l,c,d,u,h,p,m,g,v,b,f,x,y,k,w,N,E,_,S,T,A,L,C,H,B,M,P,O){"use strict";function z(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var o=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,o.get?o:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var D=z(t),R=z(r);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){Y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function q(){q=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",r=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var i=t&&t.prototype instanceof h?t:h,r=Object.create(i.prototype),s=new _(a||[]);return o(r,"_invoke",{value:k(e,n,s)}),r}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var u={};function h(){}function p(){}function m(){}var g={};l(g,i,(function(){return this}));var v=Object.getPrototypeOf,b=v&&v(v(S([])));b&&b!==t&&n.call(b,i)&&(g=b);var f=m.prototype=h.prototype=Object.create(g);function x(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function y(e,t){function a(o,i,r,s){var l=d(e[o],e,i);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==typeof u&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){a("next",e,r,s)}),(function(e){a("throw",e,r,s)})):t.resolve(u).then((function(e){c.value=e,r(c)}),(function(e){return a("throw",e,r,s)}))}s(l.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function k(e,t,n){var o="suspendedStart";return function(a,i){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw i;return T()}for(n.method=a,n.arg=i;;){var r=n.delegate;if(r){var s=w(r,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var l=d(e,t,n);if("normal"===l.type){if(o=n.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o="completed",n.method="throw",n.arg=l.arg)}}}function w(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var a=d(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,u;var i=a.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function S(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:T}}function T(){return{value:void 0,done:!0}}return p.prototype=m,o(f,"constructor",{value:m,configurable:!0}),o(m,"constructor",{value:p,configurable:!0}),p.displayName=l(m,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,l(e,s,"GeneratorFunction")),e.prototype=Object.create(f),e},e.awrap=function(e){return{__await:e}},x(y.prototype),l(y.prototype,r,(function(){return this})),e.AsyncIterator=y,e.async=function(t,n,o,a,i){void 0===i&&(i=Promise);var r=new y(c(t,n,o,a),i);return e.isGeneratorFunction(n)?r:r.next().then((function(e){return e.done?e.value:r.next()}))},x(f),l(f,s,"Generator"),l(f,i,(function(){return this})),l(f,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return r.type="throw",r.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],r=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var r=i?i.completion:{};return r.type=e,r.arg=t,i?(this.method="next",this.next=i.finallyLoc,u):this.complete(r)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;E(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:S(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function G(e){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},G(e)}function U(e,t,n,o,a,i,r){try{var s=e[i](r),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(o,a)}function F(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var i=e.apply(t,n);function r(e){U(i,o,a,r,s,"next",e)}function s(e){U(i,o,a,r,s,"throw",e)}r(void 0)}))}}function V(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,ue(o.key),o)}}function X(e,t,n){return t&&W(e.prototype,t),n&&W(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Y(e,t,n){return(t=ue(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function J(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$(e,t)}function K(e){return K=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},K(e)}function $(e,t){return $=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$(e,t)}function Q(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Z(e,t,n){return Z=Q()?Reflect.construct.bind():function(e,t,n){var o=[null];o.push.apply(o,t);var a=new(Function.bind.apply(e,o));return n&&$(a,n.prototype),a},Z.apply(null,arguments)}function ee(e){var t="function"==typeof Map?new Map:void 0;return ee=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,o)}function o(){return Z(e,arguments,K(this).constructor)}return o.prototype=Object.create(e.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),$(o,e)},ee(e)}function te(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ne(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return te(e)}function oe(e){var t=Q();return function(){var n,o=K(e);if(t){var a=K(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return ne(this,n)}}function ae(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=K(e)););return e}function ie(){return ie="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=ae(e,t);if(o){var a=Object.getOwnPropertyDescriptor(o,t);return a.get?a.get.call(arguments.length<3?e:n):a.value}},ie.apply(this,arguments)}function re(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function se(e){return function(e){if(Array.isArray(e))return ce(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||le(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function le(e,t){if(e){if("string"==typeof e)return ce(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ce(e,t):void 0}}function ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function de(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=le(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,a=function(){};return{s:a,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return r=e.done,e},e:function(e){s=!0,i=e},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw i}}}}function ue(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var he=function(e){J(n,e);var t=oe(n);function n(){var e;return V(this,n),(e=t.call(this)).eventName="hax-register-app",e}return X(n,[{key:"connectedCallback",value:function(){"undefined"!==G(this.data)&&("string"==typeof this.data&&(this.data=JSON.parse(this.data)),this.dispatchEvent(new CustomEvent(this.eventName,{bubbles:!0,composed:!0,cancelable:!1,detail:this.data})))}}],[{key:"tag",get:function(){return"hax-app"}}]),n}(ee(HTMLElement));customElements.define(he.tag,he);var pe,me=function(e){J(n,e);var t=oe(n);function n(){var e;return V(this,n),(e=t.call(this)).eventName="hax-register-stax",e}return X(n,null,[{key:"tag",get:function(){return"hax-stax"}}]),n}(he);customElements.define(me.tag,me),c.configure({enforceActions:!1,useProxies:"ifavailable"});function ge(e){try{return sessionStorage.getItem(e)}catch(e){return!1}}function ve(e,t){try{return sessionStorage.setItem(e,t)}catch(e){return!1}}var be={attribute:"data-style-decoration",title:"Decoration",description:"Some built in styles to offset the material",inputMethod:"select",options:{"":"","highlight red":"Highlight (red)","highlight blue":"Highlight (blue)","highlight green":"Highlight (green)","highlight orange":"Highlight (orange)","highlight purple":"Highlight (purple)"}},fe=function(e){J(k,e);var t,n,a,i,r,d,m,g,v,b,f,x,y=oe(k);function k(){var e;V(this,k),e=y.call(this),h.enableServices(["core"]),e.toastShowEventName="simple-toast-show",e.t={close:"Close"},p.SuperDaemonInstance.icon="hax:hax2022",p.SuperDaemonInstance.allowedCallback=function(){return!(!e.ready||!e.editMode)},e.primativeHooks={},e.__dragTarget=null,e.registerLocalization({context:te(e),namespace:"hax",basePath:("undefined"==typeof document&&"undefined"==typeof location?new(require("url").URL)("file:"+__filename).href:"undefined"==typeof document?location.href:document.currentScript&&document.currentScript.src||new URL("hax-body.umd.js",document.baseURI).href)+"/../../",locales:["es"]}),e.method="GET",e.haxSelectedText="",e.__winEvents={"hax-super-daemon-insert-tag":"_superDaemonInsert","hax-register-properties":"_haxStoreRegisterProperties","hax-consent-tap":"_haxConsentTap","hax-context-item-selected":"_haxContextOperation",onbeforeunload:"_onBeforeUnload",paste:"_onPaste","hax-register-app":"_haxStoreRegisterApp","hax-register-stax":"_haxStoreRegisterStax","hax-store-write":"_writeHaxStore","hax-register-core-piece":"_haxStorePieceRegistrationManager","hax-register-body":"_haxStoreRegisterBody","hax-insert-content":"_haxStoreInsertContent","hax-insert-content-array":"_haxStoreInsertMultiple","hax-add-voice-command":"_addVoiceCommand","hax-refresh-tray-form":"refreshActiveNodeForm"},window.onbeforeunload=function(t){if(!e.skipExitTrap&&e.editMode){var n="Are you sure you want to leave? Your work will not be saved!";return t.returnValue=n,n}},s.SimpleTourManager.registerNewTour({key:"hax",name:"Let's learn HAX",style:"\n      simple-popover-manager::part(simple-popover) {\n        max-width: 250px;\n      }\n      simple-popover-manager button {\n        font-size: 12px;\n        margin: 0px 2px;\n      }\n      simple-popover-manager p {\n        --hax-base-styles-p-font-size: 14px;\n        padding: 0;\n        margin: 0;\n        font-size: 14px;\n        line-height: 20px;\n      }\n      simple-popover-manager h3 {\n        --hax-base-styles-h3-font-size: 18px;\n        margin: 8px 2px;\n      }"}),e.voiceRespondsTo="(worker)",e.voiceCommands={},e.skipHAXConfirmation=!1,e.storageData={},e.appStore={url:"",params:{}},e.daemonKeyCombo="".concat(p.SuperDaemonInstance.key1," + ").concat(p.SuperDaemonInstance.key2," + "),e.activeNode=null,e.activeEditingElement=null,e.haxBodies=[],e.activePlaceHolder=null,e.sessionObject={},e.editMode=!1,e.skipExitTrap=!1,e.appStoreLoaded=!1,e.elementList={},e.elementAlign=l.localStorageGet("hax-tray-elementAlign"),e.elementAlign&&null!=e.elementAlign||(e.elementAlign="left"),e.trayStatus="collapsed",e.trayDetail="content-edit",e.appList=[],e.gizmoList=[],e.recentGizmoList=[],e.haxAutoloader=null,e.activeHaxBody=null,e.haxTray=null,e.haxCancel=null,e.staxList=[],e.globalPreferences={},e.activeApp={},e.connectionRewrites={},e.voiceDebug=!1,e.daemonCommands={},e.keyboardShortcuts={"#":{tag:"h2",content:""},"##":{tag:"h3",content:""},"###":{tag:"h4",content:""},"####":{tag:"h5",content:""},"#####":{tag:"h6",content:""},"######":{tag:"h6",content:""},"1.":{tag:"ol",content:"<li></li>"},"-":{tag:"ul",content:"<li></li>"},"*":{tag:"ul",content:"<li></li>"},"+":{tag:"ul",content:"<li></li>"},"---":{tag:"hr"},"***":{tag:"hr"},___:{tag:"hr"},"```":{tag:"code",content:""},">":{tag:"blockquote",content:""}},e.validTagList=e.__validTags(),e.validGridTagList=e.__validGridTags(),e.validGizmoTypes=e.__validGizmoTypes();var t=document.createElement("webview");return e._isSandboxed="function"==typeof t.reload,window.SimpleToast.requestAvailability(),document.body.style.setProperty("--hax-ui-headings","#d4ff77"),c.makeObservable(te(e),{daemonKeyCombo:c.observable,gizmoList:c.observable,recentGizmoList:c.observable,activeNode:c.observable,globalPreferences:c.observable,activeGizmo:c.computed,activeNodeIndex:c.computed,editMode:c.observable,elementAlign:c.observable,trayStatus:c.observable,trayDetail:c.observable,appList:c.observable,activeApp:c.observable,haxSelectedText:c.observable,activeEditingElement:c.observable,activeHaxBody:c.observable,appStoreLoaded:c.observable}),c.autorun((function(){e._globalPreferencesChanged(c.toJS(e.globalPreferences))})),c.autorun((function(){e._editModeChanged(c.toJS(e.editMode))})),e}return X(k,[{key:"testHook",value:function(e,t){return!!(e&&e.tagName&&this.HTMLPrimativeTest(e)&&this.primativeHooks[e.tagName.toLowerCase()]&&this.primativeHooks[e.tagName.toLowerCase()][t])||e&&"function"==typeof e.haxHooks&&e.haxHooks()[t]}},{key:"runHook",value:(x=F(q().mark((function e(t,n){var o,a,i=arguments;return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=i.length>2&&void 0!==i[2]?i[2]:[],!this.testHook(t,n)){e.next=9;break}if(!this.HTMLPrimativeTest(t)){e.next=6;break}return e.next=5,(a=this.primativeHooks[t.tagName.toLowerCase()])[n].apply(a,se(o));case 5:case 8:return e.abrupt("return",e.sent);case 6:return e.next=8,t[t.haxHooks()[n]].apply(t,se(o));case 9:return e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e,this)}))),function(e,t){return x.apply(this,arguments)})},{key:"getSelection",value:function(){if(this.activeHaxBody&&this.activeHaxBody.parentNode){if(this.activeHaxBody.parentNode.getSelection)return this.activeHaxBody.parentNode.getSelection();try{if(l.getRange(this.activeHaxBody.parentNode))return l.getRange(this.activeHaxBody.parentNode)}catch(e){}}return window.getSelection()}},{key:"getRange",value:function(){var e=this.getSelection();return e.getRangeAt&&e.rangeCount?e.getRangeAt(0):e||void 0}},{key:"guessGizmo",value:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=[],r=[];if("undefined"!==G(e)&&this.validGizmoTypes.includes(e))for(var s in this.gizmoList){var l=this.gizmoList[s],c=t.innerHTML?{innerHTML:t.innerHTML}:{},d=!1;if(l&&l.handles)for(var u=function(){if(e===l.handles[h].type||"*"===e&&!d){for(var s in l.handles[h])"type"!==s&&"undefined"!==G(t[s])&&(""===l.handles[h][s]||"inline"!==e&&l.meta&&(!l.meta||l.meta.inlineOnly||l.meta.hidden)||(d=!0,c[l.handles[h][s]]=t[s]));if(d||o){if(a&&l.handles[h].type_exclusive)return{v:[n.haxElementPrototype(l,c,"")]};var u={};se(l.handles).forEach((function(e){e&&e.type&&""!=e.type&&(u[e.type.toLowerCase()]=!0)})),se(l.tags).forEach((function(e){e&&""!=e&&(u[e.toLowerCase()]=!0)})),l.keywords=Object.keys(u),r.includes(l.tag)||(i.push(n.haxElementPrototype(l,c,"")),r.push(l.tag))}}},h=0;h<l.handles.length;h++){var p=u();if("object"===G(p))return p.v}}return i}},{key:"insertLogicFromValues",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=this.guessGizmoType(e),i=a,r=!0;if("*"==a){if(n)return!1;r=!1,i="link"}var s=this.guessGizmo(a,e,!1,r);return s.length>0?(1===s.length||o?1===s.length&&"undefined"!==G(s[0].tag)?t.dispatchEvent(new CustomEvent("hax-insert-content",{bubbles:!0,cancelable:!0,composed:!0,detail:s[0]})):o&&t.dispatchEvent(new CustomEvent("hax-insert-content",{bubbles:!0,cancelable:!0,composed:!0,detail:s.find((function(e){return"a"==e.tag}))})):this.haxAppPicker.presentOptions(s,a,"Pick how to present this "+i,"gizmo"),!0):(this.toast("Sorry, HAX doesn't know how to handle that type of link yet."),!1)}},{key:"write",value:function(e,t,n){n&&n.dispatchEvent(new CustomEvent("hax-store-write",{composed:!0,bubbles:!0,cancelable:!1,detail:{property:e,value:t,owner:n}}))}},{key:"mimeTypeToGizmoType",value:function(e){var t=e.split("/");switch(t[0]){case"audio":return"audio";case"image":return"svg+xml"==t[1]?"svg":"image";case"video":return"video";case"text":return["csv","html","markdown"].includes(t[1])?t[1]:"document";case"application":return"pdf"==t[1]?"pdf":["zip","gzip","x-tar"].includes(t[1])?"archive":"document"}}},{key:"guessGizmoType",value:function(e){if("undefined"!==G(e.source)){var t=e.source.toLowerCase();if(-1!=t.indexOf(".mp3")||-1!=t.indexOf(".midi")||-1!=t.indexOf(".mid"))return"audio";if(-1!=t.indexOf(".png")||-1!=t.indexOf(".jpg")||-1!=t.indexOf(".jpeg"))return"image";if(-1!=t.indexOf(".gif"))return"gif";if(-1!=t.indexOf(".pdf"))return"pdf";if(-1!=t.indexOf(".svg"))return"svg";if(-1!=t.indexOf(".csv"))return"csv";if(-1!=t.indexOf(".md"))return"markdown";if(-1!=t.indexOf(".html")||-1!=t.indexOf(".htm"))return"html";if(-1!=t.indexOf(".txt")||-1!=t.indexOf(".doc")||-1!=t.indexOf(".docx")||-1!=t.indexOf(".xls")||-1!=t.indexOf(".xlsx")||-1!=t.indexOf(".vtt")||-1!=t.indexOf(".ppt"))return"document";if(-1!=t.indexOf(".zip")||-1!=t.indexOf(".tar.gz")||-1!=t.indexOf(".tar"))return"archive";if("external"!=window.MediaBehaviors.Video.getVideoType(t))return"video"}return"*"}},{key:"render",value:function(){return o.html(pe||(pe=re([" <slot></slot> "])))}},{key:"toast",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"capsule",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.t.close,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;window.dispatchEvent(new CustomEvent(this.toastShowEventName,{bubbles:!0,composed:!0,cancelable:!0,detail:I({text:e,duration:t,classStyle:o,closeText:a,eventCallback:i,slot:r},n)}))}},{key:"_storageDataChanged",value:function(e){e&&this.ready&&this.__storageDataProcessed&&(l.localStorageGet("haxConfirm",!1)?l.localStorageSet("haxUserData",e):ge("haxConfirm")&&ve("haxUserData",e))}},{key:"isSingleSlotElement",value:function(e){var t=Object.keys(this.slotsSchemaFromNode(e));return 1==t.length&&0===t[0].length}},{key:"isTextElement",value:function(e){var t;return null!=e&&e.tagName?t=e.tagName.toLowerCase():null!=e&&e.tag&&(t=e.tag.toLowerCase()),!!(t&&this.validTagList.includes(t)&&["p","ol","ul","li","a","h1","h2","h3","h4","h5","h6","strike","u","b","sub","sup","span","i","bold","em","strong","blockquote","code","figure"].includes(t))}},{key:"isGridPlateElement",value:function(e){var t;return e&&e.tagName?t=e.tagName.toLowerCase():e&&e.tag&&(t=e.tag.toLowerCase()),!(!t||!this.validGridTagList.includes(t))}},{key:"isLayoutElement",value:function(e){var t=e&&e.tagName&&this.haxSchemaFromTag(e.tagName)||{};return t.type&&"grid"===t.type}},{key:"isLayoutSlot",value:function(e){return!(!e||!e.parentNode)&&this.isLayoutElement(e.parentNode)}},{key:"isOriginalGridPlate",value:function(e){return!!e&&"GRID-PLATE"===e.tagName}},{key:"activeSchema",value:function(){return this.activeNode?this.haxSchemaFromTag(this.activeNode.tagName):void 0}},{key:"activeParentSchema",value:function(){return this.activeNode&&this.activeNode.parentNode?this.haxSchemaFromTag(this.activeNode.parentNode.tagName):void 0}},{key:"slottedContentByNode",value:function(e){var t=I({},this.slotsSchemaFromNode(e)||{});return e?(se(e.children||[]).forEach((function(e){e.slot&&""!==e.slot&&t[e.slot]?(t[e.slot].items=t[e.slot].items||[],t[e.slot].items.push(e)):e.slot&&""!==e.slot||!t[""]||(t[""].items=t[""].items||[],t[""].items.push(e))})),t):t}},{key:"slotsSchemaFromNode",value:function(e){if(!e||!e.tagName)return{};var t={},n=this.haxSchemaFromTag(e.tagName||{}),o=this.slotsFromSchema(n);this.isOriginalGridPlate(e)&&(e.layout||"1-1-1-1").split("-").map((function(e,t){o.push({slot:"col-".concat(t+1),title:"Column ".concat(t+1),excludedSlotWrappers:["grid-plate"]})}));return o.forEach((function(o){o.items=void 0,o.label=o.title||o.slot,o.editMode=I(I({},n.editMode),o.editMode),o.grid=e,(o.slot||""===o.slot)&&(t[o.slot]=o)})),t}},{key:"schemaBySlotId",value:function(e,t){return(this.slotsSchemaFromNode(e)||{})[t]}},{key:"_appStoreChanged",value:function(e,t){e&&t&&(e.url&&!e.apps&&this.shadowRoot?this.loadAppStoreFromRemote():this.__appStoreData=e)}},{key:"_loadAppStoreData",value:(f=F(q().mark((function e(t){var n,o,a,i,r,s,l,c,d,u;return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==t){e.next=9;break}if(n={},"undefined"!==G(t.autoloader))for(o in t.autoloader=Object.assign({},t.autoloader),t.autoloader)a=o,i=t.autoloader[o],isNaN(a)||(a=t.autoloader[o],i="@lrnwebcomponents/".concat(a,"/").concat(a,".js")),"string"!=typeof i&&(i.haxProperties&&this.setHaxProperties(t.autoloader[o].haxProperties,a),i=t.autoloader[o].import),this.validTagList.push(a),n[a]=i;if("undefined"!==G(t.apps))for(r=t.apps,s=0;s<r.length;s++)(l=document.createElement("hax-app")).data=r[s],this.appendChild(l);if("undefined"!==G(t.stax))for(c=t.stax,d=0;d<c.length;d++)(u=document.createElement("hax-stax")).data=c[d],this.appendChild(u);return this.dispatchEvent(new CustomEvent("hax-store-app-store-loaded",{bubbles:!0,cancelable:!0,composed:!0,detail:!0})),e.next=8,this._handleDynamicImports(n,this.haxAutoloader);case 8:this.appStoreLoaded=!0;case 9:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"_handleDynamicImports",value:(b=F(q().mark((function e(t,n){var o,a,i,r=this;return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=new URL("./../../../","undefined"==typeof document&&"undefined"==typeof location?new(require("url").URL)("file:"+__filename).href:"undefined"==typeof document?location.href:document.currentScript&&document.currentScript.src||new URL("hax-body.umd.js",document.baseURI).href).href,window.WCGlobalBasePath&&(o=window.WCGlobalBasePath),a=q().mark((function e(a){var i,s;return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.customElements.get(a)){e.next=4;break}if(window.customElements.get(a).haxProperties)r.setHaxProperties(window.customElements.get(a).haxProperties,a);else try{i=document.createElement(a),n.appendChild(i)}catch(e){}e.next=8;break;case 4:return s="".concat(o).concat(t[a]),r.isExternalURLImport(t[a])&&(s=t[a]),e.next=8,import(s).then((function(e){window.customElements.get(a)&&window.customElements.get(a).haxProperties?r.setHaxProperties(window.customElements.get(a).haxProperties,a):n.appendChild(document.createElement(a))})).catch((function(e){console.warn(e),n.appendChild(document.createElement(a))}));case 8:case"end":return e.stop()}}),e)})),e.t0=q().keys(t);case 4:if((e.t1=e.t0()).done){e.next=9;break}return i=e.t1.value,e.delegateYield(a(i),"t2",7);case 7:e.next=4;break;case 9:case"end":return e.stop()}}),e)}))),function(e,t){return b.apply(this,arguments)})},{key:"isExternalURLImport",value:function(e){var t;try{t=new URL(e)}catch(e){return!1}return new URL(t).origin!==location.origin}},{key:"_editModeChanged",value:function(e){this.__hal&&(e&&this.globalPreferences.haxVoiceCommands?this.__hal.auto=!0:this.__hal.auto=!1),e&&!this.appStoreLoaded&&this.__appStoreData&&this.haxAutoloader&&(clearTimeout(this.__readyToProcessAppStoreData),this._loadAppStoreData(this.__appStoreData))}},{key:"_globalPreferencesChanged",value:(v=F(q().mark((function e(t){var n,o=this;return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.__storageDataProcessed&&t&&"undefined"!==G(t.haxVoiceCommands)&&this.ready&&("string"==typeof(n=this.storageData)&&(n=JSON.parse(n)),n.globalPreferences=t,this.storageData=n,this._storageDataChanged(this.storageData),t.haxVoiceCommands&&!this.__hal&&Promise.resolve(R).then((function(e){o._initVoiceCommands(),o.__hal=document.createElement("hal-9000"),o.__hal.respondsTo=o.voiceRespondsTo,o.__hal.debug=o.voiceDebug,o.__hal.auto=!0,o.shadowRoot.appendChild(o.__hal),o.__hal.commands=I({},o.voiceCommands)})),this.__hal&&(t.haxVoiceCommands&&this.editMode?this.__hal.auto=!0:this.__hal.auto=!1),t.haxLang&&xe.editMode&&(clearTimeout(this._debounceLang),this._debounceLang=setTimeout(F(q().mark((function e(){var t,n;return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=q().keys(o.elementList);case 1:if((e.t1=e.t0()).done){e.next=10;break}return t=e.t1.value,n=o.elementList[t],e.next=6,o.attemptGizmoTranslation(t,n);case 6:n=e.sent,o.elementList[t]=n,e.next=1;break;case 10:o.gizmoList.forEach((function(e){o.elementList[e.tag].gizmo.title&&(e.title=o.elementList[e.tag].gizmo.title),o.elementList[e.tag].gizmo.description&&(e.description=o.elementList[e.tag].gizmo.description)}));case 11:case"end":return e.stop()}}),e)}))),100)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"_haxContextOperation",value:function(e){var t=this,n=e.detail;if(this.activeNode){var o=!1;switch(n.eventName){case"hax-align-left":this.activeNode.style.float=null,this.activeNode.style.margin=null,this.activeNode.style.display=null,o=!0;break;case"hax-align-center":this.activeNode.style.float=null,this.activeNode.style.margin="0 auto",this.activeNode.style.display="block",o=!0;break;case"hax-align-right":this.activeNode.style.float="right",this.activeNode.style.margin="0 auto",this.activeNode.style.display="block",o=!0;break;case"hax-size-change":100==n.value?this.activeNode.style.width=null:this.activeNode.style.width=n.value+"%",o=!0}o&&(clearTimeout(this.__repositionMenu),this.__repositionMenu=setTimeout((function(){t.activeHaxBody.positionContextMenus()}),0))}}},{key:"_haxConsentTap",value:function(e){l.localStorageSet("haxConfirm",!0),l.localStorageSet("haxUserData",JSON.stringify(this.storageData))}},{key:"updated",value:function(e){var t=this;ie(K(k.prototype),"updated",this)&&ie(K(k.prototype),"updated",this).call(this,e),e.forEach((function(e,n){"appStore"==n&&t[n]&&t._appStoreChanged(t[n],e),["ready","__appStoreData","haxAutoloader"].includes(n)&&t.ready&&t.__appStoreData&&t.haxAutoloader&&(clearTimeout(t.__readyToProcessAppStoreData),t.__readyToProcessAppStoreData=setTimeout((function(){t._loadAppStoreData(t.__appStoreData)}),0)),["haxAutoloader","haxTray","haxCancel"].includes(n)&&(clearTimeout(t.__storeReady),t.__storeReady=setTimeout((function(){t._storePiecesAllHere(t.haxAutoloader,t.activeHaxBody,t.haxTray,t.haxCancel)}),0))}))}},{key:"_calculateActiveGizmo",value:function(e){if(null==e||!e.tagName)return null;for(var t in this.gizmoList){var n=this.gizmoList[t];if(n.tag===e.tagName.toLowerCase())return n}}},{key:"loadAppStoreFromRemote",value:function(){var e=this,t=new URLSearchParams(this.appStore.params),n=this.appStore.url;t&&(n+="?".concat(t)),fetch(n,{method:this.method}).then((function(e){if(e.ok)return e.json()})).then((function(t){e.__appStoreData=t}))}},{key:"firstUpdated",value:function(e){var t=this;if(ie(K(k.prototype),"firstUpdated",this)&&ie(K(k.prototype),"firstUpdated",this).call(this,e),this.skipHAXConfirmation&&(ve("haxConfirm",!0),l.localStorageSet("haxConfirm",!0)),ge("haxConfirm")||l.localStorageGet("haxConfirm"))if(ge("haxConfirm")&&!l.localStorageGet("haxConfirm"))try{var n=ge("haxUserData")?JSON.parse(ge("haxUserData")):{};this.storageData=n,this._storageDataChanged(this.storageData)}catch(e){}else try{var o=l.localStorageGet("haxUserData",{});this.storageData=o,this._storageDataChanged(this.storageData)}catch(e){}else{ve("haxConfirm",!0);this.toast("\n    The HAX content editor keeps preferences in order to improve your experience.\n    This data is stored in your browser and is never sent anywhere.\n    Click to accept.\n    ","-1",{},"fit-bottom","I Accept","hax-consent-tap")}setTimeout((function(){t.__storageDataProcessed=!0,t.storageData.globalPreferences&&t.write("globalPreferences",t.storageData.globalPreferences,t)}),0)}},{key:"_storePiecesAllHere",value:function(e,t,n,o){!this.ready&&t&&e&&n&&o&&(this.dispatchEvent(new CustomEvent("hax-store-ready",{bubbles:!0,cancelable:!1,composed:!0,detail:!0})),n.shadowRoot.querySelector("#haxcancelbutton")&&(o.shadowRoot.querySelector("#dialog").associateEvents(n.shadowRoot.querySelector("#haxcancelbutton")),o.shadowRoot.querySelector("#dialog")&&window.addEventListener("simple-modal-confirmed",this._handleConfirmCancel.bind(this))),this.ready=!0,this._buildPrimitiveDefinitions())}},{key:"_handleConfirmCancel",value:function(e){e.detail.invokedBy===this.haxTray.shadowRoot.querySelector("#haxcancelbutton")&&(this.editMode=!1,this.dispatchEvent(new CustomEvent("hax-cancel",{bubbles:!0,composed:!0,cancelable:!1,detail:e.detail})))}},{key:"_initVoiceCommands",value:function(){var e=this;this.__voiceInit=!0,this.voiceCommands["scroll up ".concat(this.voiceRespondsTo)]=function(){window.scrollBy({top:-.5*window.innerHeight,left:0,behavior:"smooth"})},this.voiceCommands["scroll (down) ".concat(this.voiceRespondsTo)]=function(){window.scrollBy({top:.5*window.innerHeight,left:0,behavior:"smooth"})},this.voiceCommands["scroll to bottom ".concat(this.voiceRespondsTo)]=function(){window.scrollTo(0,document.body.scrollHeight)},this.voiceCommands["scroll to top ".concat(this.voiceRespondsTo)]=function(){window.scrollTo(0,0)},this.voiceCommands["".concat(this.voiceRespondsTo," (show)(focus) active (element)(content)")]=function(){try{e._positionCursorInNode(e.activeNode)}catch(e){}},this.voiceCommands["".concat(this.voiceRespondsTo," (focus) previous (element)(content)")]=function(){e.activeNode.previousElementSibling?(e.activeNode=e.activeNode.previousElementSibling,e.write("activeNode",e.activeNode,e),e._positionCursorInNode(e.activeNode)):e.speak("You are at the top of the document")},this.voiceCommands["".concat(this.voiceRespondsTo," (focus) next (element)(content)")]=function(){e.activeNode.nextElementSibling?(e.activeNode=e.activeNode.nextElementSibling,e.write("activeNode",e.activeNode,e),e._positionCursorInNode(e.activeNode)):e.speak("You are at the bottom of the document")},this.voiceCommands["".concat(this.voiceRespondsTo," type *mycontent")]=function(t){if(e.isTextElement(e.activeNode))try{var n=e._positionCursorInNode(e.activeNode),o=document.createTextNode(t);n.deleteContents(),n.insertNode(o)}catch(t){e.speak("That didn't work"),console.warn(t)}else e.speak("I'm sorry but I can only type in text areas. Try saying Insert Paragraph and try again.")},this.voiceCommands["hey ".concat(this.voiceRespondsTo)]=function(){e.speak("Yeah what do you want")},this.voiceCommands["".concat(this.voiceRespondsTo," now your name is *splat")]=function(t){var n=e.voiceRespondsTo;e.speak("I used to be named ".concat(n," but you can call me ").concat(t," now.")),e.voiceRespondsTo="(".concat(t,")")}}},{key:"speak",value:function(e){this.__hal&&this.__hal.speak&&this.__hal.speak(e),this.toast("".concat(this.voiceRespondsTo,": ").concat(e))}},{key:"addVoiceCommand",value:function(e,t,n){t&&(e=e.replace(":name:",this.voiceRespondsTo).toLowerCase(),this.voiceCommands[e]=t[n].bind(t),this.__voiceInit&&(this.__hal.commands=I({},this.voiceCommands)))}},{key:"_addVoiceCommand",value:function(e){var t=e.detail.context;t||(t=e.target),this.addVoiceCommand(e.detail.command,t,e.detail.callback)}},{key:"_positionCursorInNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.activeHaxBody.positionContextMenus();var n=document.createRange(),o=this.getSelection();return n.setStart(e,t),n.collapse(!0),o.removeAllRanges(),o.addRange(n),n}},{key:"_onBeforeUnload",value:function(e){if(!this.skipExitTrap&&this.editMode)return"Are you sure you want to leave? Your work will not be saved!"}},{key:"isBase64",value:function(e){try{return btoa(atob(e))==e}catch(e){return!1}}},{key:"retrieveImageFromClipboardAsBlob",value:function(e,t){if(0==e.clipboardData&&"function"==typeof t)return t(void 0);var n=e.clipboardData.items;if(null==n&&"function"==typeof t)return t(void 0);for(var o=0;o<n.length;o++)if(-1!=n[o].type.indexOf("image")){var a=n[o].getAsFile();if("function"==typeof t)return t(a)}}},{key:"_onPaste",value:(g=F(q().mark((function e(t){var n,o,a,i,r,s,c,d,u,h,p,m,g,v,b,f,x,y,k,w,N=this;return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.editMode||"HAX-TRAY"===document.activeElement.tagName||"BODY"===document.activeElement.tagName||"SIMPLE-MODAL"===document.activeElement.tagName){e.next=90;break}if(this.isTextElement(this.activeNode)||(this.activeNode=this.activeHaxBody.haxInsert("p","",{})),n="",o="",t.clipboardData||t.originalEvent.clipboardData?""==(n=(t.originalEvent||t).clipboardData.getData("text/html"))&&(n=(t.originalEvent||t).clipboardData.getData("text")):window.clipboardData&&(n=window.clipboardData.getData("Text")),n=(n=(n=(n=(n=n.trim()).replace(/<span>\s*?<\/span>/g," ")).replace(/(?:style="(\S+:\s*[^;"]+;\s*)*)+"/g,"")).replace(/<div/g,"<p")).replace(/<\/div>/g,"</p>"),o=n,!this.isBase64(o)){e.next=18;break}return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),e.abrupt("return",this.retrieveImageFromClipboardAsBlob(t,(function(e){if(e){var n=window.URL||window.webkitURL,o=document.createElement("img");for(var a in o.src=n.createObjectURL(e),N.activeNode.parentNode.insertBefore(o,N.activeNode.nextElementSibling),t.clipboardData.items)!t.clipboardData.items[a].name&&t.clipboardData.items[a].type&&(t.clipboardData.items[a].name="image-"+Math.floor(Date.now()/1e3)+t.clipboardData.items[a].type.replace("image/","."));return t.dataTransfer=t.clipboardData,t.placeHolderElement=o,N.dispatchEvent(new CustomEvent("place-holder-file-drop",{bubbles:!0,cancelable:!0,composed:!0,detail:t})),o}return!1})));case 18:if(t.clipboardData.files.length>0){for(i in t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),a=this.activeHaxBody.haxInsert("p","",{}),t.dataTransfer=t.clipboardData,t.clipboardData.files)!t.clipboardData.files[i].name&&t.clipboardData.files[i].type&&(t.clipboardData.files[i].name="image-"+Math.floor(Date.now()/1e3)+t.clipboardData.files[i].type.replace("image/","."));t.placeHolderElement=a,this.dispatchEvent(new CustomEvent("place-holder-file-drop",{bubbles:!0,cancelable:!0,composed:!0,detail:t}))}case 19:if(r=!1,s="",(c=document.createElement("div")).innerHTML=n,d=[],!c.children){e.next=36;break}return n=(n=(n=(n=l.stripMSWord(n)).replace(/<h1>/g,"<h2>")).replace(/<\/h1>/g,"</h2>")).replace(/<img src=\"file:(.*?)\/>/g,(function(e,t){var n=t.split('"');return'<place-holder type="image" text="file:'.concat(n[0],'"></place-holder>')})),e.next=31,this.htmlToHaxElements(n);case 31:if(1!==(d=e.sent).length||this.__validGridTags().includes(d[0].tag)){e.next=36;break}return e.next=35,this.htmlToHaxElements(d[0].content);case 35:d=e.sent;case 36:if(0!==d.length||!l.validURL(n)){e.next=43;break}if(""!=this.activeNode.innerText.trim()&&(r=!0),u={source:n,title:n},r||this.insertLogicFromValues(u,this,!1,!0)){e.next=41;break}return e.abrupt("return",!1);case 41:e.next=86;break;case 43:if(0!==d.length){e.next=52;break}if(r=!0,o==n){e.next=49;break}s=n,e.next=50;break;case 49:return e.abrupt("return",!1);case 50:e.next=86;break;case 52:if(1!==d.length||"p"!==d[0].tag){e.next=57;break}s=n,r=!0,e.next=86;break;case 57:if(1!==d.length||"a"!==d[0].tag||!d[0].properties.href){e.next=68;break}if(""==this.activeNode.innerText.trim()){e.next=63;break}s=d[0].properties.href,r=!0,e.next=66;break;case 63:if(h={source:d[0].properties.href,title:d[0].content},this.insertLogicFromValues(h,this)){e.next=66;break}return e.abrupt("return",!1);case 66:e.next=86;break;case 68:if(this.isGridPlateElement(d[0])){e.next=72;break}return e.abrupt("return",!1);case 72:e.t0=q().keys(d);case 73:if((e.t1=e.t0()).done){e.next=86;break}return p=e.t1.value,"p"==d[p].tag&&["li","ol","ul"].includes(this.activeNode.tagName.toLowerCase())&&(d[p].tag="li"),delete d[p].properties.style,delete d[p].properties.start,delete d[p].properties.align,m=l.haxElementToNode({tag:d[p].tag,content:d[p].content.replace(/<span>&nbsp;<\/span>/g," ").trim(),properties:d[p].properties}),e.t2=s,e.next=83,this.nodeToContent(m);case 83:s=e.t2+=e.sent,e.next=73;break;case 86:t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation();try{if(g=this.getRange(),v=this.getSelection(),(b=document.createElement("div")).innerHTML=s,g&&v){for(f in b.children)b.children[f].tagName&&this.isTextElement(b.children[f])&&""===b.children[f].innerHTML&&b.children[f].remove();if(r){if(l.validURL(n))(x=document.createElement("a")).setAttribute("href",n),x.setAttribute("rel","noopener noreferrer"),x.setAttribute("target","_blank"),x.innerText=n;else if(b.children&&b.children.length>0){for(;b.childNodes.length>1;)g.insertNode(Array.from(b.childNodes).pop());x=Array.from(b.childNodes).pop()}else x=document.createTextNode(b.innerHTML);g.insertNode(x),setTimeout((function(){N._positionCursorInNode(x,x.length)}),0)}else{for(""!=this.activeNode.innerText.trim()&&g.endOffset!=this.activeNode.innerText.length&&(y=!0,document.execCommand("insertParagraph")),g.commonAncestorContainer&&g.commonAncestorContainer.parentNode&&(w||this.activeNode==g.commonAncestorContainer||(w=g.commonAncestorContainer.parentNode)||(w=g.commonAncestorContainer));b.firstElementChild;)k=b.firstElementChild,w?(w.getAttribute&&w.getAttribute("slot")&&k.setAttribute("slot",w.getAttribute("slot")),y?(this.activeHaxBody.haxReplaceNode(w.previousElementSibling,k),y=!1):w.parentNode?w.parentNode.insertBefore(k,w.nextElementSibling):w.insertBefore(k,w.nextElementSibling)):this.activeNode?(this.activeNode.getAttribute("slot")&&k.setAttribute("slot",this.activeNode.getAttribute("slot")),""==this.activeNode.innerText.trim()?this.activeHaxBody.haxReplaceNode(this.activeNode,k):this.activeNode.parentNode.insertBefore(k,this.activeNode.nextElementSibling)):this.activeHaxBody.appendChild(k),w=k;setTimeout((function(){k&&k.childNodes&&k.childNodes[0]&&(N._positionCursorInNode(k.childNodes[0],k.childNodes[0].length),k=null,w=null)}),0)}}}catch(e){console.warn(e)}case 90:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"__validGridTags",value:function(){return["p","ol","ul","li","div","h1","h2","h3","h4","h5","h6","blockquote","code","section","dl","dd","dt","figure"]}},{key:"__validTags",value:function(){return["p","div","span","table","caption","sup","sub","u","strike","tr","th","td","ol","ul","li","a","strong","kbd","tt","em","i","b","hr","h1","h2","h3","h4","h5","h6","blockquote","code","figure","figcaption","img","iframe","video","audio","section","dl","dt","dd","template","webview"]}},{key:"__validGizmoTypes",value:function(){return["data","video","audio","text","link","file","pdf","image","csv","doc","archive","markdown","html","content","text","gif","inline","*"]}},{key:"_buildPrimitiveDefinitions",value:function(){if(this._isSandboxed){this.setHaxProperties({type:"element",editingElement:"core",canScale:!0,canPosition:!0,canEditSource:!0,settings:{configure:[{attribute:"src",title:"Source",description:"The URL for this video.",inputMethod:"textfield",icon:"link",required:!0,validationType:"url"}],advanced:[]}},"webview")}this.setHaxProperties({canScale:{min:10,step:5},type:"element",editingElement:"core",canPosition:!0,canEditSource:!0,gizmo:{title:"Image",description:"A basic img tag",icon:"image:image",color:"blue-grey",tags:["Images","media","img","html"],handles:[{type:"link",source:"src"},{type:"image",source:"src",height:"height",width:"width"}],meta:{author:"W3C",hidden:!0}},settings:{configure:[{attribute:"src",title:"Source",description:"The URL for this video.",inputMethod:"haxupload",icon:"link",required:!0,validationType:"url"},{attribute:"alt",title:"Alt text",description:"Useful for screen readers and improved SEO.",inputMethod:"alt",icon:"accessibility"},{attribute:"height",title:"Height",description:"height in pixels of the item. Leave blank to respond to the natural resolution",inputMethod:"textfield",icon:"icons:swap-vert"}],advanced:[{attribute:"loading",title:"Loading method",description:"Whether or not to lazy load this",inputMethod:"select",options:{lazy:"Load when visible",auto:"Automatic"}}]},demoSchema:[{tag:"img",content:"",properties:{src:"https://cdn2.thecatapi.com/images/9j5.jpg",loading:"lazy"}}]},"img");var e={canScale:{min:10,step:5},type:"grid",canPosition:!0,canEditSource:!0,gizmo:{title:"Figure",description:"A basic figure tag",icon:"hax:figure",color:"blue-grey",tags:["Images","media","figure","html"],requiresChildren:"figcaption",handles:[],meta:{author:"W3C",hidden:!0}},settings:{advanced:[be]},demoSchema:[{tag:"figure",properties:{},content:'<img src="https://dummyimage.com/300x200/000/fff" alt="image other media here">\n<figcaption><p>Image Caption Here</p></figcaption>'}]};this.setHaxProperties(e,"figure");var t={canScale:{min:10,step:5},type:"grid",editingElement:"core",canPosition:!0,canEditSource:!0,gizmo:{title:"Figure caption",description:"Used inside of a figure tag",icon:"image:image",color:"blue-grey",tags:["Images","media","caption","figure","html"],handles:[],requiresParent:"figure",meta:{author:"W3C",hidden:!0}},settings:{configure:[{slot:"",title:"Figure Caption",description:"Caption for the figure",inputMethod:"code-editor"},be]},demoSchema:[{tag:"figcaption",properties:{},content:"Image Caption Here"}]};this.setHaxProperties(t,"figcaption");var n={type:"element",editingElement:"core",canScale:!1,canPosition:!1,canEditSource:!0,contentEditable:!0,gizmo:{title:"Basic link",description:"A basic a tag",icon:"icons:link",color:"blue-grey",tags:["Content","link","a","url","html","href","resource","address","http"],handles:[],meta:{author:"W3C",hidden:!0}},settings:{configure:[{attribute:"innerText",title:"Text",description:"Text of the link",inputMethod:"textfield",required:!0},{attribute:"href",title:"Link",description:"The URL for this video.",inputMethod:"haxupload",required:!0,validationType:"url"},be],advanced:[{attribute:"target",title:"Target",description:"Where to place the link.",inputMethod:"select",options:{"":"Same window",_blank:"New window - _blank",_top:"Top window - _top",_parent:"Parent window - _parent"}},{attribute:"title",title:"Title text",description:"Useful for screen readers and improved SEO.",inputMethod:"textfield"},{attribute:"rel",title:"rel",description:"Specifies the relationship between this document and the opened document. Change as part of security or SEO policy.",inputMethod:"select",options:{noopener:"noopener","noopener noreferrer":"noopener noreferrer","nofollow ":"nofollow","noopener noreferrer nofollow":"noopener noreferrer nofollow",opener:"opener"}}]}};this.validGizmoTypes.forEach((function(e){n.gizmo.handles.push({type:e,source:"href",title:"innerText",alt:"title"})})),this.setHaxProperties(n,"a");var o={type:"element",editingElement:"core",canScale:!1,canPosition:!1,canEditSource:!0,contentEditable:!0,gizmo:{title:"Paragraph",description:"A basic text area",icon:"hax:paragraph",color:"blue-grey",tags:["Content","p","paragraph","text","html"],handles:[{type:"content",title:"innerHTML",alt:"title"}],meta:{author:"W3C",outlineDesigner:!0}},settings:{configure:[],advanced:[be]},demoSchema:[{tag:"p",content:"Deep thoughts..",properties:{}}]};this.setHaxProperties(o,"p");var a={type:"element",editingElement:{tag:"editable-table",import:"@lrnwebcomponents/editable-table/editable-table.js",callback:this.setupEditableTable.bind(this)},canScale:!0,canPosition:!0,canEditSource:!0,gizmo:{title:"Table",description:"A table for displaying data",icon:"image:grid-on",color:"blue-grey",tags:["Content","table","data","html","grid","matrix","spreadsheet","csv","excel"],meta:{hidden:!0,author:"W3C"}},settings:{configure:[],advanced:[]}};this.setHaxProperties(a,"table");var i=document.createElement("editable-table");this.haxAutoloader.appendChild(i);var r={type:"element",editingElement:{tag:"iframe-loader",import:"@lrnwebcomponents/iframe-loader/iframe-loader.js",callback:this.setupIframeLoader.bind(this)},canScale:!1,canPosition:!0,canEditSource:!1,gizmo:{title:"iFrame",description:"A basic way to frame external web content",icon:"hax:iframe",color:"blue-grey",tags:["Content","iframe","content","url","link","embed","https","html","resource","address"],handles:[],meta:{hidden:!0,author:"W3C"}},settings:{configure:[{attribute:"src",title:"Source",description:"The URL for this video.",inputMethod:"textfield",icon:"link",required:!0,validationType:"url"}]}};this.setHaxProperties(r,"iframe");var s=document.createElement("iframe-loader");this.haxAutoloader.appendChild(s);var l={caption:{title:"Caption",icon:"av:call-to-action"},video:{title:"Video",icon:"av:play-circle-filled"},audio:{title:"Audio",icon:"image:music-note"},section:{title:"Section",icon:"image:crop-landscape"},dl:{title:"Data list",icon:"editor:format-list-bulleted"},dt:{title:"Data term",icon:"editor:format-list-bulleted"},dd:{title:"Data definition",icon:"editor:format-list-bulleted"},ol:{title:"Numbered list",icon:"editor:format-list-numbered"},ul:{title:"Bulleted list",icon:"editor:format-list-bulleted"},li:{title:"List item",icon:"editor:format-list-bulleted"},h1:{title:"Heading",icon:"hax:h1"},h2:{title:"Heading",icon:"hax:h2"},h3:{title:"Heading",icon:"hax:h3"},h4:{title:"Heading",icon:"hax:h4"},h5:{title:"Heading",icon:"hax:h5"},h6:{title:"Heading",icon:"hax:h6"},strike:{title:"Cross out",icon:"editor:format-strikethrough"},u:{title:"Underline",icon:"editor:format-underlined"},sub:{title:"Subscript",icon:"mdextra:subscript"},sup:{title:"Superscript",icon:"mdextra:superscript"},div:{title:"DIV",icon:"image:crop-landscape"},span:{title:"SPAN",icon:"editor:short-text",handles:[{type:"inline",text:"text"}]},i:{title:"Italic",icon:"editor:format-italic"},em:{title:"Emphasis",icon:"editor:format-italic"},strong:{title:"Bold",icon:"editor:format-bold"},b:{title:"Bold",icon:"editor:format-bold"},blockquote:{title:"Block quote",icon:"editor:format-quote"},code:{title:"Code",icon:"icons:code"},embed:{title:"Embedded object",icon:"icons:fullscreen"}};for(var c in l){var d="";"h2"==c?d="Heading":"ul"!=c&&"ol"!=c||(d="<li>Item 1</li><li>Item 2</li>"),this.setHaxProperties({type:"element",editingElement:"core",canScale:!1,canPosition:!1,canEditSource:!0,contentEditable:!0,gizmo:{title:l[c].title,icon:l[c].icon,tags:["Content",c,"html","text"],handles:l[c].handles||[],meta:{author:"HAXTheWeb core team",inlineOnly:!!["em","b","strong","i","strike","u","sub","sup","span"].includes(c),hidden:!["h2","ul"].includes(c),outlineDesigner:!!["h2","ul"].includes(c)}},settings:{configure:[],advanced:[be]},demoSchema:[{tag:c,content:d,properties:{}}]},c)}var u={canScale:{min:25,step:25},type:"element",editingElement:"core",canPosition:!1,canEditSource:!1,contentEditable:!0,gizmo:{title:"Horizontal line",icon:"hax:hr",meta:{author:"W3C"}},settings:{configure:[],advanced:[be]},demoSchema:[{tag:"hr",content:"",properties:{style:"width:50%;"}}]};this.setHaxProperties(u,"hr")}},{key:"_haxStorePieceRegistrationManager",value:function(e){e.detail&&e.detail.piece&&e.detail.object&&(this[e.detail.piece]=e.detail.object)}},{key:"setupEditableTable",value:function(e){this.activeNode=e,setTimeout((function(){e.editMode=!0,e.focus()}),0)}},{key:"setupIframeLoader",value:function(e){this.activeNode=e,setTimeout((function(){e.disabled=!0}),0)}},{key:"setupAutocomplete",value:function(e){var t=this;e.triggers={"!":function(e){var n=[];return t.gizmoList.forEach((function(e){n.push({tags:e.tags&&e.tags.length?e.tags.join(" "):"",icon:e.icon,label:e.title,value:e.tag})})),n}}}},{key:"_haxStoreInsertContent",value:(m=F(q().mark((function e(t){var n,o,a,i,r,s;return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.detail){e.next=13;break}if(n=t.detail,!window.customElements.get(n.tag)){e.next=8;break}if(o=document.createElement(n.tag),!this.testHook(o,"preProcessInsertContent")){e.next=8;break}return e.next=7,this.runHook(o,"preProcessInsertContent",[n,this.activeNode]);case 7:n=e.sent;case 8:a={},"undefined"!==G(n.properties)&&(a=n.properties),a.innerHTML&&(""==n.content&&(n.content=a.innerHTML),delete a.innerHTML),a.innerText&&(""==n.content&&(n.content=a.innerText),delete a.innerText),"undefined"!==G(n.__type)&&"inline"===n.__type?(i=l.haxElementToNode({tag:n.tag,content:n.content,properties:a}),null!==this.activePlaceHolder&&(this.activePlaceHolder.deleteContents(),this.activePlaceHolder.insertNode(i)),this.activePlaceHolder=null):n.replace||n.replacement||n.nextToActive?(r=l.haxElementToNode({tag:n.tag,content:n.content,properties:a}),this.activePlaceHolder?(this.activeHaxBody.haxReplaceNode(this.activePlaceHolder,r),this.activePlaceHolder=null):n.nextToActive&&this.activeNode?this.activeHaxBody.__slot&&this.activeNode.haxLayoutContainer?this.activeNode.appendChild(r):this.activeNode.parentNode.insertBefore(r,this.activeNode):this.activeHaxBody.haxReplaceNode(this.activeNode,r)):this.activeNode.parentNode&&"HAX-BODY"!=this.activeNode.parentNode.tagName?(s=l.haxElementToNode({tag:n.tag,content:n.content,properties:a}),this.activeNode.parentNode.haxLayoutContainer?(null!=this.activeNode.getAttribute("slot")&&s.setAttribute("slot",this.activeNode.getAttribute("slot")),this.activeHaxBody.haxInsert(n.tag,n.content,a)):this.activeHaxBody.haxInsert(n.tag,n.content,a)):this.activeHaxBody.haxInsert(n.tag,n.content,a);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"slotsFromSchema",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e?e.settings:{},o=[];return Object.keys(I({},n||{})).map((function(e){return(n[e]||[]).filter((function(e){var n=!t||!e.required;return!(!e.slot&&""!==e.slot||o.includes(e.slot)||!n)&&(o.push(e.slot),!0)}))})).flat()}},{key:"haxSchemaFromTag",value:function(e){return e&&e.toLowerCase&&(e=e.toLowerCase(),this.elementList&&this.elementList[e])?this.elementList[e]:{}}},{key:"_haxStoreInsertMultiple",value:function(e){var t;if(e.detail)for(var n in e.detail)t={},"undefined"!==G(e.detail[n].properties)&&(t=e.detail[n].properties),this.activeHaxBody.haxInsert(e.detail[n].tag,e.detail[n].content,t)}},{key:"_haxStoreRegisterBody",value:function(e){var t=this;e.detail&&(this.haxBodies.push(e.detail),this.activeHaxBody=e.detail,this.write("activeHaxBody",this.activeHaxBody,this),this.write("editMode",this.editMode,this),clearTimeout(this.__storeReady),this.__storeReady=setTimeout((function(){t._storePiecesAllHere(t.haxAutoloader,t.activeHaxBody,t.haxTray,t.haxCancel)}),0))}},{key:"_superDaemonInsert",value:function(e){this.haxTray._processTrayEvent(e)}},{key:"computePolyfillSafe",value:function(){return!(!document.head.createShadowRoot&&!document.head.attachShadow)||(console.warn("Shadow DOM missing, certain operations hidden"),!1)}},{key:"_writeHaxStore",value:function(e){e.detail&&"undefined"!==G(e.detail.value)&&e.detail.property&&e.detail.owner&&(e.detail.owner!==this&&(null==e.detail.value?this[e.detail.property]=null:"object"===G(e.detail.value)&&(this[e.detail.property]={}),this[e.detail.property]=e.detail.value),this.dispatchEvent(new CustomEvent("hax-store-property-updated",{bubbles:!0,composed:!0,cancelable:!1,detail:{property:e.detail.property,value:e.detail.value,owner:e.detail.owner}})))}},{key:"_haxStoreRegisterApp",value:function(e){if(e.detail){if(e.detail.index=this.appList.length,this.appList=[].concat(se(this.appList),[e.detail]),this.write("appList",c.toJS(this.appList),this),e.detail.connection&&e.detail.connection.protocol&&e.detail.connection.url){var t=document.createElement("link");t.rel="preconnect",t.href=e.detail.connection.protocol+"://"+e.detail.connection.url,document.head.appendChild(t)}"undefined"!==G(e.target.parentElement)&&"HAX-STORE"===e.target.parentElement.tagName&&e.target.parentElement.removeChild(e.target)}}},{key:"_haxStoreRegisterStax",value:function(e){e.detail&&(e.detail.index=this.staxList.length,this.staxList=[].concat(se(this.staxList),[e.detail]),this.write("staxList",this.staxList,this),"undefined"!==G(e.target.parentElement)&&"HAX-STORE"===e.target.parentElement.tagName&&e.target.parentElement.removeChild(e.target))}},{key:"activeBodyIgnoreActive",value:function(e){this.activeHaxBody.__ignoreActive=e}},{key:"dashToCamel",value:function(e){return e.replace(/-([a-z])/g,(function(e){return e[1].toUpperCase()}))}},{key:"htmlToHaxElements",value:(d=F(q().mark((function e(t){var n,o,a,i,r;return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[],(o=document.createElement("div")).innerHTML=t,!o.children){e.next=17;break}a=this.validTagList,i=o.children,r=0;case 7:if(!(r<i.length)){e.next=17;break}if("undefined"===G(i[r].tagName)||!a.includes(i[r].tagName.toLowerCase())){e.next=14;break}return e.t0=n,e.next=12,l.nodeToHaxElement(i[r],null);case 12:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 14:r++,e.next=7;break;case 17:return e.abrupt("return",n);case 18:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"nodeToContent",value:(r=F(q().mark((function e(t){var n,o,a,i,r,s,c,d,u,h,p,m,g,v,b,f,x;return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.testHook(t,"preProcessNodeToContent")){e.next=4;break}return e.next=3,this.runHook(t,"preProcessNodeToContent",[t]);case 3:t=e.sent;case 4:for(n=t.tagName.toLowerCase(),this._isSandboxed&&"webview"===n&&(n="iframe"),o="",o+="<"+n,a=this.elementList[n],i={},r=0,s=t.attributes.length;r<s;++r)c=t.attributes.item(r).nodeName,d=t.attributes.item(r).value,"style"==c||G(d)!==("undefined"==typeof Object?"undefined":G(Object))&&d.constructor!==Array?null!=d&&"null"!=d&&(!0===d||"true"===d?i[c]=!0:!1===d||("string"==typeof d&&""!==d?(d=d.replace(new RegExp('"',"g"),"&quot;"),i[c]=d):""===d?(""==d&&""!=t.attributes.item(r).value&&(d=t.attributes.item(r).value),i[c]=d):i[c]=d)):i[c]=JSON.stringify(d).replace(new RegExp('"',"g"),"&quot;");if(customElements.get(n)&&(u=customElements.get(n).properties),"undefined"===G(u)&&(u=t.__data),"undefined"!==G(u))for(h in u)c=l.camelToDash(h),d=null,"undefined"!==G(t[h])&&(d=t[h]),u[h].readOnly||u[h].computed||d===u[h].value||c.startsWith("__")||(null==d||"object"!==G(d)&&d.constructor!==Array?null!=d&&"null"!=d&&(!0===d||"true"===d?i[c]=!0:!1===d||("string"==typeof d&&""!==d?(d=d.replace(new RegExp('"',"g"),"&quot;"),i[c]=d):""===d?""==d&&""!=u[h].value?d=u[h].value:""===d&&u[h].value:i[c]=d)):(d.constructor===Array&&d!=[]||"object"===G(d)&&d!={})&&(i[c]=JSON.stringify(d).replace(new RegExp('"',"g"),"&quot;")));if("undefined"!==G(a)&&"undefined"!==G(a.saveOptions.unsetAttributes))for(p in a.saveOptions.unsetAttributes)delete i[a.saveOptions.unsetAttributes[p]];for(g in m=["inner-text","inner-html","tabindex","guestinstance"])"undefined"!==G(i[m[g]])&&delete i[m[g]];for(v in"undefined"!==G(i.id)&&""===i.id&&delete i.id,delete i.draggable,delete i.contenteditable,delete i["data-hax-ray"],delete i["data-hax-layout"],delete i["data-hax-active"],""==i.class&&delete i.class,i)!0===i[v]?o+=" "+v:o+=" "+v+'="'+i[v]+'"';if(["area","base","br","col","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"].includes(n)?o+="/>":o+=">","undefined"!==G(a)&&a.saveOptions.wipeSlot){e.next=49;break}if(!((b=t.childNodes).length>0)){e.next=49;break}f=0,x=b.length;case 31:if(!(f<x)){e.next=49;break}if("undefined"===G(b[f].tagName)){e.next=45;break}if(this.HTMLPrimativeTest(b[f].tagName)||"TEMPLATE"===b[f].tagName){e.next=40;break}return e.t0=o,e.next=37,this.nodeToContent(b[f]);case 37:o=e.t0+=e.sent,e.next=43;break;case 40:b[f].removeAttribute("data-hax-ray"),b[f].contentEditable=!1,o+=b[f].outerHTML;case 43:e.next=46;break;case 45:8===b[f].nodeType?o+="\x3c!-- "+b[f].textContent+" --\x3e":1!==b[f].nodeType&&"undefined"!==G(b[f].textContent)&&"undefined"!==b[f].textContent&&(o+=l.htmlEntities(b[f].textContent));case 46:f++,e.next=31;break;case 49:if(!this.testHook(t,"progressiveEnhancement")){e.next=54;break}return e.t1=o,e.next=53,this.runHook(t,"progressiveEnhancement",[t]);case 53:o=e.t1+=e.sent;case 54:if("span"===n?o+="</"+n+">":"hr"===n||"br"===n||"img"===n||(o+="</"+n+">\n"),o=(o=(o=(o=(o=(o=(o=(o=(o=(o=(o=(o=(o=(o=(o=(o=(o=(o=(o=o.replace(/&nbsp;/gm," ")).replace(/ data-hax-ray="(\s|.)*?"/gim,"")).replace(/ data-hax-active="(\s|.)*?"/gim,"")).replace(/ class=""/gim,"")).replace(/ contenteditable="(\s|.)*?"/gim,"")).replace(/<span style="(.*?)">/gim,"<span>")).replace(/<span>\s*?<\/span>/g," ")).replace(/<span><br\/><\/span>/gm,"")).replace(/<strong style="(.*?)">/gim,"<strong>")).replace(/<b style="(.*?)">/gim,"<b>")).replace(/<strike style="(.*?)">/gim,"<strike>")).replace(/<em style="(.*?)">/gim,"<em>")).replace(/<i style="(.*?)">/gim,"<i>")).replace(/<p>(\s*)<\/p>/gm,"<p></p>")).replace(/<p>&nbsp;<\/p>/gm,"<p></p>")).replace(/<p><br\/><\/p>/gm,"<p></p>")).replace(/<p><br><\/p>/gm,"<p></p>")).replace(/<\/p>(\s*)<p>/gm,"</p><p>")).split("\n\r").join("\n").split("\r").join("\n").split("\n\n").join("\n").split("\n\n").join("\n").split("\n\n").join("\n"),!this.testHook(t,"postProcessNodeToContent")){e.next=78;break}return e.next=77,this.runHook(t,"postProcessNodeToContent",[o]);case 77:o=e.sent;case 78:return e.abrupt("return",o);case 79:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"HTMLPrimativeTest",value:function(e){return"undefined"!==G(e.tagName)&&-1==e.tagName.indexOf("-")}},{key:"getHaxAppStoreTargets",value:function(e){return c.toJS(this.appList).filter((function(t){if("undefined"!==G(t.connection.operations.add)){var n=t.connection.operations.add;if("undefined"!==G(n.acceptsGizmoTypes)&&n.acceptsGizmoTypes.includes(e))return!0}return!1}))}},{key:"refreshActiveNodeForm",value:(i=F(q().mark((function e(){return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.nodeToHaxElement(this.haxTray.activeNode,null);case 2:return this.haxTray.activeHaxElement=e.sent,e.next=5,this.haxTray._setupForm();case 5:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"haxElementPrototype",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return{tag:e.tag,properties:t,content:n,gizmo:e}}},{key:"getHAXSlot",value:(a=F(q().mark((function e(t){var n,o,a,i;return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isTextElement(t)){e.next=2;break}return e.abrupt("return",t.innerHTML);case 2:if(n="",!((o=t.childNodes).length>0)){e.next=26;break}a=0,i=o.length;case 6:if(!(a<i)){e.next=26;break}if(o[a]){e.next=9;break}return e.abrupt("return");case 9:if("undefined"===G(o[a].tagName)){e.next=22;break}if(!(o[a].tagName.indexOf("-")>0)){e.next=19;break}return e.t0=n,e.next=14,this.nodeToContent(o[a]);case 14:e.t1=e.sent,e.t2="  "+e.t1,n=e.t0+=e.t2+"\n",e.next=20;break;case 19:n+="  "+o[a].outerHTML+"\n";case 20:e.next=23;break;case 22:8===o[a].nodeType?n+="\x3c!-- "+o[a].textContent+" --\x3e":1!==o[a].nodeType&&"undefined"!==G(o[a].textContent)&&"undefined"!==o[a].textContent&&(n+=o[a].textContent);case 23:a++,e.next=6;break;case 26:return e.abrupt("return",n);case 27:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"_haxStoreRegisterProperties",value:(n=F(q().mark((function e(t){var n,o,a;return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.detail&&t.detail.properties&&t.detail.tag)){e.next=15;break}if(this.elementList[t.detail.tag]){e.next=14;break}return n=t.detail,e.next=5,this.attemptGizmoTranslation(n.tag,n.properties);case 5:if(n.properties=e.sent,(o=n.properties.gizmo)&&(o.tag=n.tag,(a=this.gizmoList).push(o),this.gizmoList=se(a),this.write("gizmoList",a,this),o.meta&&(o.meta.inlineOnly||o.meta.hidden)||p.SuperDaemonInstance.defineOption({title:o.title,icon:o.icon,key:o.shortcutKey?"".concat(this.daemonKeyCombo," ").concat(o.shortcutKey):null,tags:o.tags||[],value:{value:o.tag,eventName:"insert-tag",demoSchema:!0},eventName:"hax-super-daemon-insert-tag",path:"HAX/insert/block/"+o.tag})),this.elementList[n.tag]=n.properties,this.validTagList.find((function(e){return e===n.tag}))||this.validTagList.push(n.tag),"grid"!=n.properties.type||this.validGridTagList.find((function(e){return e===n.tag}))||this.validGridTagList.push(n.tag),!window.customElements.get(t.detail.tag)||!this.testHook(document.createElement(t.detail.tag),"gizmoRegistration")){e.next=14;break}return e.next=14,this.runHook(document.createElement(t.detail.tag),"gizmoRegistration",[this]);case 14:"undefined"!==G(t.target.parentElement)&&"HAX-AUTOLOADER"===t.target.parentElement.tagName&&this.haxAutoloader.removeChild(t.target);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"activeGizmo",get:function(){var e=c.toJS(this._calculateActiveGizmo(this.activeNode));return this.write("activeGizmo",e,this),e}},{key:"activeNodeIndex",get:function(){var e=this,t=null;return this.activeNode&&Array.from(c.toJS(this.activeHaxBody).children).map((function(n,o){c.toJS(e.activeNode)!==n&&c.toJS(e.activeNode).parentElement!==n||(t=o)})),t}},{key:"attemptGizmoTranslation",value:(t=F(q().mark((function e(t,n){var o,a,i,r,s,l,c;return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.I18NManagerStore.loadNamespaceFile(t+".haxProperties");case 2:if((o=e.sent)||"en"!=this.globalPreferences.haxLang||!window.customElements.get(t)||!window.customElements.get(t).haxProperties){e.next=9;break}if("string"!=typeof(o=window.customElements.get(t).haxProperties)){e.next=9;break}return e.next=8,fetch(o).then((function(e){return!(!e||!e.json)&&e.json()}));case 8:o=e.sent;case 9:if(o){if(n.gizmo&&o.gizmo)for(a in o.gizmo)n.gizmo[a]=o.gizmo[a];if(n.settings&&o.settings)for(i in{advanced:"advanced",configure:"configure"})if(n.settings[i]&&o.settings[i])for(r in o.settings[i])for(s in o.settings[i][r])n.settings[i][r][s]=o.settings[i][r][s];if(n.demoSchema&&o.demoSchema)for(l in o.demoSchema)if(o.demoSchema[l].properties)for(c in o.demoSchema[l].properties)n.demoSchema[l].properties[c]=o.demoSchema[l].properties[c]}return e.abrupt("return",n);case 11:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}],[{key:"tag",get:function(){return"hax-store"}},{key:"properties",get:function(){return I(I({},ie(K(k),"properties",this)),{},{voiceDebug:{type:Boolean,attribute:"voice-debug"},voiceRespondsTo:{type:String,attribute:"voice-responses-to"},skipHAXConfirmation:{type:Boolean,reflect:!0,attribute:"skip-hax-confirmation"},storageData:{type:Object},haxTray:{type:Object},haxCancel:{type:Object},haxAutoloader:{type:Object},haxBodies:{type:Array},activePlaceHolder:{type:Object},appStore:{type:Object},sessionObject:{type:Object},skipExitTrap:{type:Boolean},elementList:{type:Object},staxList:{type:Array},validTagList:{type:Array},validGridTagList:{type:Array},validGizmoTypes:{type:Array},_isSandboxed:{type:Boolean},__appStoreData:{type:Object},ready:{type:Boolean},connectionRewrites:{type:Object}})}}]),k}(u.I18NMixin(l.winEventsElement(d.HAXElement(o.LitElement))));customElements.define(fe.tag,fe),window.HaxStore=window.HaxStore||{},window.HaxStore.requestAvailability=function(){return window.HaxStore.instance||(window.HaxStore.instance=document.createElement("hax-store"),document.body.appendChild(window.HaxStore.instance)),window.HaxStore.instance};var xe=window.HaxStore.requestAvailability();window.Hax=window.Hax||{},window.Hax.add=function(e){if(xe.elementList[e]){var t,n=xe.haxSchemaFromTag(e);t=n.gizmo.tag&&n.demoSchema&&n.demoSchema[0]?l.haxElementToNode(n.demoSchema[0]):document.createElement(e),xe.activeHaxBody.haxReplaceNode(xe.activeNode,t),xe.activeHaxBody.__focusLogic(t)}else xe.toast("".concat(e," is not a valid tag"))},window.Hax.delete=function(){null!=xe.activeNode&&xe.activeHaxBody.haxDeleteNode(xe.activeNode)},window.Hax.duplicate=function(){xe.activeHaxBody.haxDuplicateNode(xe.activeNode)},window.Hax.move=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e?xe.activeHaxBody.haxMoveGridPlate(xe.activeNode,-1):xe.activeHaxBody.haxMoveGridPlate(xe.activeNode)},window.Hax.grid=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];xe.activeHaxBody.haxGridPlateOps(e)},window.Hax.set=function(e,t){xe.write(e,t,window)},window.Hax.get=function(e){return xe[e]},window.Hax.export=F(q().mark((function e(){return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xe.activeHaxBody.haxToContent();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),window.Hax.import=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"<p></p>";return xe.activeHaxBody.importContent(e)};var ye,ke,we=function(e){J(n,e);var t=oe(n);function n(){var e;return V(this,n),(e=t.call(this)).tag=n.tag,e.toggles=!0,e.command="insertHTML",e}return X(n,[{key:"targetedNode",get:function(){var e=this.__highlight.querySelectorAll(this.tagsList);return 1===e.length?e[0]:this.__highlight}},{key:"firstUpdated",value:function(e){this.updateElement(),ie(K(n.prototype),"firstUpdated",this)&&ie(K(n.prototype),"firstUpdated",this).call(this,e)}},{key:"updated",value:function(e){var t=this;ie(K(n.prototype),"updated",this).call(this,e),e.forEach((function(e,n){"element"===n&&t.element&&t.updateElement()}))}},{key:"updateElement",value:function(){this.dispatchEvent(new CustomEvent("deregister-button",{bubbles:!0,cancelable:!0,composed:!0,detail:this}));var e=this.element||{},t=e.settings||{},n=e.gizmo||{};this.fields=se((t.configure||[]).map((function(e){return""===e.slot&&(e.property="innerHTML"),e}))),this.tagsList=n.tag||"span",this.icon=n.icon||"add",this.label=n.title||n.tag,this.value=this.getValue(void 0),this.dispatchEvent(new CustomEvent("deregister-button",{bubbles:!0,cancelable:!0,composed:!0,detail:this}))}},{key:"getValue",value:function(){var e=this,t=ie(K(n.prototype),"getValue",this).call(this);return this.fields.forEach((function(n){n.property&&"innerHTML"!==n.property&&(t[n.property]=e.targetedNode&&e.targetedNode.getAttribute?e.targetedNode.getAttribute(n.property):void 0),n.slot&&""!==n.slot&&e.targetedNode&&e.targetedNode.querySelector&&e.targetedNode.querySelector("[slot=".concat(n.slot,"]"))&&e.targetedNode.querySelector("[slot=".concat(n.slot,"]")).innerHTML,n.slot&&""===n.slot&&e.targetedNode&&se(e.targetedNode.children||[]).filter(":not([slot])")&&se(e.targetedNode.children||[]).filter(":not([slot])").length>0&&"".concat(se(e.targetedNode.children||[]).filter(":not([slot])").join("\n"))})),t}},{key:"setToggled",value:function(){this.toggled=!!this.value}},{key:"tagClickCallback",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.detail&&this.open(e.detail);var t=this.__highlight.innerHTML;this.__highlight.innerHTML="",this.__highlight.innerHTML=t}},{key:"updateSelection",value:function(){var e=this,t=document.createElement(this.tagsList),n="";this.fields.forEach((function(o){o.property&&"innerHTML"!==o.property&&(t[o.property]=e.value[o.property]),o.slot&&e.value[o.slot]&&(n+="<".concat(e.getSlotWrapper(o)).concat(Object.keys(o.slotAttributes||{}).map((function(e){return" ".concat(e,'="').concat(o.slotAttributes[e],'"')})),">\n            ").concat(e.value[slot],"\n          </").concat(e.getSlotWrapper(o),">"))})),n+=this.value.innerHTML||"",this.__highlight.innerHTML="",this.__highlight.parentNode.insertBefore(t,this.__highlight),this.__highlight.unwrap(),t.innerHTML=n}},{key:"getSlotWrapper",value:function(e){var t=e.slotWrapper,n=e.allowedSlotWrappers,o=e.excludedSlotWrappers||[],a=["span","div","p"].filter((function(e){return!o.includes(e)}));return t||(n&&n[0]?n[0]:a)}}],[{key:"tag",get:function(){return"hax-text-editor-button"}},{key:"properties",get:function(){return I(I({},ie(K(n),"properties",this)),{},{element:{type:Object}})}}]),n}(x.RichTextEditorPromptButtonBehaviors(o.LitElement));customElements.define(we.tag,we);var Ne,Ee,_e=function(e){return function(e){J(n,e);var t=oe(n);function n(){var e;return V(this,n),(e=t.call(this)).viewSource=!1,c.autorun((function(){e.hasSelectedText=c.toJS(xe.haxSelectedText).length>0})),c.autorun((function(){c.toJS(xe.editMode);var t=c.toJS(xe.activeNode);if(e.sourceView=!1,t&&t.tagName){var n=xe.haxSchemaFromTag(t.tagName);e.parentSchema=t&&t.parentNode?xe.haxSchemaFromTag(t.parentNode.tagName):void 0,e.sourceView=n.canEditSource}})),e}return X(n,[{key:"render",value:function(){return o.html(ye||(ye=re(["<slot></slot> "])))}},{key:"slotSchema",get:function(){var e={};if(this.activeNode&&this.parentSchema){var t=this.activeNode.slot||"";this.activeNode&&this.activeNode.parentNode||(e=xe.schemaBySlotId(this.activeNode.parentNode,t))}return e}},{key:"layoutElement",get:function(){return this.activeNode&&xe.isLayoutElement(this.activeNode)?this.activeNode:this.activeNode&&this.activeNode.parentNode&&xe.isLayoutElement(this.activeNode.parentNode)?this.activeNode.parentNode:void 0}},{key:"layoutParent",get:function(){return this.layoutElement&&this.layoutElement.parentNode&&xe.isLayoutElement(this.layoutElement.parentNode)&&this.layoutElement.parentNode.tagName&&"HAX-BODY"!==this.layoutElement.parentNode.tagName?this.layoutElement.parentNode:void 0}},{key:"slottedItems",get:function(){if(!this.activeNode)return[];var e=xe.slottedContentByNode(this.layoutElement)||{};return Object.keys(e).map((function(t){return e[t]}))}},{key:"elementIcon",value:function(e){var t=e&&this.elementGizmo(e)?this.elementGizmo(e):void 0;return t?t.icon:void 0}},{key:"elementLabel",value:function(e){var t=e&&this.elementGizmo(e)?this.elementGizmo(e):void 0;return t?t.title||t.tag:e&&e.tagName?e.tagName.toLowerCase():""}},{key:"elementGizmo",value:function(e){var t=e&&e.tagName?xe.haxSchemaFromTag(e.tagName):void 0;return t&&t.gizmo?t.gizmo:void 0}},{key:"getFilteredBlocks",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.filter((function(t){if(t.tag){var n=t.tag||"",o=e.slotSchema&&e.slotSchema.slotWrapper&&e.slotSchema.slotWrapper?e.slotSchema.slotWrapper:void 0,a=e.slotSchema&&e.slotSchema.slotWrapper&&e.slotSchema.allowedSlotWrappers?e.slotSchema.allowedSlotWrappers:void 0,i=e.slotSchema&&e.slotSchema.slotWrapper&&e.slotSchema.excludedSlotWrappers?e.slotSchema.excludedSlotWrappers:void 0,r=!e.slotSchema||!a,s=!!o&&o===n||!!a&&a.includes(n);return!(!!i&&i.includes(n))&&(r||s)}}))}},{key:"updated",value:function(e){var t=this;ie(K(n.prototype),"updated",this)&&ie(K(n.prototype),"updated",this).call(this,e),e.forEach((function(e,n){"activeNode"===n&&t.activeNode!==e&&t.setTarget(t.activeNode)}))}},{key:"setTarget",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeNode;ie(K(n.prototype),"setTarget",this)&&ie(K(n.prototype),"setTarget",this).call(this,e),this.parentSchema=e&&e.parentNode?xe.haxSchemaFromTag(e.parentNode.tagName):void 0}}],[{key:"styles",get:function(){return[o.css(ke||(ke=re(["\n          :host {\n            display: block;\n            --hax-ui-spacing-sm: 1px;\n            max-width: 100%;\n          }\n          :host [hidden] {\n            display: none;\n          }\n          .selected-buttons {\n            transition: 0.1s all ease-in-out;\n            width: 0;\n          }\n          :host([has-selected-text]) .selected-buttons {\n            width: 100%;\n          }\n          :host(.hax-context-pin-top) #toolbar {\n            position: fixed;\n            top: 0px;\n          }\n          :host(:hover),\n          :host(:focus-within) {\n            z-index: var(--hax-ui-focus-z-index) !important;\n          }\n          .group {\n            padding: 0;\n            background-color: var(--hax-ui-background-color);\n          }\n          hax-toolbar {\n            flex: 0 1 auto;\n          }\n          hax-toolbar::part(morebutton) {\n            border: 1px solid\n              var(\n                --simple-toolbar-group-border-width,\n                var(--simple-toolbar-border-width, 1px)\n              ) !important;\n          }\n          hax-toolbar[collapse-disabled]::part(morebutton) {\n            display: none !important;\n          }\n          hax-toolbar *[hidden] {\n            display: none !important;\n          }\n          hax-toolbar[collapse-disabled]::part(morebutton) {\n            display: none !important;\n          }\n        "])))]}},{key:"tag",get:function(){return"hax-context-behaviors"}},{key:"properties",get:function(){return I(I({},ie(K(n),"properties",this)),{},{activeNode:{type:Object},parentSchema:{type:Object},realSelectedValue:{type:String},sourceView:{type:Boolean},viewSource:{type:Boolean}})}}]),n}(k.SimpleTourFinder(e))},Se=function(e){J(n,e);var t=oe(n);function n(){var e;return V(this,n),(e=t.call(this)).command="paste",e.icon="content-paste",e.label="Paste Clipboard",e}return X(n,[{key:"render",value:function(){return ie(K(n.prototype),"render",this).call(this)}},{key:"sendCommand",value:function(e){navigator&&navigator.clipboard&&xe._onPaste(I(I({},e),{},{clipboardData:navigator.clipboard}))}}],[{key:"tag",get:function(){return"hax-text-editor-paste-button"}},{key:"properties",get:function(){return I({},ie(K(n),"properties",this))}}]),n}(w.RichTextEditorButtonBehaviors(o.LitElement));customElements.define(Se.tag,Se);var Te,Ae,Le,Ce,He,Be,Me,Pe,Oe,ze,De,Re,je=function(e){J(n,e);var t=oe(n);function n(){var e;return V(this,n),(e=t.call(this)).tag=n.tag,e.t={undoButton:"Undo",redoButton:"Redo",formatButton:"Format",blockP:"Paragraph",blockH1:"Heading 1",blockH2:"Heading 2",blockH3:"Heading 3",blockH4:"Heading 4",blockH5:"Heading 5",blockH6:"Heading 6",blockPre:"Preformatted",italicButton:"Italic",boldButton:"Bold",underlineButton:"Underline",strikethroughButton:"Cross out",codeButton:"Code",removeFormatButton:"Remove format",linkButton:"Link",unlinkButton:"Remove Link",cutButton:"Cut",copyButton:"Copy",pasteButton:"Paste Clipboard",subscriptButton:"Subscript",superscriptButton:"Superscript",symbolButton:"Insert Symbol",emojiButton:"Insert Emoticon",imageButton:"Insert Image",orderedListButton:"Bulleted list",unorderedListButton:"Numbered list",blockquoteButton:"Blockquote",indentButton:"Indent",outdentButton:"Outdent",textEditorToolbarTour:"Change how the text is structured and visualized in the page."},e.registerLocalization({context:te(e),namespace:"hax"}),e.sourceView=!1,e.haxUIElement=!0,e.tourName="hax",window.HaxTextEditorToolbarConfig=window.HaxTextEditorToolbarConfig||{},window.HaxTextEditorToolbarConfig.inlineGizmos=window.HaxTextEditorToolbarConfig.inlineGizmos||{},window.HaxTextEditorToolbarConfig.default=window.HaxTextEditorToolbarConfig.default||se(e.defaultConfig),e.config=window.HaxTextEditorToolbarConfig.default,e.sticky=!1,e.__updated=!1,e.setTarget(void 0),window.addEventListener("hax-store-ready",e._handleHaxStoreReady.bind(te(e))),window.addEventListener("hax-register-properties",e._handleElementRegister.bind(te(e))),e}return X(n,[{key:"tourTemplate",get:function(){return o.html(Ne||(Ne=re([' <div slot="tour" data-stop-content>\n      ',"\n    </div>"])),this.t.textEditorToolbarTour)}},{key:"render",value:function(){return ie(K(n.prototype),"toolbarTemplate",this)}},{key:"undoButton",get:function(){return I(I({},ie(K(n.prototype),"undoButton",this)),{},{label:this.t.undoButton})}},{key:"redoButton",get:function(){return I(I({},ie(K(n.prototype),"redoButton",this)),{},{label:this.t.redoButton})}},{key:"formatButton",get:function(){return I(I({},ie(K(n.prototype),"formatButton",this)),{},{label:this.t.formatButton,blocks:this.formatBlocks})}},{key:"formatBlocks",get:function(){return[{label:this.t.blockP,tag:"p"},{label:this.t.blockquoteButton,tag:"blockquote"},{label:this.t.blockH2,tag:"h2"},{label:this.t.blockH3,tag:"h3"},{label:this.t.blockH4,tag:"h4"},{label:this.t.blockH5,tag:"h5"},{label:this.t.blockH6,tag:"h6"},{label:this.t.blockPre,tag:"pre"}]}},{key:"boldButton",get:function(){return I(I({},ie(K(n.prototype),"boldButton",this)),{},{label:this.t.boldButton})}},{key:"italicButton",get:function(){return I(I({},ie(K(n.prototype),"italicButton",this)),{},{label:this.t.italicButton})}},{key:"underlineButton",get:function(){return I(I({},ie(K(n.prototype),"underlineButton",this)),{},{label:this.t.underlineButton})}},{key:"strikethroughButton",get:function(){return I(I({},ie(K(n.prototype),"strikethroughButton",this)),{},{label:this.t.strikethroughButton})}},{key:"codeButton",get:function(){return I(I({},ie(K(n.prototype),"codeButton",this)),{},{icon:"hax:html-code",label:this.t.codeButton})}},{key:"removeFormatButton",get:function(){return I(I({},ie(K(n.prototype),"removeFormatButton",this)),{},{label:this.t.removeFormatButton})}},{key:"advancedInlineButtonGroup",get:function(){return{type:"button-group",subtype:"advanced-inline-button-group",buttons:[this.underlineButton,this.strikethroughButton,this.codeButton]}}},{key:"linkButton",get:function(){return I(I({},ie(K(n.prototype),"linkButton",this)),{},{label:this.t.linkButton,allowTarget:!!xe.activeHaxBody&&!!xe.activeHaxBody.allowLinkTarget})}},{key:"unlinkButton",get:function(){return I(I({},ie(K(n.prototype),"unlinkButton",this)),{},{label:this.t.unlinkButton})}},{key:"cutButton",get:function(){return I(I({},ie(K(n.prototype),"cutButton",this)),{},{label:this.t.cutButton})}},{key:"copyButton",get:function(){return I(I({},ie(K(n.prototype),"copyButton",this)),{},{label:this.t.copyButton})}},{key:"pasteButton",get:function(){return I(I({},ie(K(n.prototype),"pasteButton",this)),{},{label:this.t.pasteButton,shortcutKeys:void 0,type:"hax-text-editor-paste-button"})}},{key:"subscriptButton",get:function(){return I(I({},ie(K(n.prototype),"subscriptButton",this)),{},{label:this.t.subscriptButton})}},{key:"superscriptButton",get:function(){return I(I({},ie(K(n.prototype),"superscriptButton",this)),{},{label:this.t.superscriptButton})}},{key:"symbolButton",get:function(){return I(I({},ie(K(n.prototype),"symbolButton",this)),{},{label:this.t.symbolButton})}},{key:"emojiButton",get:function(){return I(I({},ie(K(n.prototype),"emojiButton",this)),{},{label:this.t.emojiButton})}},{key:"imageButton",get:function(){return I(I({},ie(K(n.prototype),"imageButton",this)),{},{label:this.t.imageButton})}},{key:"orderedListButton",get:function(){return I(I({},ie(K(n.prototype),"orderedListButton",this)),{},{label:this.t.orderedListButton})}},{key:"unorderedListButton",get:function(){return I(I({},ie(K(n.prototype),"unorderedListButton",this)),{},{label:this.t.unorderedListButton})}},{key:"blockquoteButton",get:function(){return{}}},{key:"indentButton",get:function(){return I(I({},ie(K(n.prototype),"indentButton",this)),{},{label:this.t.indentButton})}},{key:"outdentButton",get:function(){return I(I({},ie(K(n.prototype),"outdentButton",this)),{},{label:this.t.outdentButton})}},{key:"sourceButton",get:function(){return I({},ie(K(n.prototype),"sourceButton",this))}},{key:"haxSymbolInsertButtonGroup",get:function(){return{type:"button-group",subtype:"hax-symbol-insert-button-group",buttons:[this.symbolButton,this.emojiButton]}}},{key:"iconButton",get:function(){return{}}},{key:"defaultConfig",get:function(){return[this.basicInlineButtonGroup,this.linkButtonGroup,this.listIndentButtonGroup,this.scriptButtonGroup,this.haxSymbolInsertButtonGroup,this.advancedInlineButtonGroup]}},{key:"filteredBlocks",get:function(){return this.getFilteredBlocks(this.formatBlocks)}},{key:"formatButtonElement",get:function(){return this.formatButton.type?this.querySelector(this.formatButton.type):void 0}},{key:"isRangeInScope",get:function(){return this.range&&this.target&&this.rangeNodeOrParentNode(this.range)&&(this.range.commonAncestorContainer===this.target||this.target.contains(this.range.commonAncestorContainer))}},{key:"targetHandlers",value:function(e){var t=ie(K(n.prototype),"targetHandlers",this).call(this,e);return delete t.paste,t}},{key:"updated",value:function(e){var t=this;ie(K(n.prototype),"updated",this)&&ie(K(n.prototype),"updated",this).call(this,e),this.__ready&&e.forEach((function(e,n){"parentSchema"!==n&&"target"!==n||t.updateBlocks(),"activeNode"===n&&t.activeNode!==e&&t.setTarget(t.activeNode),"t"===n&&t.t!==e&&t.updateToolbarElements()}))}},{key:"firstUpdated",value:function(e){ie(K(n.prototype),"firstUpdated",this)&&ie(K(n.prototype),"firstUpdated",this).call(this,e),this.config=this.updateToolbarElements(),this.__prompt.haxUIElement=!0,this.__prompt.classList.add("ignore-activation"),this.addEventListener("keypress",this.trapKeys.bind(this)),this.__prompt.addEventListener("keypress",this.trapKeys.bind(this)),this.__prompt.addEventListener("paste",this._handlePaste.bind(this))}},{key:"_handlePaste",value:function(e){e.stopPropagation()}},{key:"trapKeys",value:function(e){e.stopPropagation()}},{key:"updateBlocks",value:function(){var e=this.filteredBlocks;this.formatButtonElement&&this.formatButtonElement.blocks!==e&&(this.formatButtonElement.blocks=e,e.length<2?this.formatButtonElement.setAttribute("disabled","disabled"):this.formatButtonElement.removeAttribute("disabled"))}},{key:"getRange",value:function(){var e=xe.getRange();return!e||e.rangeCount<1?void 0:xe.getRange()}},{key:"getSelection",value:function(){return xe.getSelection()}},{key:"positionByTarget",value:function(e){}},{key:"_handleElementRegister",value:function(e){var t=e.detail||{},n=t.tag||{},o=t.properties||{};this._setInlineElement(n,o)}},{key:"_handleHaxStoreReady",value:function(e){var t=this;this.__ready=!0;var n=xe.elementList||{};Object.keys(n).forEach((function(e){return t._setInlineElement(e,elemets[e])}))}},{key:"_setInlineElement",value:function(e,t){var n=this;if(e&&t&&!window.HaxTextEditorToolbarConfig.inlineGizmos[e]&&!(e.indexOf("-")<0)){var o=I({},t),a=t.gizmo||{},i=e.replace(/-./g,(function(e){return e.toUpperCase()[1]})),r=e.split("-").length>1,s=(a.meta||{}).inlineOnly,l=(a.handles||[]).filter((function(e){return"inline"===e.type})).length>1,c=r&&(s||l);o.gizmo.title||(o.gizmo.title=i),c&&(window.HaxTextEditorToolbarConfig.inlineGizmos[e]={element:o,type:"hax-text-editor-button"},this.__updated=!1,setTimeout((function(e){return n.config=n.updateToolbarElements()}),500))}}},{key:"updateToolbarElements",value:function(){if(!this.__updated){this.__updated=!0;var e=Object.keys(window.HaxTextEditorToolbarConfig.inlineGizmos||{}).map((function(e){return window.HaxTextEditorToolbarConfig.inlineGizmos[e]}));return 0===e.length?se(this.defaultConfig||[]):[].concat(se(this.defaultConfig||[]),[{type:"button-group",subtype:"hax-insert-button-group",buttons:e}])}}}],[{key:"styles",get:function(){return[].concat(se(ie(K(n),"baseStyles",this)),se(ie(K(n),"stickyStyles",this)),[o.css(Ee||(Ee=re(["\n        :host {\n          --rich-text-editor-button-color: var(--hax-ui-color);\n          --rich-text-editor-button-bg: var(--hax-ui-background-color);\n          --rich-text-editor-button-border-color: transparent;\n          --rich-text-editor-button-hover-color: var(--hax-ui-color);\n          --rich-text-editor-button-hover-bg: var(\n            --hax-ui-background-color-secondary\n          );\n          --rich-text-editor-button-toggled-color: var(--hax-ui-color-accent);\n          --rich-text-editor-button-toggled-bg: var(--hax-ui-background-color);\n          --rich-text-editor-button-toggled-border-color: var(\n            --hax-ui-color-accent\n          );\n          --rich-text-editor-button-disabled-opacity: 1;\n          --rich-text-editor-button-disabled-color: var(\n            --hax-ui-disabled-color\n          );\n          --rich-text-editor-button-disabled-bg: var(--hax-ui-background-color);\n          --rich-text-editor-button-disabled-border-color: transparent;\n        }\n        #morebutton {\n          align-self: flex-end;\n        }\n        ::slotted([icon-position]:hover) {\n          --rich-text-editor-button-toggled-bg: var(\n            --hax-ui-background-color-accent\n          );\n        }\n        ::slotted(.group) {\n          flex: 0 0 auto;\n          justify-content: center;\n          border-width: 1px;\n          margin: -1px;\n          padding: 0px;\n          --simple-toolbar-button-width: 26px;\n          --simple-toolbar-button-height: 26px;\n        }\n        ::slotted(.list-indent-button-group) {\n          line-height: 20px;\n        }\n        ::slotted(.group),\n        ::slotted([icon-position]) {\n          z-index: 1;\n        }\n        ::slotted([icon-position]),\n        :host([collapsed]) ::slotted(.group) {\n          flex: 0 0 auto;\n        }\n        :host ::slotted(*:focus),\n        :host ::slotted(*:focus-within) {\n          z-index: 2 !important;\n        }\n        :host ::slotted(*:hover) {\n          z-index: 3 !important;\n        }\n        div {\n          --simple-toolbar-button-width: 26px;\n          --simple-toolbar-button-height: 26px;\n          line-height: 30px;\n          height: 30px;\n        }\n        rich-text-editor-button {\n          height: 30px;\n          --simple-toolbar-button-width: 26px;\n          --simple-toolbar-button-height: 26px;\n          line-height: 30px;\n        }\n      "])))])}},{key:"properties",get:function(){return{__updated:{type:Boolean}}}},{key:"tag",get:function(){return"hax-text-editor-toolbar"}}]),n}(f.RichTextEditorToolbarBehaviors(u.I18NMixin(_e(o.LitElement))));customElements.define("hax-text-editor-toolbar",je);var Ie=[o.css(Te||(Te=re(["\n    body {\n      --hax-ui-font-family: sans-serif;\n      --hax-ui-font-size: 14px;\n      --hax-ui-font-size-sm: 12px;\n      --hax-ui-font-size-xs: 11px;\n      --hax-ui-font-size-lg: calc(1.05 * var(--hax-ui-font-size, 14px));\n      --hax-ui-font-size-xl: calc(1.25 * var(--hax-ui-font-size, 14px));\n    }\n  "])))],qe=[o.css(Ae||(Ae=re(["\n    body {\n      --hax-tray-width: 350px;\n      --hax-tray-menubar-min-width: 44px;\n      --hax-tray-menubar-min-height: 34px;\n      --hax-ui-spacing-xs: 4px;\n      --hax-ui-border-radius: 2px;\n      --hax-ui-spacing-sm: calc(1 * var(--hax-ui-spacing-xs, 4px));\n      --hax-ui-spacing: calc(2 * var(--hax-ui-spacing-xs, 4px));\n      --hax-ui-spacing-lg: calc(3 * var(--hax-ui-spacing-xs, 4px));\n      --hax-ui-spacing-xl: calc(4 * var(--hax-ui-spacing-xs, 4px));\n      --hax-ui-focus-z-index: 1001;\n      --simple-toolbar-focus-z-index: var(--hax-ui-focus-z-index);\n      --a11y-menu-button-focus-z-index: var(--hax-ui-focus-z-index);\n    }\n  "])))],Ge=[o.css(Le||(Le=re(['\n    body {\n      --hax-ui-color: #222;\n      --hax-ui-color-focus: #000;\n      --hax-ui-color-faded: #444;\n      --hax-ui-disabled-color: #bbb;\n\n      --hax-ui-background-color: #fff;\n      --hax-ui-background-color-secondary: #e8e8e8;\n      --hax-ui-background-color-faded: #b0b8bb;\n\n      --hax-ui-color-accent: #009dc7;\n      --hax-ui-color-accent-secondary: #007999;\n      --hax-ui-background-color-accent: #ccf3fd;\n\n      --hax-ui-color-danger: #ee0000;\n      --hax-ui-color-danger-secondary: #850000;\n      --hax-ui-background-color-danger: #ffdddd;\n\n      --hax-ui-border-color: #ddd;\n    }\n    body[hax-ui-theme="haxdark"] {\n      --hax-ui-color: #eeeae6;\n      --hax-ui-color-focus: #fff;\n      --hax-ui-color-faded: #c5c3be;\n      --hax-ui-disabled-color: #555;\n\n      --hax-ui-background-color: #333;\n      --hax-ui-background-color-secondary: #111;\n      --hax-ui-background-color-faded: #222;\n\n      --hax-ui-color-accent: #77e2ff;\n      --hax-ui-color-accent-secondary: #00c9ff;\n      --hax-ui-background-color-accent: #000;\n\n      --hax-ui-color-danger: #ff8f8f;\n      --hax-ui-color-danger-secondary: #ff2222;\n      --hax-ui-background-color-danger: #000;\n\n      --hax-ui-border-color: #000;\n    }\n\n    @media (prefers-color-scheme: dark) {\n      body[hax-ui-theme="system"] {\n        --hax-ui-color: #eeeae6;\n        --hax-ui-color-focus: #fff;\n        --hax-ui-color-faded: #c5c3be;\n\n        --hax-ui-background-color: #333;\n        --hax-ui-background-color-secondary: #111;\n        --hax-ui-background-color-faded: #222;\n\n        --hax-ui-color-accent: #77e2ff;\n        --hax-ui-color-accent-secondary: #00c9ff;\n        --hax-ui-background-color-accent: #000;\n\n        --hax-ui-color-danger: #ff8f8f;\n        --hax-ui-color-danger-secondary: #ff2222;\n        --hax-ui-background-color-danger: #000;\n\n        --hax-ui-border-color: #000;\n      }\n    }\n  '])))],Ue=[o.css(Ce||(Ce=re(["\n    body {\n      --simple-tooltip-background: var(--hax-ui-color);\n      --simple-tooltip-text-color: var(--hax-ui-background-color);\n      --simple-tooltip-opacity: 1;\n      --simple-tooltip-delay-in: 0;\n      --simple-tooltip-duration-in: 100ms;\n      --simple-tooltip-duration-out: 0;\n      --simple-tooltip-border-radius: 2px;\n      --simple-tooltip-font-size: var(--hax-ui-font-size-sm);\n    }\n  "])))],Fe=[o.css(He||(He=re(["\n    body {\n      --simple-fields-field-margin: calc(2 * var(--hax-ui-font-size));\n      --simple-toolbar-focus-z-index: var(--hax-ui-focus-z-index);\n      --simple-fields-font-family: var(--hax-ui-font-family);\n      --simple-fields-font-size: var(--hax-ui-font-size);\n      --simple-fields-line-height: 135%;\n      --simple-fields-detail-font-size: var(--hax-ui-font-size-xs);\n      --simple-fields-detail-line-height: 120%;\n      --simple-fields-margin: var(--hax-ui-spacing);\n      --simple-fields-background-color: var(--hax-ui-background-color);\n      --simple-fields-color: var(--hax-tray-text-color);\n      --simple-fields-accent-color: var(--hax-ui-color-accent);\n      --simple-fields-accent-color-light: var(--hax-ui-background-color-faded);\n      --simple-fields-error-color: var(--hax-ui-color-danger-secondary);\n      --simple-fields-button-danger-background-color: var(\n        --hax-ui-color-danger\n      );\n      --simple-fields-button-danger-focus-color: var(\n        --hax-ui-color-danger-secondary\n      );\n      --simple-fields-button-danger-background-color: var(\n        --hax-ui-background-color\n      );\n      --simple-fields-secondary-accent-color: var(\n        --hax-ui-color-accent-secondary\n      );\n      --simple-fields-border-color: var(--hax-ui-color-faded);\n\n      --simple-fields-fieldset-border-color: rgba(127, 127, 127, 0.2);\n      --simple-fields-legend-text-transform: capitalize;\n      --simple-fields-legend-font-size: var(--hax-ui-font-size-xs);\n\n      --simple-fields-meta-font-size: var(--hax-ui-font-size-xs);\n      --simple-fields-meta-line-height: 120%;\n      --simple-fields-meta-opacity: 0.7;\n      --simple-fields-focus-meta-opacity: 1;\n\n      --simple-fields-button-color: var(--hax-ui-color);\n      --simple-fields-button-background-color: var(--hax-ui-background-color);\n      --simple-fields-button-border-color: var(--hax-ui-border-color);\n      --simple-fields-button-text-transform: capitalize;\n      --simple-fields-border-radius: var(--hax-ui-border-radius);\n      --simple-fields-button-padding-sm: var(--hax-ui-spacing-sm);\n      --simple-fields-button-padding: var(--hax-ui-spacing-sm);\n\n      --simple-fields-button-toggled-color: var(--hax-ui-color);\n      --simple-fields-button-toggled-background-color: var(\n        --hax-ui-background-color-accent\n      );\n      --simple-fields-button-toggled-border-color: var(--hax-ui-color-accent);\n\n      --simple-fields-button-focus-color: var(--hax-ui-color);\n      --simple-fields-button-focus-background-color: var(\n        --hax-ui-background-color-accent\n      );\n      --simple-fields-button-focus-border-color: var(--hax-ui-color-accent);\n\n      --simple-fields-button-disabled-color: unset;\n      --simple-fields-button-disabled-background-color: unset;\n      --simple-fields-button-disabled-border-color: unset;\n      --simple-fields-button-disabled-opacity: 0.5;\n      --hexagon-color: var(--hax-ui-color-accent);\n    }\n  "])))],Ve=[o.css(Be||(Be=re(['\n    simple-modal[mode="hax-ui"],\n    simple-popover-manager[mode="hax"] {\n      font-family: var(--hax-ui-font-family);\n      font-size: var(--hax-ui-font-size);\n      --simple-modal-height: 70vh;\n      --simple-modal-width: 70vw;\n      --simple-popover-border-color: var(--hax-ui-color);\n      --simple-modal-border-color: var(--hax-ui-color);\n    }\n    rich-text-editor-prompt {\n      z-index: calc(var(--hax-ui-focus-z-index) - 1);\n    }\n    simple-modal[mode="hax-ui"]::part(dialog) {\n      --simple-modal-z-index: 100000001 !important;\n    }\n    simple-modal[opened] {\n      z-index: 100000001 !important;\n    }\n    simple-modal[mode="hax-ui"]::part(titlebar),\n    simple-popover-manager[mode="hax"]::part(simple-popover-heading),\n    simple-popover-manager[mode="hax"] h1[slot="heading"] {\n      color: var(--hax-ui-background-color);\n      background-color: var(--hax-ui-color-accent);\n      padding: var(--hax-ui-spacing-sm) var(--hax-ui-spacing);\n      margin: 0;\n    }\n    simple-modal[mode="hax-ui"]::part(close),\n    simple-popover-manager[mode="hax"] #close {\n      color: var(--hax-ui-background-color);\n      background-color: var(--hax-ui-color-accent);\n      outline: 1px solid var(--hax-ui-color-accent);\n      --simple-icon-button-border: 0px solid transparent;\n      --simple-icon-button-border-radius: var(--hax-ui-border-radius);\n      width: 24px;\n      height: 24px;\n      padding: 0;\n    }\n    simple-modal[mode="hax-ui"]:focus-within::part(close),\n    simple-modal[mode="hax-ui"]:hover::part(close),\n    simple-popover-manager[mode="hax"] #close:focus,\n    simple-popover-manager[mode="hax"] #close:hover {\n      background-color: var(--hax-ui-color-accent-secondary);\n      --simple-icon-button-border: 0px solid transparent;\n    }\n    simple-modal[mode="hax-ui"]::part(title),\n    simple-popover-manager[mode="hax"] h1 {\n      font-family: var(--hax-ui-font-family);\n      font-size: var(--hax-ui-font-size);\n      font-weight: normal;\n      margin: 0 var(--hax-ui-spacing-sm) 0 0;\n      padding: 0;\n    }\n    simple-popover-manager[mode="hax"] h2 {\n      font-family: var(--hax-ui-font-family);\n      font-size: var(--hax-ui-font-size-lg);\n      font-weight: normal;\n      color: var(--hax-ui-color-accent-secondary);\n      margin: 0 0 var(--hax-ui-spacing-lg);\n    }\n    simple-modal[mode="hax-ui"]::part(content),\n    simple-modal[mode="hax-ui"]::part(custom),\n    simple-popover-manager[mode="hax"]::part(simple-popover-body) {\n      font-size: var(--hax-ui-font-size);\n      color: var(--hax-ui-color);\n      background-color: var(--hax-ui-background-color);\n    }\n    simple-modal[mode="hax-ui"]::part(content) {\n      padding: 0 var(--hax-ui-spacing);\n    }\n    simple-modal[mode="hax-ui"]::part(custom) {\n      padding: 0;\n    }\n    simple-popover-manager[mode="hax"]::part(simple-popover-body) {\n      padding: var(--hax-ui-spacing);\n    }\n    simple-modal[mode="hax-ui"]::part(buttons),\n    simple-popover-manager[mode="hax"]:part(simple-popover-nav) {\n      background-color: var(--hax-ui-background-color);\n    }\n    #hax-cancel-no,\n    #hax-cancel-yes {\n      flex: 1 1 auto;\n    }\n    simple-popover-manager[mode="hax"]\n      simple-icon-button-lite[slot="nav"]::part(button) {\n      text-transform: capitalize;\n      font-size: var(--hax-ui-font-size-sm);\n      padding: var(--hax-ui-spacing-sm);\n      color: var(--hax-ui-color);\n      background-color: var(--hax-ui-background-color);\n      border: 1px solid var(--hax-ui-border-color);\n      border-radius: var(--hax-ui-border-radius);\n      background-color: var(--hax-ui-background-color);\n    }\n    simple-popover-manager[mode="hax"]\n      simple-icon-button-lite[slot="nav"]::part(button):hover,\n    simple-popover-manager[mode="hax"]\n      simple-icon-button-lite[slot="nav"]::part(button):focus-within {\n      color: var(--hax-ui-color);\n      background-color: var(--hax-ui-background-color-accent);\n      border-color: var(--hax-ui-color-accent);\n    }\n    simple-popover-manager[mode="hax"]\n      simple-icon-button-lite[slot="nav"][disabled]::part(button) {\n      opacity: 0.5;\n      border: 1px solid var(--hax-ui-border-color);\n    }\n  '])))],We=[].concat(Ie,qe,Fe,Ue,Ve,Ge),Xe=[o.css(Me||(Me=re(["\n    hexagon-loader {\n      display: none;\n      margin: 0 auto;\n      z-index: 1000;\n    }\n    hexagon-loader[loading] {\n      display: block;\n      opacity: 0.8;\n    }\n  "])))],Ye=[o.css(Pe||(Pe=re(['\n    :host[aria-expanded="true"] {\n      border: 1px solid var(--hax-ui-border-color);\n    }\n    absolute-position-behavior {\n      border-color: transparent;\n      color: var(--hax-ui-color);\n      background-color: var(--hax-ui-background-color);\n    }\n    :host([expanded]) absolute-position-behavior {\n      border: 1px solid var(--hax-ui-border-color);\n    }\n    button[part="button"] {\n      text-transform: capitalize;\n      font-size: var(--hax-ui-font-size-sm);\n      padding: var(--hax-ui-spacing-sm);\n      color: var(--hax-ui-color);\n      background-color: var(--hax-ui-background-color);\n      border: 1px solid var(--hax-ui-border-color);\n      border-radius: var(--hax-ui-border-radius);\n    }\n    :host([role="menuitem"]) button[part="button"] {\n      padding: 1px;\n      border-color: transparent;\n    }\n    :host(:hover) button[part="button"] {\n      background-color: var(--hax-ui-background-color-secondary);\n      color: var(--hax-ui-color);\n    }\n    :host([toggled]) button[part="button"],\n    button[part="button"][aria-pressed="true"] {\n      color: var(--hax-ui-color-accent);\n      border-color: var(--hax-ui-color-accent);\n    }\n    button[part="button"][aria-pressed="true"]:hover,\n    :host([toggled]:hover) button[part="button"] {\n      background-color: var(--hax-ui-background-color-accent);\n    }\n    :host([feature]) button[part="button"],\n    :host([danger]) button[part="button"] {\n      color: var(--hax-ui-background-color);\n    }\n    :host([feature]) button[part="button"] {\n      background-color: var(--hax-ui-color-accent);\n      border-color: var(--hax-ui-color-accent);\n    }\n    :host([danger]) button[part="button"] {\n      background-color: var(--hax-ui-color-danger);\n      border-color: var(--hax-ui-color-danger);\n    }\n    :host([feature]) button[part="button"][aria-pressed="true"],\n    :host([danger]) button[part="button"][aria-pressed="true"] {\n      color: var(--hax-ui-background-color);\n    }\n    :host([feature]) button[part="button"][aria-pressed="true"] {\n      background-color: var(--hax-ui-color-accent-secondary);\n      border-color: var(--hax-ui-color-accent);\n    }\n    :host([danger]) button[part="button"][aria-pressed="true"] {\n      background-color: var(--hax-ui-color-danger-secondary);\n      border-color: var(--hax-ui-color-danger);\n    }\n    :host([feature]:hover) button[part="button"],\n    :host([feature]:focus-within) button[part="button"],\n    :host([danger]:hover) button[part="button"],\n    :host([danger]:focus-within) button[part="button"] {\n      color: var(--hax-ui-background-color);\n    }\n    :host([feature]:hover) button[part="button"],\n    :host([feature]:focus-within) button[part="button"] {\n      background-color: var(--hax-ui-color-accent-secondary);\n      border-color: var(--hax-ui-color-accent-secondary);\n    }\n    :host([danger]:hover) button[part="button"],\n    :host([danger]:focus-within) button[part="button"] {\n      background-color: var(--hax-ui-color-danger-secondary);\n      border-color: var(--hax-ui-color-danger-secondary);\n    }\n    :host([large]) button[part="button"] {\n      font-size: var(--hax-ui-font-size);\n      padding: var(--hax-ui-spacing);\n      border-width: 2px;\n    }\n    :host([disabled]) button[part="button"][disabled] {\n      opacity: 1;\n      color: var(--hax-ui-disabled-color);\n      border: 1px solid var(--hax-ui-border-color);\n    }\n\n    *[show-text-label]::part(label) {\n      text-transform: capitalize;\n      margin: var(--hax-ui-spacing-sm);\n    }\n  '])))],Je=[o.css(Oe||(Oe=re(["\n    simple-fields-tabs {\n      padding: 0;\n      border: none;\n      margin-left: calc(0 - var(--hax-ui-spacing-sm));\n      margin-right: calc(0 - var(--hax-ui-spacing-sm));\n    }\n    simple-fields-tabs::part(tablist) {\n      margin-bottom: var(--hax-ui-spacing);\n    }\n    simple-fields-tabs::part(tab),\n    simple-fields-tabs::part(tab-active),\n    simple-fields-tabs::part(tab-disabled),\n    hax-preferences-dialog::part(haxlink) {\n      border: 1px solid var(--hax-ui-border-color);\n      text-decoration: none;\n      border-radius: 3px;\n      color: var(--hax-ui-color);\n      background-color: var(--hax-ui-background-color);\n      outline: unset;\n      text-transform: capitalize;\n      font-size: var(--hax-ui-font-size-sm);\n      padding: var(--hax-ui-spacing-xs);\n      flex: 1 1 auto;\n    }\n    simple-fields-tabs::part(tab-active) {\n      color: var(--hax-ui-color-accent);\n    }\n    hax-preferences-dialog::part(haxlink) {\n      display: block;\n      padding: var(--hax-ui-spacing-lg);\n    }\n    hax-preferences-dialog::part(haxlink):hover,\n    hax-preferences-dialog::part(haxlink):focus {\n      color: var(--hax-ui-color);\n      background-color: var(--hax-ui-background-color-accent);\n      border-color: var(--hax-ui-color-accent);\n    }\n    simple-fields-tabs::part(tab-disabled) {\n      opacity: 0.5;\n      background-color: rgba(127, 127, 127, 0.2);\n    }\n    simple-fields-tabs::part(content) {\n      border: none;\n    }\n    simple-fields-tab {\n      padding: 0;\n    }\n    simple-fields *::part(label) {\n      text-transform: captitalize;\n      margin: 0;\n    }\n  "])))],Ke=[].concat(Ye,Xe,Je);o.css(ze||(ze=re(["\n    #tray-detail {\n      font-family: var(--hax-ui-font-family);\n      --hax-tray-detail-title-font-size: var(--hax-ui-font-size);\n      --hax-tray-detail-topic-font-size: var(--hax-ui-font-size-lg);\n      --hax-tray-detail-subtopic-font-size: var(--hax-ui-font-size);\n      --hax-tray-detail-heading-text-transform: capitalize;\n      --hax-tray-detail-heading-font-weight: normal;\n    }\n    #toggle-tray-size {\n      color: var(--hax-ui-background-color);\n      background-color: var(--hax-ui-color-accent);\n      outline: 1px solid var(--hax-ui-color-accent);\n      --simple-icon-button-border: 0px solid transparent;\n      --simple-icon-button-border-radius: var(--hax-ui-border-radius);\n      width: 24px;\n      height: 24px;\n      padding: 0;\n    }\n    #toggle-tray-size:hover,\n    #toggle-tray-size:focus-within {\n      color: var(--hax-ui-color);\n      background-color: var(--hax-ui-background-color-accent);\n      border-color: var(--hax-ui-color-accent);\n    }\n    #tray-detail h5,\n    #tray-detail h6 {\n      text-transform: var(--hax-tray-detail-heading-text-transform);\n      font-weight: var(--hax-tray-detail-heading-font-weight);\n      margin: var(--hax-ui-spacing) 0 var(--hax-ui-spacing-xs);\n      color: var(--hax-ui-color-faded);\n    }\n    #tray-detail h4 {\n      text-transform: var(--hax-tray-detail-heading-text-transform);\n      color: var(--hax-ui-background-color);\n      font-size: var(--hax-tray-detail-title-font-size);\n      font-weight: normal;\n      margin: 0 var(--hax-ui-spacing-sm) 0 0;\n      padding: 0;\n      height: 28px;\n      overflow: hidden;\n      word-break: break-all;\n      text-overflow: ellipsis;\n      line-height: 28px;\n    }\n    #tray-detail h5 {\n      font-size: var(--hax-tray-detail-topic-font-size);\n    }\n    #tray-detail h6 {\n      font-size: var(--hax-tray-detail-subtopic-font-size);\n    }\n  "]))),o.css(De||(De=re(["\n    h5 {\n      font-size: var(--hax-tray-detail-topic-font-size);\n    }\n    h6 {\n      font-size: var(--hax-tray-detail-subtopic-font-size);\n    }\n    h5,\n    h6 {\n      color: var(--hax-ui-color-faded);\n      text-transform: var(--hax-tray-detail-heading-text-transform);\n      font-weight: var(--hax-tray-detail-heading-font-weight);\n      margin: var(--hax-ui-spacing-lg) 0 var(--hax-ui-spacing-xs);\n    }\n  "])));var $e,Qe=function(e){J(n,e);var t=oe(n);function n(){return V(this,n),t.apply(this,arguments)}return X(n,[{key:"render",value:function(){return o.html(Re||(Re=re(["<slot></slot>"])))}}],[{key:"styles",get:function(){return Ke}},{key:"tag",get:function(){return"hax-ui-styles"}}]),n}(o.LitElement);customElements.define(Qe.tag,Qe);var Ze,et=function(e){J(n,e);var t=oe(n);function n(){var e;return V(this,n),(e=t.call(this))._blockEvent=!1,e}return X(n,null,[{key:"styles",get:function(){return se(ie(K(n),"styles",this))}},{key:"simpleButtonThemeStyles",get:function(){return L.HaxButton}},{key:"simpleButtonCoreStyles",get:function(){return[].concat(se(ie(K(n),"simpleButtonCoreStyles",this)),[o.css($e||($e=re(['\n        ::slotted([slot="menuitem"]) {\n          --simple-toolbar-button-justify: flex-start;\n          --simple-toolbar-button-label-white-space: nowrap;\n        }\n      '])))])}},{key:"tag",get:function(){return"hax-toolbar-menu"}},{key:"properties",get:function(){return I(I({},ie(K(n),"properties",this)),{},{_blockEvent:{type:Boolean},eventName:{type:String,attribute:"event-name"}})}}]),n}(A.SimpleToolbarMenuBehaviors(o.LitElement));customElements.define(et.tag,et);var tt,nt=function(e){J(n,e);var t=oe(n);function n(){return V(this,n),t.apply(this,arguments)}return X(n)}((tt=o.LitElement,function(e){J(n,e);var t=oe(n);function n(){var e;return V(this,n),(e=t.call(this)).selected=!1,e.inline=!1,e}return X(n,null,[{key:"styles",get:function(){return[].concat(se(ie(K(n),"styles",this)),[o.css(Ze||(Ze=re(["\n          :host {\n            --hax-ui-border-radius: 0px;\n          }\n          .selected-buttons {\n            transition: 0.1s all ease-in-out;\n            width: 0;\n          }\n          :host([has-selected-text]) .selected-buttons {\n            width: 100%;\n          }\n          ::slotted(*) {\n            pointer-events: all;\n          }\n          ::slotted(.group) {\n            border: none;\n          }\n        "])))])}},{key:"tag",get:function(){return"hax-toolbar"}},{key:"properties",get:function(){return I(I({},ie(K(n),"properties",this)),{},{selected:{type:Boolean,reflect:!0},inline:{type:Boolean,reflect:!0}})}}]),n}(M.SimpleToolbarBehaviors(tt))));customElements.define(nt.tag,nt);var ot,at,it,rt,st,lt,ct=function(e){J(n,e);var t=oe(n);function n(){var e;return V(this,n),(e=t.call(this)).haxUIElement=!0,e.action=!1,e.more=!1,e.eventName="button",e.inputMethod=null,e.propertyToBind=null,e.slotToBind=null,e.value="",e}return X(n,[{key:"_handleMousedown",value:function(e){this.disabled||(xe._tmpSelection=xe.getSelection())}},{key:"_handleClick",value:function(e){this.disabled||this.dispatchEvent(new CustomEvent("hax-context-item-selected",{bubbles:!0,cancelable:!0,composed:!0,detail:{target:this,eventName:this.eventName,value:this.value}}))}}],[{key:"tag",get:function(){return"hax-context-item"}},{key:"properties",get:function(){return I(I({},ie(K(n),"properties",this)),{},{more:{type:Boolean},action:{type:Boolean},label:{type:String,reflect:!0},inputMethod:{type:String,reflect:!0,attribute:"input-method"},propertyToBind:{type:String,reflect:!0,attribute:"property-to-bind"},slotToBind:{type:String,reflect:!0,attribute:"slot-to-bind"},description:{type:String,reflect:!0},default:{type:Boolean},value:{type:String}})}}]),n}(C.HaxToolbarItemBehaviors(o.LitElement));customElements.define(ct.tag,ct);var dt,ut,ht,pt=function(e){J(a,e);var t,n=oe(a);function a(){var e;return V(this,a),(e=n.call(this)).disableOps=!1,e.disableItemOps=!1,e.insertAbove=!0,e.disableDuplicate=!1,e.hasActiveEditingElement=!1,e.haxUIElement=!0,e.tourName="hax",e.trayDetail="content-edit",e.trayStatus="collapsed",e.t={edit:"Edit",editDetails:"Edit details",dragHandle:"Drag handle",moveUp:"Move up",moveDown:"Move down",addColumn:"Add column",removeColumn:"Remove column",remove:"Remove",duplicate:"Duplicate",confirmDelete:"Confirm delete",changeTo:"Change to",editElement:"Edit Mode",modifyHTMLSource:"Modify HTML source",clickToChange:"Click to change",regions:"Available regions",insertItemAbove:"Insert item above",insertItemAboveOrBelow:"Insert item above or below",insertItemBelow:"Insert item below",selectLayout:"Select Layout Element"},e.registerLocalization({context:te(e),namespace:"hax"}),e.ceButtons=[],e.activeTagName="",e.activeTagIcon="hax:paragraph",e.addEventListener("hax-context-item-selected",e.handleCECustomEvent.bind(te(e))),e}return X(a,[{key:"render",value:function(){var e=this;return o.html(ot||(ot=re(['\n      <hax-toolbar always-expanded>\n        <div class="group">\n          <hax-toolbar-menu\n            ?disabled="','"\n            id="drag"\n            action\n            icon="hax:arrow-all"\n            label="','"\n            draggable="true"\n            reset-on-select\n            data-simple-tour-stop\n            data-stop-title="label"\n            ?hidden="','"\n          >\n            <simple-toolbar-menu-item slot="menuitem">\n              <hax-context-item\n                action\n                align-horizontal="left"\n                ?disabled="','"\n                show-text-label\n                role="menuitem"\n                icon="hax:keyboard-arrow-up"\n                label="','"\n                event-name="hax-plate-up"\n              ></hax-context-item>\n            </simple-toolbar-menu-item>\n            <simple-toolbar-menu-item slot="menuitem">\n              <hax-context-item\n                action\n                align-horizontal="left"\n                ?disabled="','"\n                role="menuitem"\n                show-text-label\n                icon="hax:keyboard-arrow-down"\n                label="','"\n                event-name="hax-plate-down"\n              ></hax-context-item>\n            </simple-toolbar-menu-item>\n            ','\n            <div slot="tour" data-stop-content>\n              Click the drag handle once to show a menu to just move up or down\n              one item in the content OR click and drag to place the item\n              exactly where you want it to go.\n            </div>\n          </hax-toolbar-menu>\n          <hax-toolbar-menu\n            action\n            align-horizontal="left"\n            ?disabled="','"\n            icon="hax:select-element"\n            label="','"\n          >\n            <simple-toolbar-menu-item slot="menuitem">\n              <hax-context-item\n                action\n                align-horizontal="left"\n                ?hidden="','"\n                .icon="','"\n                label="','"\n                event-name="hax-select-grid"\n                .eventData="','"\n                role="menuitem"\n                show-text-label\n              >\n              </hax-context-item>\n              <hax-context-item\n                action\n                align-horizontal="left"\n                ?disabled="','"\n                ?hidden="','"\n                .icon="','"\n                label="','"\n                event-name="hax-select-grid"\n                .eventData="','"\n                role="menuitem"\n                show-text-label\n              >\n              </hax-context-item>\n            </simple-toolbar-menu-item>\n            ','\n            \n          </hax-toolbar-menu>\n          <slot name="primary"></slot>\n          <hax-toolbar-menu\n            icon="add-box"\n            label="','"\n            ?disabled="','"\n          >\n            <simple-toolbar-menu-item slot="menuitem">\n              <hax-context-item\n                action\n                align-horizontal="left"\n                show-text-label\n                role="menuitem"\n                ?disabled="','"\n                icon="hardware:keyboard-arrow-up"\n                event-name="insert-above-active"\n                label="','"\n              ></hax-context-item>\n            </simple-toolbar-menu-item>\n            <simple-toolbar-menu-item slot="menuitem">\n              <hax-context-item\n                action\n                align-horizontal="left"\n                show-text-label\n                role="menuitem"\n                icon="hardware:keyboard-arrow-down"\n                event-name="insert-below-active"\n                label="','"\n                ?disabled="','"\n              ></hax-context-item>\n            </simple-toolbar-menu-item>\n            ','\n          </hax-toolbar-menu>\n          <hax-context-item\n            action\n            ?disabled="','"\n            label="','"\n            icon="icons:content-copy"\n            event-name="hax-plate-duplicate"\n            data-simple-tour-stop\n            data-stop-title="label"\n          >\n            <div slot="tour" data-stop-content>\n              Duplicate the active piece of content and place it below the\n              current item.\n            </div>\n          </hax-context-item>\n        </div>\n        <hax-context-item\n          action\n          icon="delete"\n          ?disabled="','"\n          icon="delete"\n          label="','"\n          event-name="hax-plate-delete"\n          data-simple-tour-stop\n          data-stop-title="label"\n      >\n          <div slot="tour" data-stop-content>\n            Delete the current item. You can always use the undo arrow to\n            bring this back.\n          </div>\n        </hax-context-item>\n          <hax-context-item\n            action\n            id="right"\n            class="paddle"\n            icon="hax:table-column-remove"\n            label="','"\n            ?disabled="','"\n            event-name="hax-plate-create-right"\n            data-simple-tour-stop\n            data-stop-title="label"\n          >\n            <div slot="tour" data-stop-content>\n              Add a column to split the current column into two pieces. This can\n              be done up to six pieces columns. For differnet layouts see Grid\n              settings panel.\n            </div>\n          </hax-context-item>\n          <hax-context-item\n            action\n            class="paddle"\n            icon="hax:table-column-plus-after"\n            label="','"\n            ?disabled="','"\n            event-name="hax-plate-remove-right"\n            ?hidden="','"\n            id="rightremove"\n            data-simple-tour-stop\n            data-stop-title="label"\n          >\n            <div slot="tour" data-stop-content>\n              Remove a column from the split column layout. If at two columns\n              and removing it will remove the layout split and make it 100%\n              width.\n            </div>\n          </hax-context-item>\n          ','\n          <slot name="secondary"></slot>\n        </div>\n        <div class="group">\n          <hax-context-item\n            action\n            more\n            label="','..."\n            tooltip="',", ",'"\n            ?disabled="','"\n            event-name="hax-transform-node"\n          ></hax-context-item>\n            <hax-context-item\n              action\n              label="','"\n              ?disabled="','"\n              ?hidden="','"\n              event-name="hax-edit-element-toggle"\n              .eventData="','"\n              toggles\n              ?toggled="','"\n            ></hax-context-item>\n          <hax-context-item\n            action\n            icon="icons:code"\n            label="','"\n            ?disabled="','"\n            event-name="hax-source-view-toggle"\n            toggles\n            ?toggled="','"\n          ></hax-context-item>\n          <slot name="more"></slot>\n          <hax-context-item\n            icon="build"\n            action\n            align-horizontal="left"\n            ?disabled="','"\n            label="','"\n            data-simple-tour-stop\n            data-stop-title="label"\n            event-name="content-edit"\n          >\n            <div slot="tour" data-stop-content>\n              Opens the Edit panel for more advanced settings.\n            </div>\n          </hax-context-item>\n        </div>\n      </hax-toolbar>\n    '])),this.hasActiveEditingElement||!this.canMoveElement||this.viewSource,this.t.dragHandle,!this.canMoveElement,this.hasActiveEditingElement,this.t.moveUp,this.hasActiveEditingElement,this.t.moveDown,this.activeNode&&this.activeNode.parentNode&&xe.isLayoutElement(this.activeNode.parentNode)?(this.slottedItems||[]).map((function(t,n){return o.html(at||(at=re(['\n                        <simple-toolbar-menu-item\n                          slot="menuitem"\n                          class="move-to-slot ','"\n                        >\n                          <hax-context-item\n                            action\n                            align-horizontal="left"\n                            ?disabled="','"\n                            label="','"\n                            event-name="move-to-slot"\n                            data-slot="','"\n                            role="menuitem"\n                            show-text-label\n                          >\n                          </hax-context-item>\n                        </simple-toolbar-menu-item>\n                      '])),n<1?"first-slot":"",e.viewSource,t.label,t.slot)})):"",this.viewSource||this.disableOps||(!this.layoutParent||this.activeNode!==this.layoutElement)&&!this.layoutElement,this.t.selectLayout,!this.layoutParent||this.activeNode!==this.layoutElement,this.elementIcon(this.layoutParent),this.elementLabel(this.layoutParent),this.layoutParent,this.activeNode===this.layoutElement,!this.layoutElement,this.elementIcon(this.layoutElement),this.elementLabel(this.layoutElement),this.layoutElement,(this.slottedItems||[]).map((function(t,n){return(t.items||[]).map((function(a,i){return o.html(it||(it=re(['\n                    <simple-toolbar-menu-item\n                      slot="menuitem"\n                      class="hax-select-grid-item ','"\n                    >\n                      <hax-context-item\n                        action\n                        align-horizontal="left"\n                        ?disabled="','"\n                        label="',"",'"\n                        event-name="hax-select-grid-item"\n                        .eventData="','"\n                        role="menuitem"\n                        show-text-label\n                      >\n                      </hax-context-item>\n                    </simple-toolbar-menu-item>\n                  '])),n<1&&i<1?"first-slot":"",e.viewSource||e.activeNode===a,t.title||t.id,t.items.length>1?" (".concat(i+1,")"):"",{target:a,grid:t.grid,slot:t.slot,index:i,editMode:t.editMode})}))})),this.t.insertItemAboveOrBelow,this.viewSource,!this.insertAbove,this.t.insertItemAbove,this.t.insertItemBelow,this.viewSource,xe.isLayoutElement(this.activeNode)?(this.slottedItems||[]).map((function(t,n){return o.html(rt||(rt=re(['\n                        <simple-toolbar-menu-item\n                          slot="menuitem"\n                          class="insert-into-active ','"\n                        >\n                          <hax-context-item\n                            action\n                            align-horizontal="left"\n                            ?disabled="','"\n                            label="','"\n                            event-name="insert-into-active"\n                            data-slot="','"\n                            role="menuitem"\n                            show-text-label\n                          >\n                          </hax-context-item>\n                        </simple-toolbar-menu-item>\n                      '])),n<1?"first-slot":"",e.viewSource,t.label,t.slot)})):"",this.hasActiveEditingElement||this.viewSource||this.disableOps||this.disableDuplicate,this.t.duplicate,this.hasActiveEditingElement||this.viewSource||this.disableOps,this.t.remove,this.t.addColumn,this.hasActiveEditingElement||this.viewSource||this.disableOps,this.t.removeColumn,this.hasActiveEditingElement||this.viewSource||this.disableOps,!this.activeNode,this.ceButtons.map((function(t){return o.html(st||(st=re([' <hax-context-item\n              action\n              icon="','"\n              label="','"\n              event-name="hax-ce-custom-button"\n              value="','"\n              ?disabled="','"\n            ></hax-context-item>'])),t.icon,t.label,t.callback,t.disabled||e.disableItemOps)})),this.t.changeTo,this.activeTagName,this.t.clickToChange,this.disableTransform||this.viewSource||this.disableOps,this.t.editElement,this.viewSource||this.disableOps,!this.editElementProperty,{target:this.activeNode,editMode:this.editElementProperty},this.editElementToggled,this.t.modifyHTMLSource,!this.sourceView||this.disableOps||this.editElementToggled,this.viewSource,this.hasActiveEditingElement||this.viewSource||this.disableOps,this.t.editDetails)}},{key:"disableTransform",get:function(){return xe.isTextElement(this.activeNode)}},{key:"filteredBlocks",get:function(){return this.getFilteredBlocks(this.formatBlocks)}},{key:"__updatePlatePosition",value:function(e){var t=this.shadowRoot.querySelector("#right"),n=this.shadowRoot.querySelector("#rightremove");t.disabled=!1,n.disabled=!1,e&&"GRID-PLATE"==e.tagName?"1-1-1-1-1-1"==e.layout&&(t.disabled=!0):n.disabled=!0}},{key:"__dblClickFire",value:function(e){"remove"===e.target.id&&this.dispatchEvent(new CustomEvent("hax-context-item-selected",{bubbles:!0,cancelable:!0,composed:!0,detail:{target:e.target,eventName:"hax-plate-delete",value:e.target.value}}))}},{key:"_handleOpen",value:function(e){this.dispatchEvent(new CustomEvent("hax-transform-node",{bubbles:!0,cancelable:!0,composed:!0,detail:xe.elementList[el]}))}},{key:"handleCECustomEvent",value:function(e){var t=e.detail;if("hax-ce-custom-button"===t.eventName)this.activeNode&&"function"==typeof this.activeNode[t.value]&&this.activeNode[t.value](e)&&xe.refreshActiveNodeForm()}},{key:"updated",value:function(e){var t=this;ie(K(a.prototype),"updated",this)&&ie(K(a.prototype),"updated",this).call(this,e),e.forEach((function(e,n){"onScreen"===n&&t.onScreen&&t._resetCEMenu(),"activeNode"!==n&&"activeEditingElement"!==n||(t.activeSchema=xe.activeSchema(),t.editElementProperty=!(!t.activeSchema||!t.activeSchema.editElement)&&t.activeSchema.editElement,t.editElementToggled=t.activeNode&&t.editElementProperty&&!!t.activeNode[t.editElementProperty])}))}},{key:"firstUpdated",value:function(e){var t=this;ie(K(a.prototype),"firstUpdated",this).call(this,e),c.autorun((function(){t.activeNode=c.toJS(xe.activeNode),t.activeNode&&t.activeNode.classList&&t._resetCEMenu(),t.activeNode&&c.toJS(xe.editMode)&&setTimeout((function(){t.__updatePlatePosition(t.activeNode)}),0)})),c.autorun((function(){c.toJS(xe.activeEditingElement)?t.hasActiveEditingElement=!0:t.hasActiveEditingElement=!1})),this.shadowRoot.querySelector("#drag").addEventListener("dragstart",this._dragStart),this.shadowRoot.querySelector("#drag").addEventListener("dragend",this._dragEnd)}},{key:"_dragEnd",value:function(e){var t=l.normalizeEventPath(e)?l.normalizeEventPath(e)[0]:void 0;t&&t.close(!0),xe._lockContextPosition=!1}},{key:"_dragStart",value:function(e){var t=c.toJS(xe.activeNode),n=l.normalizeEventPath(e)?l.normalizeEventPath(e)[0]:void 0;n&&n.close(!0),xe.__dragTarget=t,xe._lockContextPosition=!0,xe.activeHaxBody.__activeHover=null,xe.activeHaxBody._hideContextMenu(xe.activeHaxBody.contextMenus.add),e.dataTransfer&&(e.dataTransfer.effectAllowed="move",e.dataTransfer.dropEffect="move",e.dataTransfer.setDragImage(t,-20,-20)),e.stopPropagation(),e.stopImmediatePropagation()}},{key:"_resetCEMenu",value:(t=F(q().mark((function e(){var t;return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.shadowRoot&&O.wipeSlot(this,"*"),this.ceButtons=[],xe.activeHaxBody&&null!=this.activeNode?(t=xe.haxSchemaFromTag(this.activeNode.tagName),this.sourceView=t.canEditSource,xe.activeGizmo&&(this.activeTagName=xe.activeGizmo.title,this.activeTagIcon=xe.activeGizmo.icon)):xe.activeGizmo?(this.activeTagName=xe.activeGizmo.title,this.activeTagIcon=xe.activeGizmo.icon):(this.activeTagName="",this.activeTagIcon=""),e.next=5,xe.runHook(this.activeNode,"inlineContextMenu",[this]);case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}],[{key:"tag",get:function(){return"hax-plate-context"}},{key:"styles",get:function(){return[].concat(se(ie(K(a),"styles",this)),[o.css(lt||(lt=re(["\n        :host {\n          width: calc(100% - 2px);\n          align-items: stretch;\n        }\n        hax-toolbar::part(morebutton) {\n          --simple-toolbar-button-color: var(--hax-ui-color);\n          --simple-toolbar-button-bg: var(--hax-ui-background-color);\n          --simple-toolbar-button-border-color: var(--hax-ui-border-color);\n          --simple-toolbar-button-border-width: 1px;\n          --simple-toolbar-button-hover-color: var(--hax-ui-color);\n          --simple-toolbar-button-hover-bg: var(\n            --hax-ui-background-color-secondary\n          );\n          --simple-toolbar-button-toggled-color: var(--hax-ui-color-accent);\n          --simple-toolbar-button-toggled-bg: var(--hax-ui-background-color);\n          --simple-toolbar-button-toggled-border-color: var(\n            --hax-ui-color-accent\n          );\n          --simple-toolbar-button-disabled-opacity: 1;\n          --simple-toolbar-button-disabled-color: var(--hax-ui-disabled-color);\n          --simple-toolbar-button-disabled-bg: var(--hax-ui-background-color);\n          --simple-toolbar-button-disabled-border-color: unset;\n          --simple-toolbar-border-radius: 0;\n          align-self: flex-end;\n          justify-self: stretch;\n          margin: 0px -2px 0px 2px;\n        }\n        #remove {\n          max-width: 44px;\n          overflow: visible;\n        }\n        hax-toolbar {\n          max-width: calc(100% - 2px);\n          display: flex;\n          align-items: stretch;\n          justify-content: flex-start;\n        }\n        .group {\n          display: flex;\n          align-items: stretch;\n          flex: 0 0 auto;\n          justify-content: center;\n          border: 1px solid var(--rich-text-editor-border-color, #ddd);\n          padding: 0;\n        }\n        .group,\n        .group > * {\n          z-index: 1;\n        }\n        .group:empty {\n          display: none;\n        }\n        .group > *,\n        :host([collapsed]) .group {\n          flex: 0 0 auto;\n        }\n        .group *:not([toggled])::part(button) {\n          border-color: transparent;\n        }\n        :host .group:focus,\n        :host .group:focus-within,\n        :host .group > *:focus,\n        :host .group > *:focus-within {\n          z-index: 2;\n        }\n        :host .group:hover,\n        :host .group > *:hover {\n          z-index: 3;\n        }\n        .first-slot:not(:first-child) {\n          border-top: 1px solid black;\n        }\n        hax-toolbar-menu,\n        hax-context-item {\n          line-height: 30px;\n        }\n        hax-context-item {\n          --simple-toolbar-button-width: 26px;\n          --simple-toolbar-button-height: 26px;\n        }\n      "])))])}},{key:"properties",get:function(){return I(I({},ie(K(a),"properties",this)),{},{activeTagIcon:{type:String},activeSchema:{type:Object},editElementProperty:{type:String},editElementToggled:{type:Boolean},activeTagName:{type:String},disableOps:{type:Boolean},disableItemOps:{type:Boolean},insertAbove:{type:Boolean},disableDuplicate:{type:Boolean},canMoveElement:{type:Boolean},ceButtons:{type:Array},hasActiveEditingElement:{type:Boolean},onScreen:{type:Boolean,attribute:"on-screen",reflect:!0},sourceView:{type:Boolean},trayDetail:{type:String,reflect:!0,attribute:"tray-detail"},trayStatus:{type:String,reflect:!0,attribute:"tray-status"}})}}]),a}(u.I18NMixin(_e(o.LitElement)));customElements.define(pt.tag,pt),Element.prototype.replaceWith||(Element.prototype.replaceWith=l.ReplaceWithPolyfill),CharacterData.prototype.replaceWith||(CharacterData.prototype.replaceWith=l.ReplaceWithPolyfill),DocumentType.prototype.replaceWith||(DocumentType.prototype.replaceWith=l.ReplaceWithPolyfill),String.prototype.replaceAll||(String.prototype.replaceAll=function(e,t){return this.split(e).join(t)});var mt=null,gt=25,vt=200,bt=function(e){J(v,e);var t,n,a,i,r,s,d,u,h,p,m,g=oe(v);function v(){var e;if(V(this,v),(e=g.call(this))._useristyping=!1,e.__ignoreActive=!1,e.__dragMoving=!1,e.___moveLock=!1,e.viewSourceToggle=!1,e.editMode=!1,e.haxMover=!1,e.activeNode=null,e.__lockIconPath=_.SimpleIconsetStore.getIcon("icons:lock"),e.part="hax-body",e.t={addContent:"Add Content"},e.registerLocalization({context:te(e),namespace:"hax"}),!window.HaxUiStyles){window.HaxUiStyles=document.createElement("div");var t=document.createElement("style"),n=We.map((function(e){return e.cssText})).join("");t.setAttribute("data-hax",!0),t.setAttribute("type","text/css"),t.styleSheet?t.styleSheet.cssText=n:t.appendChild(document.createTextNode(n)),document.getElementsByTagName("head")[0].appendChild(t)}return e.polyfillSafe=xe.computePolyfillSafe(),e.addEventListener("place-holder-replace",e.replacePlaceholder.bind(te(e))),e.addEventListener("focusin",e._focusIn.bind(te(e))),e.addEventListener("mousemove",e._mouseMove.bind(te(e))),e.addEventListener("mouseleave",e._mouseLeave.bind(te(e))),e.addEventListener("touchstart",e._mouseMove.bind(te(e)),{passive:!0}),e.addEventListener("mousedown",e._mouseDown.bind(te(e))),e.addEventListener("mouseup",e._mouseUp.bind(te(e))),e.addEventListener("dragenter",e.dragEnterBody.bind(te(e))),e.addEventListener("dragend",e.dragEndBody.bind(te(e))),e.addEventListener("drop",e.dropEvent.bind(te(e))),c.autorun((function(){e.editMode=c.toJS(xe.editMode)})),c.autorun((function(){e.elementAlign=c.toJS(xe.elementAlign)})),c.autorun((function(){e.trayStatus=c.toJS(xe.trayStatus),e.trayDetail=c.toJS(xe.trayDetail)})),c.autorun((function(){e.activeNode=c.toJS(xe.activeNode),e.activeNode&&e.activeNode.setAttribute&&e.activeNode.setAttribute("data-hax-active","data-hax-active")})),c.autorun((function(){c.toJS(xe.activeEditingElement)})),e}return X(v,[{key:"isGridActive",get:function(){return xe.isGridPlateElement(activeNode)}},{key:"dragEndBody",value:function(e){this.__manageFakeEndCap(!1),xe._lockContextPosition=!1,this.querySelectorAll(".hax-hovered").forEach((function(e){e.classList.remove("hax-hovered")}))}},{key:"_mouseLeave",value:function(e){this.editMode&&xe.ready&&(clearTimeout(this.__mouseQuickTimer),clearTimeout(this.__mouseTimer),this.__activeHover=null)}},{key:"_mouseMove",value:function(e){var t=this;if(this.editMode&&xe.ready){var n=l.normalizeEventPath(e);clearTimeout(this.__mouseQuickTimer),this.__mouseQuickTimer=setTimeout((function(){t.__activeHover&&t.__activeHover!=n[0].closest("[data-hax-ray]:not(li)")&&(t.__activeHover=null)}),300),clearTimeout(this.__mouseTimer),this.__mouseTimer=setTimeout((function(){var e=n[0].closest("[data-hax-ray]:not(li)");if(e)t.__activeHover=e;else if(n[0].closest("[data-move-order]")&&n[3]&&n[3].closest("[data-hax-layout]"))if(n[0].closest("[data-move-order]:not(.has-nodes")){if(t.__addAbove=!1,t.__slot=n[0].closest("[data-move-order]").getAttribute("id").replace("col","col-"),0==n[0].closest("[data-move-order]").parentNode.parentNode.host.children.length){var o=document.createElement("p");n[0].closest("[data-move-order]").parentNode.parentNode.host.appendChild(o)}t.__activeHover=n[0].closest("[data-move-order]").parentNode.parentNode.host.children[0]}else t.__activeHover=n[0].closest("[data-move-order]").parentNode.parentNode.host;else n[0].closest("#bodycontainer")&&(t.__activeHover=null)}),400)}}},{key:"_mouseDown",value:function(e){if(this.editMode){this.__mouseDown=!0;var t=e.target;t.closest("[draggable]")?t=t.closest("[draggable]"):t.closest("[slot]")?t=t.closest("[slot]"):t.closest("[data-hax-ray]")?t=t.closest("[data-hax-ray]"):t.closest("[contenteditable]")?t=t.closest("[contenteditable]"):xe.validTagList.includes(t.tagName.toLowerCase())||"HAX-BODY"===t.tagName||t.haxUIElement&&"EDITABLE-TABLE"!==t.tagName||console.warn(t),t.haxUIElement&&"EDITABLE-TABLE"!==t.tagName||!this.__focusLogic(t)||(e.stopPropagation(),e.stopImmediatePropagation())}}},{key:"_mouseUp",value:function(e){var t=this;setTimeout((function(){t.__mouseDown=!1}),0),this._useristyping=!1,clearTimeout(mt),this.__manageFakeEndCap(!1)}},{key:"scrollerFixclickEvent",value:function(e){this._useristyping=!1,this.positionContextMenus(),clearTimeout(mt)}},{key:"blurEvent",value:function(e){this.editMode&&xe.activeEditingElement}},{key:"__manageFakeEndCap",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(e&&!this.__fakeEndCap){var t=document.createElement("fake-hax-body-end");t.style.width="100%",t.style.height="20px",t.style.zIndex="2",t.style.display="block",this.__fakeEndCap=t,this.haxMover=!0,this.appendChild(this.__fakeEndCap),this.__applyNodeEditableState(this.__fakeEndCap,!0)}else!e&&this.__fakeEndCap&&(this.__fakeEndCap.remove(),this.haxMover=!1,this.__fakeEndCap=null)}},{key:"dragEnterBody",value:function(e){this.hideContextMenus(),this._useristyping=!1,this.__manageFakeEndCap(!0)}},{key:"revealMenuIfHidden",value:function(e){this._useristyping=!1,this.positionContextMenus()}},{key:"render",value:function(){return o.html(dt||(dt=re(['\n      <style id="hax-body-style-element"></style>\n      <div\n        id="bodycontainer"\n        class="ignore-activation"\n        element-align="','"\n      >\n        <slot id="body"></slot>\n      </div>\n      <absolute-position-behavior\n        id="topcontext"\n        fit-to-visible-bounds\n        justify\n        position="top"\n        allow-overlap\n        auto\n        sticky\n        data-node-type="','"\n        .target="','"\n        .trayStatus="','"\n        ?hidden="','"\n      >\n        <div id="topcontextmenu" @mouseenter="','">\n          <hax-plate-context\n            always-expanded\n            id="platecontextmenu"\n            class="hax-context-menu ignore-activation"\n            .activeNode="','"\n            .trayDetail="','"\n            .trayStatus="','"\n            ?viewSource="','"\n            ?canMoveElement="','"\n          ></hax-plate-context>\n          <hax-text-editor-toolbar\n            id="textcontextmenu"\n            class="hax-context-menu ignore-activation ','"\n            .activeNode="','"\n            show="always"\n          >\n          </hax-text-editor-toolbar>\n        </div>\n      </absolute-position-behavior>\n    '])),this.elementAlign||"left",this.activeNode?this.viewSourceToggle?this.activeNode.parentNode.tagName:this.activeNode.tagName:"",this.activeNode?this.viewSourceToggle?this.activeNode.parentNode:this.activeNode:document.body,this.trayStatus,!this.activeNode,this.revealMenuIfHidden,this.activeNode,this.trayDetail,this.trayStatus,this.viewSourceToggle,this.canMoveElement,this.calcClasses(this.activeNode),this.activeNode)}},{key:"calcClasses",value:function(e){var t="not-text";return e&&e.getAttribute&&!e.getAttribute("data-hax-lock")&&e.parentNode&&e.parentNode.getAttribute&&!e.parentNode.getAttribute("data-hax-lock")&&xe.isTextElement(e)&&!xe.isSingleSlotElement(e)&&(t="is-text"),t}},{key:"HAXBODYStyleSheetContent",value:function(){var e=[];return e.push(o.css(ut||(ut=re(['\n      :host([edit-mode]) #bodycontainer ::slotted(*[data-hax-lock])::after {\n        background-image: url("','");\n      }\n    '])),o.unsafeCSS(this.__lockIconPath))),e}},{key:"firstUpdated",value:function(e){var t=this;o.render(this.HAXBODYStyleSheetContent(),this.shadowRoot.querySelector("#hax-body-style-element")),this.dispatchEvent(new CustomEvent("hax-register-body",{bubbles:!0,cancelable:!0,composed:!0,detail:this}));try{document.execCommand("enableObjectResizing",!1,!1),document.execCommand("defaultParagraphSeparator",!1,"p")}catch(e){console.warn(e)}this.contextMenus={text:this.shadowRoot.querySelector("#textcontextmenu"),plate:this.shadowRoot.querySelector("#platecontextmenu"),parent:this.shadowRoot.querySelector("#topcontext")},this.shadowRoot.querySelector("slot").addEventListener("mouseup",(function(e){t.editMode&&setTimeout((function(){var e=xe.getSelection();xe._tmpSelection=e,xe.haxSelectedText=e.toString();try{var t=xe.getRange();t.cloneRange&&(xe._tmpRange=t.cloneRange())}catch(e){console.warn(e)}}),10)})),this.editMode=xe.editMode,this.__tabTrap=!1,this.ready=!0,ie(K(v.prototype),"firstUpdated",this)&&ie(K(v.prototype),"firstUpdated",this).call(this,e)}},{key:"updated",value:(m=F(q().mark((function e(t){var n=this;return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ie(K(v.prototype),"updated",this)&&ie(K(v.prototype),"updated",this).call(this,t),t.forEach(function(){var e=F(q().mark((function e(t,o){return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("editMode"==o&&void 0!==t&&setTimeout(F(q().mark((function e(){return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.__ignoreActive=!0,e.next=3,n._editModeChanged(n[o],t);case 3:setTimeout((function(){n.__ignoreActive=!1}),100);case 4:case"end":return e.stop()}}),e)}))),0),"_useristyping"==o&&n[o]&&n.hideContextMenus(),"activeNode"!=o||!n.ready||void 0===t){e.next=5;break}return e.next=5,n._activeNodeChanged(n[o],t);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"_toggleNodeLocking",value:function(e){e.detail.lock?(this.contextMenus.plate.disableDuplicate=!0,this.contextMenus.plate.disableOps=!0,this.contextMenus.plate.disableItemOps=!0,this.contextMenus.plate.canMoveElement=!1,e.detail.node.removeAttribute("contenteditable"),this.removeAttribute("contenteditable")):(this.contextMenus.plate.disableDuplicate=!1,this.contextMenus.plate.disableOps=!1,this.contextMenus.plate.disableItemOps=!1,this.contextMenus.plate.canMoveElement=this.canMoveElement,e.detail.node.setAttribute("contenteditable",!0),this.setAttribute("contenteditable",!0)),this.requestUpdate()}},{key:"_keepContextVisible",value:function(){var e=this;this.editMode&&(clearTimeout(this.__contextVisibleLock),this.__contextVisibleLock=setTimeout((function(){var t=!1;e.contextMenus.plate.classList.contains("hax-context-visible")&&(t=e.contextMenus.plate),t&&e.positionContextMenus()}),100))}},{key:"_onKeyDown",value:function(e){var t=this;if(this.editMode&&"HAX-TRAY"!==document.activeElement.tagName&&"BODY"!==document.activeElement.tagName&&"SIMPLE-MODAL"!==document.activeElement.tagName&&(this.getAttribute("contenteditable")&&(this.__dropActiveVisible(),this.__manageFakeEndCap(!1),null!=xe.getSelection().anchorNode)))switch(e.key){case"Z":case"z":e.ctrlKey&&(e.shiftKey?this.redo():this.undo(),e.detail.keyboardEvent&&(e.detail.keyboardEvent.preventDefault(),e.detail.keyboardEvent.stopPropagation(),e.detail.keyboardEvent.stopImmediatePropagation()),e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation());break;case"Tab":this._useristyping=!0,xe.isTextElement(this.activeNode)&&(e.detail.keyboardEvent&&(e.detail.keyboardEvent.preventDefault(),e.detail.keyboardEvent.stopPropagation(),e.detail.keyboardEvent.stopImmediatePropagation()),e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),e.shiftKey?this._tabBackKeyPressed():this._tabKeyPressed());break;case"Enter":if(this._useristyping=!0,this.activeNode&&(this.__slot=this.activeNode.getAttribute("slot")),this.activeNode&&"P"===this.activeNode.tagName&&["1","#","`",">","-","!"].includes(this.activeNode.textContent[0])){var n=this.activeNode.textContent.replaceAll(//g," ");this.keyboardShortCutProcess(n)}break;case"Backspace":case"Delete":this._useristyping=!0,this.__delHit=!0,this.querySelectorAll("[data-hax-active]").forEach((function(e){return e.classList.remove})),setTimeout((function(){var e=xe.getSelection();xe._tmpSelection=e,xe.haxSelectedText=e.toString();var n=xe.getRange();n.commonAncestorContainer&&t.activeNode!==n.commonAncestorContainer&&"function"==typeof n.commonAncestorContainer.focus?"HAX-BODY"!==n.commonAncestorContainer.tagName&&t.__focusLogic(n.commonAncestorContainer,!1):n.commonAncestorContainer&&n.commonAncestorContainer.parentNode&&t.activeNode!==n.commonAncestorContainer.parentNode&&"function"==typeof n.commonAncestorContainer.parentNode.focus&&("HAX-BODY"!==n.commonAncestorContainer.parentNode.tagName?t.__focusLogic(n.commonAncestorContainer.parentNode,!1):t.__focusLogic(n.commonAncestorContainer,!1))}),100);break;case"Escape":this._useristyping=!0;break;case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":this._useristyping=!0,this.querySelectorAll("[data-hax-active]").forEach((function(e){return e.classList.remove})),setTimeout((function(){var e=xe.getSelection();xe._tmpSelection=e,xe.haxSelectedText=e.toString();var n=xe.getRange();n.commonAncestorContainer&&t.activeNode!==n.commonAncestorContainer&&"function"==typeof n.commonAncestorContainer.focus?"HAX-BODY"!==n.commonAncestorContainer.tagName&&t.__focusLogic(n.commonAncestorContainer,!1):n.commonAncestorContainer&&n.commonAncestorContainer.parentNode&&t.activeNode!==n.commonAncestorContainer.parentNode&&"function"==typeof n.commonAncestorContainer.parentNode.focus&&("HAX-BODY"!==n.commonAncestorContainer.parentNode.tagName?t.__focusLogic(n.commonAncestorContainer.parentNode,!1):t.__focusLogic(n.commonAncestorContainer,!1))}),0);break;default:this._useristyping=!0,setTimeout((function(){if(t.activeNode&&"P"===t.activeNode.tagName&&["1","#","`",">","-","!"].includes(t.activeNode.textContent[0])){var e=t.activeNode.textContent.replaceAll(//g," ");" "===e[e.length-1]&&t.keyboardShortCutProcess(e)}}),0)}}},{key:"keyboardShortCutProcess",value:function(e){if(xe.keyboardShortcuts[e.replace(" ","")]){var t=l.haxElementToNode(xe.keyboardShortcuts[e.replace(" ","")]);this.haxReplaceNode(this.activeNode,t),this.__focusLogic(t),"HR"===t.tagName&&this.haxInsert("p","",{})}else if("!"===e[0]){var n=e.replace("!","").replaceAll(/ /g,"");if(xe.elementList[n]){var o,a=xe.haxSchemaFromTag(n);o=a.gizmo.tag&&a.demoSchema&&a.demoSchema[0]?l.haxElementToNode(a.demoSchema[0]):document.createElement(n),this.haxReplaceNode(this.activeNode,o),this.__focusLogic(o)}else xe.toast("".concat(n," is not a valid tag"))}}},{key:"setActiveNode",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e&&this.editMode&&this.activeNode&&(xe.isTextElement(this.activeNode)||n)&&(xe.activeNode=e,clearTimeout(this.__positionContextTimer),this.__positionContextTimer=setTimeout((function(){t.__addActiveVisible(),t.positionContextMenus()}),2e3))}},{key:"elementMidViewport",value:function(){var e=this.activeNode.getBoundingClientRect().y;return e<0&&e>-1*this.activeNode.offsetHeight+140}},{key:"replacePlaceholder",value:function(e){if("text"===e.detail){var t=document.createElement("p");this.haxReplaceNode(this.activeNode,t),this.__focusLogic(t),this.activeNode.parentNode&&this.activeNode.parentNode.setAttribute("contenteditable",!0)}else this.replaceElementWorkflow()}},{key:"canTansformNode",value:(p=F(q().mark((function e(){var t,n=arguments;return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:null,e.next=3,this.replaceElementWorkflow(t,!0).length;case 3:if(e.t0=e.sent,!(e.t0>0)){e.next=8;break}e.t1=!0,e.next=9;break;case 8:e.t1=!1;case 9:return e.abrupt("return",e.t1);case 10:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"insertElementWorkflow",value:(h=F(q().mark((function e(){return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case 2:case"end":return e.stop()}}),e)}))),function(){return h.apply(this,arguments)})},{key:"primitiveTextBlocks",get:function(){return["p","div","pre","h1","h2","h3","h4","h5","h6"]}},{key:"getAllSlotConfig",value:function(e){if(e){var t=this.getParentGrid(e);return t&&t.tag?this.getSlotConfig(xe.elementList[t.tag],slot):void 0}}},{key:"getParentGrid",value:function(e){return((e=e||this.activeNode)?e.slot:void 0)?l.nodeToHaxElement(e.parentNode):void 0}},{key:"getSlotConfig",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.settings,o=n?Object.keys(n||{}).map((function(t){return n[t].filter((function(t){return!(!t.slot||e&&t.slot!==e)}))})).flat():void 0;return o&&o.length>0?o[0]:void 0}},{key:"replaceElementWorkflow",value:(u=F(q().mark((function e(){var t,n,o,a,i,r,s,c,d,u,h,p,m,g,v,b,f,x=arguments;return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=x.length>0&&void 0!==x[0]?x[0]:null,n=x.length>1&&void 0!==x[1]&&x[1],null==t&&(t=this.activeNode),e.next=5,l.nodeToHaxElement(t,null);case 5:if(o=e.sent){e.next=8;break}return e.abrupt("return");case 8:if(a="*",i=!1,r=(t||{}).slot,s=this.getParentGrid(t),"place-holder"===o.tag&&"undefined"!==G(o.properties.type)?(a=o.properties.type,i=!0):this.primitiveTextBlocks.includes(o.tag)&&(i=!0),c=o.content?{innerHTML:o.content}:{},"undefined"!==G(xe.elementList[o.tag])&&!1!==xe.elementList[o.tag].gizmo&&"undefined"!==G(xe.elementList[o.tag].gizmo.handles)&&xe.elementList[o.tag].gizmo.handles.length>0)for(d=xe.elementList[o.tag].gizmo,u=0;u<d.handles.length;u++)for(h in o.properties.innerHTML&&(c.innerHTML=o.properties.innerHTML),d.handles[u])"type"!==h&&"undefined"!==G(o.properties[d.handles[u][h]])&&(c[h]=o.properties[d.handles[u][h]]);return p=xe.guessGizmo(a,c,i),m=s?this.getSlotConfig(r,xe.elementList[s.tag]):void 0,g=s&&"grid-plate"===s.tag?["grid-plate"]:m?m.excludedSlotWrappers:void 0,v=m?m.allowedSlotWrappers:void 0,(g||v)&&(p=p.filter((function(e){return!g.includes(e.tag)&&(!v||v.includes(e.tag))}))),p.length>0?(b=t.tagName.toLowerCase(),f=b.replace("-"," "),"undefined"!==G(xe.elementList[b])&&!1!==xe.elementList[b].gizmo&&(f=xe.elementList[b].gizmo.title),n||(xe.activePlaceHolder=this.activeNode,xe.haxAppPicker.presentOptions(p,"__convert","Change ".concat(f," to..."),"gizmo"))):n||xe.toast("Sorry, this can not be transformed!",5e3),e.abrupt("return",p);case 22:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"_haxStorePropertyUpdated",value:function(e){e.detail&&"undefined"!==G(e.detail.value)&&e.detail.property&&(this[e.detail.property]=e.detail.value)}},{key:"haxClearBody",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!0;e&&(t=prompt("Are you sure you want to delete all content?")),t&&l.wipeSlot(this)}},{key:"haxInsert",value:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.activeNode,i=document.createElement(e);i.innerHTML=t;var r=i.cloneNode(!0);for(var s in o){var c=l.camelToDash(s);""!=c&&o.hasOwnProperty(s)&&(!0===o[s]?r.setAttribute(c,c):!1===o[s]?r.removeAttribute(c):null!=o[s]&&o[s].constructor===Array||null!=o[s]&&o[s].constructor===Object?r.properties&&r.properties[s].readOnly||(r.set?r.set(c,o[s]):r[c]=o[s]):r.setAttribute(c,o[s]))}return null!==xe.activePlaceHolder&&"undefined"!==G(xe.activePlaceHolder.style)?(r.style.width=xe.activePlaceHolder.style.width,r.style.float=xe.activePlaceHolder.style.float,r.style.margin=xe.activePlaceHolder.style.margin,r.style.display=xe.activePlaceHolder.style.display,this.haxReplaceNode(xe.activePlaceHolder,r),xe.activePlaceHolder=null):a&&a.parentNode?this.__isLayout(a.parentNode)?(null!=a.getAttribute("slot")&&r.setAttribute("slot",a.getAttribute("slot")),this.__addAbove?a.parentNode.insertBefore(r,a):a.parentNode.insertBefore(r,a.nextElementSibling)):a.parentNode&&a.parentNode.nextElementSibling?a.parentNode.nextElementSibling.parentNode.insertBefore(r,a.parentNode.nextElementSibling):a.parentNode&&a.nextElementSibling?this.__addAbove?a.parentNode.insertBefore(r,a):a.parentNode.insertBefore(r,a.nextElementSibling):a.parentNode&&a.parentNode.children[a.parentNode.children.length-1]===a?this.__addAbove?a.parentNode.insertBefore(r,a):a.parentNode.appendChild(r):a.parentNode?a.parentNode.insertBefore(r,a):this.appendChild(r):this.appendChild(r),this.contextMenus.text.hasSelectedText=!1,setTimeout((function(){n.__focusLogic(r),n.scrollHere(r)}),0),r}},{key:"haxToContent",value:(d=F(q().mark((function e(){var t,n,o,a,i,r,s,c,d;return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.hideContextMenus(),t=this.activeNode,xe.activeNode=null,n="slot"===this.shadowRoot.querySelector("#body").localName?this.shadowRoot.querySelector("#body").assignedNodes({flatten:!0}):[],o="",a=0;case 6:if(!(a<n.length)){e.next=43;break}if(!this._validElementTest(n[a])){e.next=18;break}return this.__applyDragDropState(n[a],!1),n[a].classList.remove("hax-hovered"),n[a].contentEditable=!1,e.t0=o,e.next=14,xe.nodeToContent(n[a]);case 14:o=e.t0+=e.sent,this.__isLayout(n[a])&&this._applyContentEditable(this.editMode,n[a]),e.next=40;break;case 18:if(8!==n[a].nodeType){e.next=22;break}o+="\x3c!-- "+n[a].textContent+" --\x3e",e.next=40;break;case 22:if(!(n[a].haxUIElement&&n[a].children&&n[a].children[0])){e.next=39;break}return e.next=25,xe.runHook(n[a],"activeElementChanged",[this.activeNode,!1]);case 25:if(!(i=e.sent)||i===n[a]){e.next=33;break}return e.t1=o,e.next=30,xe.nodeToContent(i);case 30:o=e.t1+=e.sent,e.next=37;break;case 33:return e.t2=o,e.next=36,xe.nodeToContent(n[a].children[0]);case 36:o=e.t2+=e.sent;case 37:e.next=40;break;case 39:1!==n[a].nodeType&&"undefined"!==G(n[a].textContent)&&"undefined"!==n[a].textContent?o+=n[a].textContent:console.warn(n[a]);case 40:a++,e.next=6;break;case 43:if(o=(o=(o=(o=(o=o.replace(/\scontenteditable=\"false\"/g,"")).replace(/\scontenteditable/g,"")).replace(/\sdraggable/g,"")).replace(/\sdata-hax-ray=\".*?\"/g,"")).replace(/\sdata-hax-grid/g,""),this.parentNode.tagName)for(a in r=this.parentNode.tagName.toLowerCase(),s="style-scope "+r+" x-scope",c=new RegExp(s,"g"),o=o.replace(c,""),s="style-scope "+r,c=new RegExp(s,"g"),o=o.replace(c,""),s="x-scope "+r+"-0",c=new RegExp(s,"g"),o=o.replace(c,""),d=xe.validTagList)s="style-scope "+d[a],c=new RegExp(s,"g"),o=o.replace(c,""),s="x-scope "+d[a]+"-0 ",c=new RegExp(s,"g"),o=o.replace(c,""),s="x-scope "+d[a]+"-0",c=new RegExp(s,"g"),o=o.replace(c,"");return o=(o=o.replace(/\sclass=\"\"/g,"")).replace(/\sclass=\"\s\"/g,""),this._applyContentEditable(this.editMode),xe.activeNode=t,o=l.encapScript(o),e.abrupt("return",o);case 55:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"haxDuplicateNode",value:(s=F(q().mark((function e(t){var n,o;return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.nodeToHaxElement(t,null);case 2:if(n=e.sent,!xe.testHook(t,"preProcessInsertContent")){e.next=7;break}return e.next=6,xe.runHook(t,"preProcessInsertContent",[n,this.activeNode]);case 6:n=e.sent;case 7:return n.content==n.properties.innerHTML&&delete n.properties.innerHTML,"webview"===(o=l.haxElementToNode({tag:n.tag,content:n.content,properties:n.properties})).tagName.toLowerCase()&&xe._isSandboxed&&"undefined"!==G(o.guestinstance)&&delete o.guestinstance,null!==t?t.parentNode.insertBefore(o,t.nextSibling):t.parentNode.appendChild(o),xe.activeNode=o,e.abrupt("return",!0);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"hideContextMenus",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];clearTimeout(mt),clearTimeout(this.__contextVisibleLock),clearTimeout(this.__positionContextTimer),this._hideContextMenu(this.contextMenus.text),this.__activeHover=null,e&&this._hideContextMenu(this.contextMenus.plate)}},{key:"positionContextMenus",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeNode;if(t&&t.tagName&&this.ready&&!this._useristyping){var n=t.tagName.toLowerCase();xe.elementList&&xe.elementList[n]&&xe.elementList[n].contentEditable&&null===t.getAttribute("data-hax-lock")&&t.parentNode&&null===t.parentNode.getAttribute("data-hax-lock")?t.setAttribute("contenteditable",!0):t.removeAttribute("contenteditable"),clearTimeout(this.__positionContextTimer),this.__positionContextTimer=setTimeout((function(){if(!xe._lockContextPosition){var n=t.tagName.toLowerCase();xe._isSandboxed&&"webview"===n&&(n="iframe");var o=xe.elementList[n];t?e._showContextMenu(e.contextMenus.plate):e._hideContextMenu(e.contextMenus.plate),"undefined"===G(o)||xe.isTextElement(t)?e._showContextMenu(e.contextMenus.text):(e._hideContextMenu(e.contextMenus.text),o.element=t),(o||{}).gizmo;var a=o&&o.gizmo&&(o.gizmo.handles||[]).filter((function(e){return"inline"===(e||{}).type})).length>0;o&&"core"!=o.editingElement?setTimeout((function(){(t&&t.parentNode||!a)&&(e.canMoveElement=!0)}),250):e.activeNode&&("LI"===e.activeNode.tagName||e._HTMLInlineTextDecorationTest(e.activeNode))?e.canMoveElement=!1:e.canMoveElement=!0}e.contextMenus.parent.setPosition()}),50)}}},{key:"__addActiveVisible",value:function(){for(var e in this.contextMenus)("add"!=e||this.__activeHover)&&this.contextMenus[e].classList.add("hax-context-menu-active")}},{key:"__dropActiveVisible",value:function(){for(var e in this.contextMenus)this.contextMenus[e].classList.remove("hax-context-menu-active");this.__activeHover=null}},{key:"haxMoveGridPlate",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.___moveLock=!0;var o=e?e.parentNode:void 0,a=n>0?e.nextElementSibling:e.previousElementSibling,i=this.__layoutSlots(o)||[],r=e.getAttribute("slot"),s=r?i.indexOf(r):-1,l=i[s+n];return a&&(!r||a.getAttribute("slot")),!a||r&&r!==a.getAttribute("slot")?l?e.setAttribute("slot",l):e&&o&&o!==this&&(a=n>0?o.nextElementSibling:o,l=o.getAttribute("slot"),a&&(o.parentNode.insertBefore(e,a),l&&e.setAttribute("slot",l))):o.insertBefore(e,n>0?a.nextElementSibling:a),setTimeout((function(){xe.activeNode=e,t.scrollHere(e),t.__focusLogic(e)}),100),!0}},{key:"haxGridPlateOps",value:(r=F(q().mark((function e(){var t,n,o,a,i,r,s,l,c,d,u=arguments;return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!(u.length>0&&void 0!==u[0])||u[0],n=u.length>1&&void 0!==u[1]?u[1]:"right","GRID-PLATE"!==(o=u.length>2&&void 0!==u[2]?u[2]:this.activeNode).tagName&&"GRID-PLATE"===o.parentNode.tagName&&(o=o.parentNode),a=!1,"GRID-PLATE"!==o.tagName){e.next=51;break}if(!t){e.next=27;break}e.t0=o.layout,e.next="1"===e.t0?10:"1-1"===e.t0?13:"1-1-1"===e.t0?16:"1-1-1-1"===e.t0?19:"1-1-1-1-1"===e.t0?22:25;break;case 10:return o.layout="1-1",a=!0,e.abrupt("break",25);case 13:return o.layout="1-1-1",a=!0,e.abrupt("break",25);case 16:return o.layout="1-1-1-1",a=!0,e.abrupt("break",25);case 19:return o.layout="1-1-1-1-1",a=!0,e.abrupt("break",25);case 22:return o.layout="1-1-1-1-1-1",a=!0,e.abrupt("break",25);case 25:e.next=48;break;case 27:e.t1=o.layout,e.next="1-1"===e.t1?30:"1-1-1"===e.t1?36:"1-1-1-1"===e.t1?39:"1-1-1-1-1"===e.t1?42:"1-1-1-1-1-1"===e.t1?45:48;break;case 30:return e.next=32,o.childNodes.forEach((function(e){e.tagName&&(i=e.cloneNode(!0),o.getAttribute("slot")?i.setAttribute("slot",o.getAttribute("slot")):i.removeAttribute("slot"),o.parentNode.insertBefore(i,o))}));case 32:return xe.activeNode=i,setTimeout((function(){o.remove()}),0),a=!0,e.abrupt("break",48);case 36:return o.layout="1-1",a=!0,e.abrupt("break",48);case 39:return o.layout="1-1-1",a=!0,e.abrupt("break",48);case 42:return o.layout="1-1-1-1",a=!0,e.abrupt("break",48);case 45:return o.layout="1-1-1-1-1",a=!0,e.abrupt("break",48);case 48:a&&(r=this.contextMenus.plate.shadowRoot.querySelector("#right"),s=this.contextMenus.plate.shadowRoot.querySelector("#rightremove"),r.disabled=!1,s.disabled=!1,"1-1-1-1-1-1"==o.layout&&(r.disabled=!0),"left"==n&&o.childNodes.forEach((function(e){if(e.tagName){var t=parseInt(e.getAttribute("slot").replace("col-",""),10)+1;e.setAttribute("slot","col-".concat(t))}}))),e.next=62;break;case 51:(l=document.createElement("grid-plate")).layout="1-1",l.disableResponsive=!0,o.getAttribute("slot")&&l.setAttribute("slot",o.getAttribute("slot")),c="2","right"==n&&(c="1"),(d=o.cloneNode(!0)).setAttribute("slot","col-"+c),l.appendChild(d),o.parentNode.insertBefore(l,o),setTimeout((function(){o.remove()}),0);case 62:return e.next=64,xe.refreshActiveNodeForm();case 64:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"haxReplaceNode",value:function(e,t){try{null==e&&(e=this.__oldActiveNode),!e.replaceWith&&xe._tmpRange&&(e=xe._tmpRange,xe._tmpRange=null),e&&e.getAttribute&&null!=e.getAttribute("slot")&&t.setAttribute("slot",e.getAttribute("slot")),e.replaceWith(t)}catch(e){console.warn(e)}return t}},{key:"haxChangeTagName",value:function(e,t){for(var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=document.createElement(t),a=0,i=e.attributes.length;a<i;++a){var r=e.attributes.item(a).nodeName,s=e.attributes.item(a).value;try{o.setAttribute(r,s)}catch(t){console.warn(e.attributes),console.warn(t)}}n&&(o.innerHTML=e.innerHTML.trim()),"ul"==t||"ol"==t?"<br />"==o.innerHTML?o.innerHTML="<li><br /></li>":"ul"!=e.tagName.toLowerCase()&&"ol"!=e.tagName.toLowerCase()&&(o.innerHTML="<li>"+e.innerHTML.trim().replace(/<br\/>/g,"</li>\n<li>").replace(/<br>/g,"</li>\n<li>")+"</li>"):"ul"!=e.tagName.toLowerCase()&&"ol"!=e.tagName.toLowerCase()||(o.innerHTML=o.innerHTML.replace(/<ul>/g,"").replace(/<\/ul>/g,"").replace(/<li><\/li>/g,"").replace(/<li>/g,"").replace(/<\/li>/g,"<br/>"));try{e.replaceWith(o),n&&setTimeout((function(){var e=o.children;e[0]&&e.tagName?e[0].focus():o.focus()}),10)}catch(t){console.warn(t),console.warn(o),console.warn(e)}return o}},{key:"haxDeleteNode",value:function(e){if(e.previousElementSibling)xe.activeNode=e.previousElementSibling;else if(e.nextElementSibling)xe.activeNode=e.nextElementSibling;else{this.haxInsert("p","",{});try{var t=document.createRange(),n=xe.getSelection();t.setStart(this.activeNode,0),t.collapse(!0),n.removeAllRanges(),n.addRange(t),this.activeNode.focus()}catch(e){console.warn(e)}}try{return e.remove()}catch(e){console.warn(e)}}},{key:"importContent",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];n&&l.wipeSlot(this,"*"),setTimeout((function(){e=l.encapScript(e);var n=document.createElement("div");for(n.insertAdjacentHTML("beforeend",e);null!==n.firstChild;)if("undefined"!==G(n.firstChild.tagName))if(xe._isSandboxed&&"iframe"===n.firstChild.tagName.toLowerCase()){for(var o=document.createElement("webview"),a=0,i=n.firstChild.attributes.length;a<i;++a){var r=n.firstChild.attributes.item(a).nodeName,s=n.firstChild.attributes.item(a).value;"height"!==r&&"width"!==r||o.style[r],o.setAttribute(r,s)}t.appendChild(o)}else t.appendChild(n.firstChild);else n.removeChild(n.firstChild)}),0)}},{key:"sortGridSlots",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeNode,t=xe.haxSchemaFromTag(e.tagName);if("grid"===t.type){var n="GRID-PLATE"===e.tagName?e.layout.split("-").map((function(e,t){return"col-".concat(t)})):xe.slotsFromSchema(t).map((function(e){return e.slot}));n.reverse().forEach((function(t,n){0==n?e.querySelectorAll("[slot=".concat(t,"]")).forEach((function(t){return e.append(t)})):se(e.querySelectorAll("[slot=".concat(t,"]"))).reverse().forEach((function(t){return e.insertBefore(t,e.firstChild)}))}))}}},{key:"_haxContextOperation",value:(i=F(q().mark((function e(t){var n,o,a,i,r,s,c,d,u,h,p,m,g,v,b,f,x,y,k,w,N=this;return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.detail,o=l.normalizeEventPath(t),a=o&&o[0]?o[0].getAttribute("data-slot"):void 0,e.t0=n.eventName,e.next="insert-above-active"===e.t0?4:"insert-below-active"===e.t0?6:"move-to-slot"===e.t0?8:"insert-into-active"===e.t0?10:"hax-select-grid"===e.t0?12:"hax-select-grid-item"===e.t0?14:"hax-edit-element-toggle"===e.t0?16:"hax-source-view-toggle"===e.t0?18:"hax-full-text-editor-toggle"===e.t0?53:"text-tag"===e.t0?70:"text-tag-ul"===e.t0?73:"text-tag-ol"===e.t0?77:"text-align-left"===e.t0?81:"hax-transform-node"===e.t0?83:"hax-plate-create-right"===e.t0?85:"hax-plate-remove-right"===e.t0?87:"hax-plate-duplicate"===e.t0?89:"hax-plate-delete"===e.t0?91:"hax-plate-up"===e.t0?93:"hax-plate-down"===e.t0?95:"content-edit"===e.t0?97:"hide-context-menus"===e.t0?100:102;break;case 4:return this.activeNode&&this.activeNode.previousElementSibling?this.haxInsert("p","",{},this.activeNode.previousElementSibling):(i=document.createElement("p"),this.insertBefore(i,this.activeNode)),e.abrupt("break",102);case 6:return this.haxInsert("p","",{}),e.abrupt("break",102);case 8:return a&&this.activeNode&&xe.isGridPlateElement(this.activeNode.parentNode)&&(this.activeNode.slot=a,this.sortGridSlots(this.activeNode.parentNode)),e.abrupt("break",102);case 10:return a&&this.activeNode&&xe.isGridPlateElement(this.activeNode)&&((r=document.createElement("p")).slot=a,this.activeNode.append(r),this.haxInsert("p","",{slot:a},r),r.remove(),this.sortGridSlots()),e.abrupt("break",102);case 12:return o[0]&&o[0].eventData&&(s=o[0].eventData,this.setActiveNode(s,!0),this.positionContextMenus(s)),e.abrupt("break",102);case 14:return o[0]&&o[0].eventData&&(c=o[0].eventData,d=c.target,u=c.slot,h=c.index,p=c.grid,m=c.editMode,g=c.invisible,v=g?p:se(p.children).filter((function(e){return u&&""!==u?e.slot===u:!e.slot||""===e.slot}))[h]||d,p&&m?this.setSlotEditMode(p,m,v):(this.setActiveNode(node,!0),this.positionContextMenus(node))),e.abrupt("break",102);case 16:return o[0]&&o[0].eventData&&(b=o[0].eventData)&&b.target&&b.editMode&&this.toggleElementEditMode(b.target,b.editMode),e.abrupt("break",102);case 18:if(this.activeNode.__haxSourceView){e.next=40;break}if(this.activeNode.__haxSourceView=!0,xe.activeEditingElement=document.createElement("code-editor"),xe.activeEditingElement.language="html",xe.activeEditingElement.title="",xe.activeEditingElement.theme="vs",xe.activeEditingElement.fontSize=12,xe.activeEditingElement.wordWrap=!0,this.viewSourceToggle=!0,this.activeNode.getAttribute&&null!=this.activeNode.getAttribute("slot")&&xe.activeEditingElement.setAttribute("slot",this.activeNode.getAttribute("slot")),this.__ignoreActive=!0,this.activeNode.removeAttribute("contenteditable"),this.__applyDragDropState(this.activeNode,!1),this.activeNode.removeAttribute("data-hax-active"),!xe.testHook(this.activeNode,"preProcessNodeToContent")){e.next=36;break}return e.next=35,xe.runHook(this.activeNode,"preProcessNodeToContent",[this.activeNode]);case 35:xe.activeNode=e.sent;case 36:l.wrap(this.activeNode,xe.activeEditingElement),xe.activeEditingElement.focus(),e.next=52;break;case 40:return this.activeNode.__haxSourceView=!1,e.next=43,xe.runHook(xe.activeEditingElement,"activeElementChanged",[this.activeNode,!1]);case 43:if(f=e.sent,x={},this.activeNode&&this.activeNode.tagName?x=xe.haxSchemaFromTag(this.activeNode.tagName.toLowerCase()):this.activeNode.parentElement&&this.activeNode.parentElement.tagName&&(x=xe.haxSchemaFromTag(this.activeNode.parentElement.tagName.toLowerCase())),this.activeNode&&this.activeNode.getAttribute&&null!=this.activeNode.getAttribute("slot")&&f.setAttribute("slot",this.activeNode.getAttribute("slot")),x.saveOptions&&x.saveOptions.unsetAttributes&&x.saveOptions.unsetAttributes.length)for(y in x.saveOptions.unsetAttributes)f.removeAttribute(x.saveOptions.unsetAttributes[y]);this.__applyNodeEditableState(f,this.editMode),l.unwrap(xe.activeEditingElement),xe.activeEditingElement=null,this.viewSourceToggle=!1;case 52:return e.abrupt("break",102);case 53:if(this.activeNode.__haxSourceView){e.next=58;break}this.activeNode.__haxSourceView=!0,Promise.resolve(D).then((function(){xe.activeEditingElement=document.createElement("rich-text-editor"),xe.activeEditingElement.type="rich-text-editor-toolbar-full",N.activeNode.getAttribute&&null!=N.activeNode.getAttribute("slot")&&xe.activeEditingElement.setAttribute("slot",N.activeNode.getAttribute("slot")),N.__ignoreActive=!0,N.activeNode.removeAttribute("contenteditable"),N.__applyDragDropState(N.activeNode,!1),N.activeNode.removeAttribute("data-hax-active"),l.wrap(N.activeNode,xe.activeEditingElement),N.viewSourceElement=xe.activeEditingElement})),e.next=69;break;case 58:return this.activeNode.__haxSourceView=!1,e.next=61,xe.runHook(xe.activeEditingElement,"activeElementChanged",[this.activeNode,!1]);case 61:if(k=e.sent,w=xe.haxSchemaFromTag(this.activeNode.tagName.toLowerCase()),this.activeNode&&this.activeNode.getAttribute&&null!=this.activeNode.getAttribute("slot")&&k.setAttribute("slot",this.activeNode.getAttribute("slot")),w.saveOptions&&w.saveOptions.unsetAttributes&&w.saveOptions.unsetAttributes.length)for(y in w.saveOptions.unsetAttributes)k.removeAttribute(w.saveOptions.unsetAttributes[y]);this.__applyNodeEditableState(k,this.editMode),l.unwrap(xe.activeEditingElement),xe.activeEditingElement=null,this.viewSourceElement=xe.activeEditingElement;case 69:return e.abrupt("break",102);case 70:return xe.activeNode=this.haxChangeTagName(this.activeNode,n.value),this.positionContextMenus(),e.abrupt("break",102);case 73:return this.contextMenus.text.realSelectedValue="ul",xe.activeNode=this.haxChangeTagName(this.activeNode,"ul"),this.positionContextMenus(),e.abrupt("break",102);case 77:return this.contextMenus.text.realSelectedValue="ol",xe.activeNode=this.haxChangeTagName(this.activeNode,"ol"),this.positionContextMenus(),e.abrupt("break",102);case 81:return this.activeNode.style.textAlign=null,e.abrupt("break",102);case 83:return this.replaceElementWorkflow(),e.abrupt("break",102);case 85:return this.haxGridPlateOps(),e.abrupt("break",102);case 87:return this.haxGridPlateOps(!1),e.abrupt("break",102);case 89:return this.haxDuplicateNode(this.activeNode),e.abrupt("break",102);case 91:return null!=this.activeNode&&this.haxDeleteNode(this.activeNode),e.abrupt("break",102);case 93:return this.activeNode.previousElementSibling&&"PAGE-BREAK"!==this.activeNode.previousElementSibling.tagName&&this.haxMoveGridPlate(this.activeNode,-1),e.abrupt("break",102);case 95:return this.activeNode.nextElementSibling&&this.haxMoveGridPlate(this.activeNode),e.abrupt("break",102);case 97:return"content-edit"===xe.haxTray.trayDetail&&(xe.haxTray.collapsed=!1),xe.haxTray.trayDetail="content-edit",e.abrupt("break",102);case 100:return this.hideContextMenus(),e.abrupt("break",102);case 102:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"_focusIn",value:function(e){this.__mouseDown||this.__focusLogic(e.target)&&(e.stopPropagation(),e.stopImmediatePropagation())}},{key:"__focusLogic",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!1;if(this.editMode&&!this.__tabTrap){var a=e;("SPAN"===a.tagName&&xe.isTextElement(a.parentNode)&&""==a.parentNode.getAttribute("slot")||"LI"===a.tagName&&xe.isTextElement(a.parentNode)&&["UL","OL"].includes(a.parentNode.tagName))&&(a=e.parentNode);var i=null;if(this._validElementTest(a)&&a.parentNode&&a.parentNode.tagName){if("P"===a.parentNode.tagName&&""==a.parentNode.getAttribute("slot"))i=a,o=!0;else{for(;a.parentNode&&a.parentNode.tagName&&"HAX-BODY"!=a.parentNode.tagName;)null===i&&"B"!==a.tagName&&"I"!==a.tagName&&"STRONG"!==a.tagName&&"EM"!==a.tagName&&(i=a),a=a.parentNode;null===i?i=a:xe.isGridPlateElement(a)}(this.activeNode&&this.activeNode.parentNode!==a&&!a.classList.contains("ignore-activation")||a.haxUIElement||a.classList.contains("ignore-activation"))&&(o=!0),i.haxUIElement&&"EDITABLE-TABLE"!==i.tagName||i.classList.contains("ignore-activation")||(xe.activeNode=i,setTimeout((function(){if(n&&!t.__mouseDown&&xe.isTextElement(i))try{var e=document.createRange(),o=xe.getSelection();e.setStart(t.activeNode,0),e.collapse(!0),o.removeAllRanges(),o.addRange(e),t.activeNode.focus()}catch(e){console.warn(e)}t.positionContextMenus(i)}),0),o=!0)}}else this.__tabTrap=!1;return o}},{key:"scrollHere",value:function(e){setTimeout((function(){"function"==typeof e.scrollIntoViewIfNeeded?e.scrollIntoViewIfNeeded(!1):e.scrollIntoView({behavior:"smooth",inline:"center",block:"nearest"})}),0)}},{key:"undo",value:function(){var e=this;ie(K(v.prototype),"undo",this).call(this),setTimeout((function(){var t=e.querySelector("[data-hax-active]");t?(e.__focusLogic(t),e.scrollHere(t)):e.hideContextMenus()}),0)}},{key:"redo",value:function(){var e=this;ie(K(v.prototype),"redo",this).call(this),setTimeout((function(){var t=e.querySelector("[data-hax-active]");t?(e.__focusLogic(t),e.scrollHere(t)):e.hideContextMenus()}),0)}},{key:"_editModeChanged",value:(a=F(q().mark((function e(t,n){var o,a,i,r,s,c,d=this;return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"!==G(n)){if(this._applyContentEditable(t),t)if(this.children&&this.children[0]&&this.children[0].focus&&this.children[0].tagName)"PAGE-BREAK"===this.children[0].tagName&&this.children[1]&&this.children[1].focus?this.__focusLogic(this.children[1]):"PAGE-BREAK"===this.children[0].tagName?this.haxInsert("p","",{}):this.__focusLogic(this.children[0]);else{this.haxInsert("p","",{});try{o=document.createRange(),a=xe.getSelection(),o.setStart(this.activeNode,0),o.collapse(!0),a.removeAllRanges(),a.addRange(o),this.activeNode.focus()}catch(e){console.warn(e)}}else this.activeNode&&(this.unsetSlotEditMode(this.activeNode),this.unsetElementEditMode(this.activeNode));setTimeout((function(){d.undoStack.undoStackLimit=50,d.undoStack.undoStackPosition=-1,d.undoStack.commands=[],d.undoStack.changed(),d.undoStackInitialValue=d.innerHTML,d.undoStackPrevValue=d.undoStackInitialValue}),0)}if(0==t)for(l.unwrap(xe.activeEditingElement),xe.activeEditingElement=null,this.removeAttribute("contenteditable"),this.hideContextMenus(),i=this.querySelectorAll("[contenteditable],[data-hax-active]"),r=0;r<i.length;r++)(s=i[r]).removeAttribute("contenteditable"),s.removeAttribute("data-hax-active");0===(c="slot"===this.shadowRoot.querySelector("#body").localName?this.shadowRoot.querySelector("#body").assignedNodes({flatten:!0}):[]).length&&(c=this.shadowRoot.querySelector("#body").children),r=0;case 5:if(!(r<c.length)){e.next=11;break}return e.next=8,xe.runHook(c[r],"editModeChanged",[t]);case 8:r++,e.next=5;break;case 11:t?(window.addEventListener("hax-context-item-selected",this._haxContextOperation.bind(this)),window.addEventListener("hax-toggle-active-node-lock",this._toggleNodeLocking.bind(this)),window.addEventListener("click",this.scrollerFixclickEvent.bind(this)),window.addEventListener("blur",this.blurEvent.bind(this)),window.addEventListener("keydown",this._onKeyDown.bind(this)),document.body.addEventListener("hax-store-property-updated",this._haxStorePropertyUpdated.bind(this)),window.addEventListener("scroll",this._keepContextVisible.bind(this),{passive:!0}),window.addEventListener("resize",this._keepContextVisible.bind(this),{passive:!0}),this._observer=new MutationObserver((function(e){var t=!1;d.__ignoreActive||d.__dragMoving||d.undoStackIgnore||d.__fakeEndCap||!d.ready||!d.editMode||!d.shadowRoot?d.undoStackIgnore&&e.forEach((function(e){e.addedNodes.length>0&&e.addedNodes.forEach((function(e){d._validElementTest(e)&&setTimeout((function(){d.__applyNodeEditableState(e,d.editMode)}),0)}))})):e.forEach((function(e){if(e.removedNodes.length>0){var n,o=de(e.removedNodes);try{for(o.s();!(n=o.n()).done;){var a=n.value;e.previousSibling&&d.activeNode}}catch(e){o.e(e)}finally{o.f()}}if(e.addedNodes.length>0){var i,r=de(e.addedNodes);try{for(r.s();!(i=r.n()).done;)if(a=i.value,d._validElementTest(a)){if(!d.__delHit&&"BR"===a.tagName&&a.parentElement&&xe.__validGridTags().includes(a.parentElement.tagName.toLowerCase())&&a===a.parentElement.childNodes[a.parentElement.childNodes.length-1]){var s=a.parentElement;if(a.remove(),s.childNodes.length>0){var c=s.childNodes[s.childNodes.length-1];c.textContent+="",xe._positionCursorInNode(c,c.length)}continue}if(d.__delHit=!1,"P"===a.tagName&&a.children.length>0&&"P"===a.children[0].tagName){l.unwrap(a);continue}if("P"===a.tagName&&a.parentElement&&"P"===a.parentElement.tagName){l.unwrap(a.parentElement);continue}if(null!=a.getAttribute("slot")&&a.parentElement===d){a.removeAttribute("slot");continue}if("LI"===a.tagName&&a.children.length>0&&"SPAN"===a.children[0].tagName){d.activeNode!==a.children[0]&&d.activeNode!==a||(xe.activeNode=a),l.unwrap(a.children[0]);continue}if("LI"===a.tagName&&a.parentElement&&!["UL","OL"].includes(a.parentElement.tagName)){l.unwrap(a);continue}if("P"===a.tagName&&a.children.length>0&&["P","LI"].includes(a.children[0].tagName)){l.unwrap(a.children[0]);continue}if(d.__slot&&(a.setAttribute("slot",d.__slot),d.__slot=null),d.__indentTrap)if("SPAN"===a.tagName)a.parentNode===d?d.haxChangeTagName(a,"p",!0):"LI"===a.parentNode.tagName&&(a.parentNode.innerHTML=a.textContent);else if("BR"===a.tagName){a.remove();continue}if(!d.editMode||"true"!=a.getAttribute("contenteditable")&&!0!==a.getAttribute("contenteditable")&&"contenteditable"!=a.getAttribute("contenteditable")||d.__applyNodeEditableState(a,!d.editMode),d.__applyNodeEditableState(a,d.editMode),xe.isGridPlateElement(a))for(var u=a.querySelectorAll("*"),h=0;h<u.length;h++)d._validElementTest(u[h])&&d.__applyNodeEditableState(u[h],d.editMode);if(["H1","H2","H3","H4","H5","H6"].includes(a.tagName)&&null==a.getAttribute("id")&&a.setAttribute("id",l.generateResourceID("header-")),d.___moveLock||t)d.___moveLock=!1;else{if(t=!0,"LI"===a.tagName&&a.parentNode)xe.activeNode=a.parentNode;else if("BR"===a.tagName){var p=xe.getSelection();xe._tmpSelection=p,xe.haxSelectedText=p.toString();var m=xe.getRange();m.collapsed&&"BR"===d.activeNode.tagName&&d.activeNode.parentNode===m.commonAncestorContainer&&""===d.activeNode.innerText&&(xe.activeNode=d.activeNode.parentNode)}else xe.activeNode=a;xe.activeNode.setAttribute("data-hax-active","data-hax-active")}}}catch(e){r.e(e)}finally{r.f()}d.__indentTrap&&setTimeout((function(){d.__indentTrap=!1}),0)}else d.ready&&d.editMode&&xe.ready&&0===e.addedNodes.length&&e.removedNodes.length>0&&d.shadowRoot&&0===d.shadowRoot.querySelector("#body").assignedNodes({flatten:!0}).length&&setTimeout((function(){0===d.shadowRoot.querySelector("#body").assignedNodes({flatten:!0}).length&&d.appendChild(document.createElement("p"))}),100)})),d.__ignoreActive&&(d.__ignoreActive=!1),xe.haxTray.updateMap()})),this._observer.observe(this,{childList:!0,subtree:!0})):(window.removeEventListener("hax-toggle-active-node-lock",this._toggleNodeLocking.bind(this)),window.removeEventListener("click",this.scrollerFixclickEvent.bind(this)),window.removeEventListener("blur",this.blurEvent.bind(this)),window.removeEventListener("keydown",this._onKeyDown.bind(this)),document.body.removeEventListener("hax-store-property-updated",this._haxStorePropertyUpdated.bind(this)),window.removeEventListener("scroll",this._keepContextVisible.bind(this)),window.removeEventListener("resize",this._keepContextVisible.bind(this)),window.removeEventListener("hax-context-item-selected",this._haxContextOperation.bind(this)),this._observer.disconnect());case 12:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"_haxResolvePreviousElement",value:function(e){for(e=e.previousElementSibling;null!=e&&"undefined"!==G(e.tagName)&&"HAX-"===e.tagName.substring(0,4);)e=e.previousElementSibling;return e}},{key:"_validElementTest",value:function(e){return!(e.haxUIElement&&"EDITABLE-TABLE"!==e.tagName||!e.tagName||["TEMPLATE","HAX-BODY","RICH-TEXT-EDITOR-CLIPBOARD","RICH-TEXT-EDITOR-PROMPT","RICH-TEXT-EDITOR-HIGHLIGHT","HAX-APP-SEARCH-RESULT","FAKE-HAX-BODY-END"].includes(e.tagName))&&(!this._HTMLInlineTextDecorationTest(e)||"HAX-BODY"==e.parentNode)}},{key:"_HTMLInlineTextDecorationTest",value:function(e){return["span","b","strong","i","em"].concat(se(Object.keys(window.HaxTextEditorToolbarConfig.inlineGizmos||{}))).includes(e.tagName.toLowerCase())}},{key:"_HTMLPrimativeTest",value:function(e){return null!=e&&"undefined"!==G(e.tagName)&&-1==e.tagName.indexOf("-")}},{key:"_applyContentEditable",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shadowRoot.querySelector("#body"),n="slot"===t.localName?t.assignedNodes({flatten:!0}):[];0===n.length&&(n=t.children);for(var o=0;o<n.length;o++)if(this._validElementTest(n[o])&&(!e||!0!==n[o].getAttribute("contenteditable")&&"true"!=n[o].getAttribute("contenteditable")&&"contenteditable"!=n[o].getAttribute("contenteditable"))&&this.__applyNodeEditableState(n[o],e),xe.isGridPlateElement(n[o]))for(var a=n[o].querySelectorAll("*"),i=0;i<a.length;i++)this._validElementTest(a[i])&&this.__applyNodeEditableState(a[i],e)}},{key:"__layoutDropEvent",value:function(e,t){se(t.querySelectorAll(".active")).forEach((function(e){e.classList.remove("active")})),se(t.shadowRoot.querySelectorAll(".active")).forEach((function(e){e.classList.remove("active")}))}},{key:"__layoutDragEnter",value:function(e){e.target.classList.add("active")}},{key:"__layoutDragLeave",value:function(e){e.target.classList.remove("active")}},{key:"__layoutMonitor",value:function(e){var t=l.normalizeEventPath(e);t[0]&&t[0].assignedNodes&&t[0].assignedNodes().length&&t[0].parentNode&&t[0].parentNode.classList?t[0].parentNode.classList.add("has-nodes"):t[0].parentNode&&t[0].parentNode.classList&&t[0].parentNode.classList.remove("has-nodes")}},{key:"__getLayoutOrder",value:function(e,t){if(!t.shadowRoot)return!1;var n=e.getAttribute("slot"),o=t.shadowRoot.querySelector("[slot=".concat(n,"]"));return se(t.shadowRoot.querySelectorAll("[slot]")).map((function(e){return e.parentNode})).indexOf(o)||-1}},{key:"__layoutCanMove",value:function(e,t,n){if(!t.shadowRoot)return!1;var o=t.shadowRoot.querySelector("[slot=".concat(slot,"]")),a=se(t.shadowRoot.querySelectorAll("[slot]")).map((function(e){return e.parentNode})),i=(a.indexOf(o)||-1)+(n?-1:1);return i>=a[0]&&i<=a[a.length-1]}},{key:"__layoutMove",value:function(e,t,n){if(!t.shadowRoot)return!1;var o=t.shadowRoot.querySelector("[slot=".concat(r,"]")),a=se(t.shadowRoot.querySelectorAll("[slot]")).map((function(e){return e.parentNode})),i=a.indexOf(o)||-1,r=a[i+(n?-1:1)];r&&e.setAttribute("slot",r)}},{key:"__sortLayoutChildren",value:(n=F(q().mark((function e(t){var n,o=this;return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setAttribute("hax-layout-sorting",!0),e.prev=1,n=(n=Array.prototype.reduce.call(t.querySelectorAll("[slot]"),(function(e,t){return e}),[])).sort((function(e,n){return this.__getLayoutOrder(e,t)<this.__getLayoutOrder(n,t)?-1:1})),e.next=6,n.forEach((function(e){e.parentNode===o&&t.appendChild(e)}));case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.warn(e.t0);case 11:t.removeAttribute("hax-layout-sorting");case 12:case"end":return e.stop()}}),e,null,[[1,8]])}))),function(e){return n.apply(this,arguments)})},{key:"__layoutSlotValid",value:function(e,t){return this.__layoutSlots(t).includes(e.getAttribute("slot"))}},{key:"__layoutSlots",value:function(e){return e.shadowRoot?se(e.shadowRoot.querySelectorAll("[slot]")).map((function(e){return e.getAttribute("name")})):[]}},{key:"__applyDragDropState",value:function(e,t){var n=this,o={drop:function(t){return n.__layoutDropEvent.bind(n)(t,e)},dragenter:this.__layoutDragEnter.bind(this),dragleave:this.__layoutDragEnter.bind(this),slotchange:this.__layoutMonitor.bind(this)};if(e.setAttribute("data-hax-layout",!0),xe.isGridPlateElement(e)&&e.setAttribute("data-hax-grid",!0),t&&e.setAttribute("data-hax-ray",t),t&&e.shadowRoot){e.addEventListener("drop",o.drop);var a=se(e.shadowRoot.querySelectorAll("drag-enabled")),i=se(e.shadowRoot.querySelectorAll("slot"));a.forEach((function(e){e.addEventListener("dragenter",o.dragenter),e.addEventListener("dragleave",o.dragleave)})),i.forEach((function(e){return e.addEventListener("slotchange",o.slotchange)})),e.haxLayoutObserver=new MutationObserver((function(t){e.getAttribute("hax-layout-sorting")||(t.forEach((function(t){t.addedNodes.forEach((function(t){t.tagName&&t!==n&&t.parentElement&&"HAX-BODY"!==t.parentElement.tagName&&!n.__layoutSlotValid(t,e)&&n.__layoutSlots(e).length>0&&t.setAttribute("slot",n.__layoutSlots(e)[0])}))})),n.__sortLayoutChildren(e))})),e.haxLayoutObserver.observe(this,{childList:!0})}else if(e.shadowRoot){e.haxLayoutObserver&&e.haxLayoutObserver.disconnect(),this.removeEventListener("drop",o.drop);var r=se(e.shadowRoot.querySelectorAll("drag-enabled")),s=se(e.shadowRoot.querySelectorAll("slot"));r.forEach((function(e){e.removeEventListener("dragenter",o.dragenter),e.removeEventListener("dragleave",o.dragleave)})),s.forEach((function(e){return e.removeEventListener("slotchange",o.slotchange)})),e.removeAttribute("data-hax-ray")}}},{key:"__isLayout",value:function(e){return e&&xe.haxSchemaFromTag(e.tagName)&&"grid"===xe.haxSchemaFromTag(e.tagName).type}},{key:"__applyNodeEditableState",value:function(e){var t,n=this,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e.tagName)return!1;var a=e.tagName.replace("-"," ").toLowerCase(),i=c.toJS(xe.gizmoList).findIndex((function(t){if(t)return t.tag===e.tagName.toLowerCase()}));if(-1!==i&&(a=c.toJS(xe.gizmoList)[i].title),"IMG"==e.tagName&&e.setAttribute("draggable",!1),o?(this.__applyDragDropState(e,a),t="addEventListener"):(this.__applyDragDropState(e,!1),t="removeEventListener"),e[t]("drop",this.dropEvent.bind(this)),e[t]("dragenter",this.dragEnter.bind(this)),e[t]("dragleave",this.dragLeave.bind(this)),e[t]("dragover",(function(e){n.__dragMoving=!0,e.preventDefault()})),this._HTMLPrimativeTest(e)&&(o?e.setAttribute("contenteditable",o):e.removeAttribute("contenteditable"),e.querySelectorAll("a").length>0))for(var r=e.querySelectorAll("a"),s=0,l=r.length;s<l;s++)o?r[s].setAttribute("contenteditable",o):r[s].removeAttribute("contenteditable"),r[s][t]("click",(function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()}))}},{key:"undoManagerStackLogic",value:function(e){this.__dragMoving||(this.querySelectorAll(".hax-hovered").forEach((function(e){e.classList.remove("hax-hovered")})),ie(K(v.prototype),"undoManagerStackLogic",this).call(this,e))}},{key:"dropEvent",value:function(e){if(this.editMode){this.__dragMoving=!1,this.undoManagerStackLogic({}),clearTimeout(mt),xe._lockContextPosition=!1,xe.haxTray.activeTab="item-1";var t,n=null,o=l.normalizeEventPath(e);if(null!==(n=e.target.closest("[data-hax-layout]")&&e.target.parentNode!=e.target.closest("[data-hax-layout]")?e.target.closest("[data-hax-layout]"):e.target.closest("[contenteditable],img")?e.target.closest("[contenteditable],img"):e.originalTarget?e.originalTarget:e.target).getAttribute("data-hax-lock"))return!1;o[0].classList.contains("column")?this.__slot=o[0].getAttribute("id").replace("col","col-"):n.getAttribute("slot")&&(this.__slot=n.getAttribute("slot")),this.querySelectorAll(".hax-hovered").forEach((function(e){e.classList.remove("hax-hovered")})),this.querySelectorAll(".active").forEach((function(e){e.classList.remove("active")})),xe.activeNode=n;try{if(null===xe.__dragTarget&&e.dataTransfer&&e.dataTransfer.items&&e.dataTransfer.items.length>0&&"file"===e.dataTransfer.items[0].kind){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation();var a=document.createElement("p");e.target.closest("[data-hax-layout]")&&e.target.parentNode!=e.target.closest("[data-hax-layout]")?t=e.target.closest("[data-hax-layout]"):e.target.closest("[contenteditable],img")&&(t=e.target.closest("[contenteditable],img")),t&&(t.tagName&&"HAX-BODY"!==t.tagName||!t.getAttribute("data-hax-layout"))||this.__isLayout(o[0])?(t.getAttribute("slot")?a.setAttribute("slot",t.getAttribute("slot")):o[0].classList.contains("column")?a.setAttribute("slot",o[0].getAttribute("id").replace("col","col-")):a.removeAttribute("slot"),t.parentNode.insertBefore(a,t)):(o[0].classList.contains("column")?a.setAttribute("slot",o[0].getAttribute("id").replace("col","col-")):t&&"HAX-BODY"===t.tagName&&a.getAttribute("slot")&&a.removeAttribute("slot"),t?t.appendChild(a):this.appendChild(a)),e.placeHolderElement=a,this.dispatchEvent(new CustomEvent("place-holder-file-drop",{bubbles:!0,cancelable:!0,composed:!0,detail:e}))}else{if(n=xe.__dragTarget,t=e.target,e.target.closest("[data-hax-layout]")&&e.target.parentNode!=e.target.closest("[data-hax-layout]")?t=e.target.closest("[data-hax-layout]"):e.target.closest("[contenteditable],img")&&(t=e.target.closest("[contenteditable],img")),t&&n&&this._validElementTest(n)&&n!==t){try{"HAX-BODY"!==t.tagName&&!this.__isLayout(t)||this.__isLayout(o[0])?(t.getAttribute("slot")?n.setAttribute("slot",t.getAttribute("slot")):o[0].classList.contains("column")?n.setAttribute("slot",o[0].getAttribute("id").replace("col","col-")):n.removeAttribute("slot"),t.parentNode.insertBefore(n,t)):(o[0].classList.contains("column")?n.setAttribute("slot",o[0].getAttribute("id").replace("col","col-")):"HAX-BODY"===t.tagName&&n.getAttribute("slot")&&n.removeAttribute("slot"),t.appendChild(n))}catch(e){console.warn(e)}e.preventDefault(),e.stopPropagation()}n&&this._validElementTest(n)&&"function"==typeof n.focus&&(xe.activeNode=n,xe.testHook(xe.activeNode,"trayDragNDropToNode")&&xe.runHook(xe.activeNode,"trayDragNDropToNode",[xe.activeNode]),this.dispatchEvent(new CustomEvent("hax-drop-focus-event",{bubbles:!0,cancelable:!0,composed:!0,detail:this.activeNode})),this.scrollHere(this.activeNode),this.positionContextMenus())}}catch(e){console.warn(e)}}xe.__dragTarget=null,this.__manageFakeEndCap(!1)}},{key:"dragEnter",value:function(e){this.editMode&&e.target&&xe.__dragTarget&&(this.__dragMoving=!0,e.preventDefault(),e.target&&e.target.classList&&e.target.classList.add("hax-hovered"),this.handleMousemove(e))}},{key:"handleMousemove",value:function(e){var t=e.clientX,n=e.clientY,o=document.documentElement.clientWidth,a=document.documentElement.clientHeight,i=a-vt,r=o-vt,s=t<200,l=t>r,c=n<200,d=n>i;if(s||l||c||d){var u=Math.max(document.body.scrollWidth,document.body.offsetWidth,document.body.clientWidth,document.documentElement.scrollWidth,document.documentElement.offsetWidth,document.documentElement.clientWidth),h=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.body.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight,document.documentElement.clientHeight),p=u-o,m=h-a;!function e(){clearTimeout(mt),function(){var e=window.pageXOffset,o=window.pageYOffset,a=o>0,u=o<m,h=e>0,g=e<p,v=e,b=o;if(s&&h){v-=gt*((200-t)/vt)}else if(l&&g){v+=gt*((t-r)/vt)}if(c&&a){b-=gt*((200-n)/vt)}else if(d&&u){b+=gt*((n-i)/vt)}return v=Math.max(0,Math.min(p,v)),b=Math.max(0,Math.min(m,b)),(v!==e||b!==o)&&(window.scrollTo(v,b),!0)}()&&(mt=setTimeout(e,30))}()}else clearTimeout(mt)}},{key:"dragLeave",value:function(e){this.editMode&&e.target&&e.target.classList&&(this.__dragMoving=!0,e.target.classList.remove("hax-hovered"))}},{key:"toggleElementEditMode",value:function(e,t){e[t]?this.unsetElementEditMode(e,t):this.setElementEditMode(e,t)}},{key:"unsetElementEditMode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeNode;if(e&&e.getAttribute){var t=e.getAttribute("data-element-edit-mode")||"editMode";e[t]=!1,this.__applyNodeEditableState(e,this.editMode),xe.activeEditingElement=null,this.editElementToggled=!1,this.__ignoreActive=!1}}},{key:"setElementEditMode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"editMode";e.setAttribute("data-element-edit-mode",t),e[t]=!0,xe.activeEditingElement=e,this.editElementToggled=!1,this.__ignoreActive=!0,this.activeNode.removeAttribute("contenteditable"),this.activeNode.removeAttribute("data-hax-active"),this.__applyDragDropState(this.activeNode,!1),xe.activeEditingElement.focus()}},{key:"unsetSlotEditMode",value:function(e){if(e.getAttribute&&e.getAttribute){var t=e.getAttribute("data-grid-saved-settings")?JSON.parse(e.getAttribute("data-grid-saved-settings")):void 0;Object.keys(t||{}).forEach((function(n){return e[n]=t[n]})),e.removeAttribute("data-grid-saved-settings")}}},{key:"setSlotEditMode",value:function(e,t,n){var o=e.getAttribute("data-grid-saved-settings")?JSON.parse(e.getAttribute("data-grid-saved-settings")):{},a=Object.keys(o);Object.keys(t||{}).forEach((function(n){a.includes(n)||(o[n]=e[n]),e[n]=t[n]})),e.setAttribute("data-grid-saved-settings",JSON.stringify(o))}},{key:"_activeNodeChanged",value:(t=F(q().mark((function e(t,n){var o,a,i,r,s,c;return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.SimplePopoverManager.requestAvailability().opened=!1,this.contextMenus.plate.disableDuplicate=!1,this.contextMenus.plate.disableOps=!1,this.contextMenus.plate.disableItemOps=!1,this.contextMenus.plate.canMoveElement=this.canMoveElement,n&&n.removeAttribute("data-hax-active"),t&&t.setAttribute("data-hax-active","data-hax-active"),t&&n&&xe.isGridPlateElement(t)&&(this.__ignoreActive=!0),this.editMode&&"undefined"!==G(t)&&null!==t&&t.parentNode&&t.tagName?(o=t.tagName.toLowerCase(),(xe.isTextElement(t)||"HR"===t.tagName||xe.isGridPlateElement(t))&&null===t.getAttribute("data-hax-lock")&&null===t.parentNode.getAttribute("data-hax-lock")?(t.setAttribute("contenteditable",!0),this.setAttribute("contenteditable",!0)):(t.removeAttribute("contenteditable"),this.removeAttribute("contenteditable")),this._keepContextVisible(),this.contextMenus.text.realSelectedValue=o):null===t&&(this.hideContextMenus(),this.__oldActiveNode=n),e.t0=this.editMode,!e.t0){e.next=14;break}return e.next=13,xe.runHook(n,"activeElementChanged",[n,!1]);case 13:e.t0=e.sent;case 14:if(!e.t0){e.next=16;break}this.__ignoreActive=!0;case 16:if(e.t1=this.editMode,!e.t1){e.next=21;break}return e.next=20,xe.runHook(t,"activeElementChanged",[t,!0]);case 20:e.t1=e.sent;case 21:if(!e.t1){e.next=23;break}this.__ignoreActive=!0;case 23:if(!(this.editMode&&n&&n.tagName)){e.next=33;break}if(!("core"!=(a=xe.haxSchemaFromTag(n.tagName.toLowerCase())).editingElement||n.parentNode&&n.parentNode.haxUIElement&&n.parentNode===xe.activeEditingElement)){e.next=33;break}return this.__ignoreActive=!0,e.next=29,xe.runHook(n.parentNode,"activeElementChanged",[n,!1]);case 29:if((i=e.sent)&&i!==n){if(n&&n.getAttribute&&null!=n.getAttribute("slot")&&i.setAttribute("slot",n.getAttribute("slot")),a.saveOptions&&a.saveOptions.unsetAttributes&&a.saveOptions.unsetAttributes.length)for(r in a.saveOptions.unsetAttributes)i.removeAttribute(a.saveOptions.unsetAttributes[r]);this.__applyNodeEditableState(i,this.editMode)}l.unwrap(xe.activeEditingElement),xe.activeEditingElement=null;case 33:if(!this.editMode||!t){e.next=48;break}if(!(s=xe.haxSchemaFromTag(t.tagName))||!s.editingElement||"core"==s.editingElement){e.next=48;break}if(!s.editingElement.import){e.next=41;break}return c=new URL("./../../","undefined"==typeof document&&"undefined"==typeof location?new(require("url").URL)("file:"+__filename).href:"undefined"==typeof document?location.href:document.currentScript&&document.currentScript.src||new URL("hax-body.umd.js",document.baseURI).href).href,window.WCGlobalBasePath&&(c=window.WCGlobalBasePath),e.next=41,import("".concat(c).concat(s.editingElement.import));case 41:return xe.activeEditingElement=document.createElement(s.editingElement.tag),t.getAttribute&&null!=t.getAttribute("slot")&&xe.activeEditingElement.setAttribute("slot",t.getAttribute("slot")),s.editingElement.callback&&s.editingElement.callback(xe.activeEditingElement),this.__ignoreActive=!0,l.wrap(t,xe.activeEditingElement),e.next=48,xe.runHook(xe.activeEditingElement,"activeElementChanged",[t,!0]);case 48:!n||!n.parentNode||t&&t.parentNode&&t.parentNode===n.parentNode||this.unsetSlotEditMode(n.parentNode),this.unsetElementEditMode(n);case 50:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"_getPosition",value:function(e){return{x:e.offsetLeft-e.scrollLeft+e.clientLeft,y:e.offsetTop-e.scrollTop+e.clientTop}}},{key:"_showContextMenu",value:function(e){e.setAttribute("on-screen","on-screen"),e.classList.add("hax-context-visible","hax-context-menu-active")}},{key:"_getContextContainer",value:function(e){var t=e&&e.parentNode?e.parentNode:void 0;return t&&t.nodeType?1==t.nodeType?t:t.host:void 0}},{key:"_hideContextMenu",value:function(e){e&&(e.removeAttribute("on-screen"),e.classList.remove("hax-context-visible"),e.classList.remove("hax-context-menu-active"))}},{key:"_tabKeyPressed",value:function(){if(this.activeNode&&xe.getRange().cloneRange)try{var e=!1,t=this.activeNode.parentNode,n=this.activeNode.parentNode.tagName,o=xe.getRange().cloneRange(),a=o.commonAncestorContainer.tagName;if("undefined"===G(a)&&(a=o.commonAncestorContainer.parentNode.tagName),["UL","OL","LI"].includes(n)||["UL","OL","LI"].includes(a))this.polyfillSafe&&(this.__tabTrap=!0,this.__indentTrap=!0,document.execCommand("indent"));else for(;!e;)null==t.nextSibling?e=!0:"function"===t.nextSibling.focus?(t.nextSibling.focus(),e=!0):t=t.nextSibling}catch(e){console.warn(e)}}},{key:"_tabBackKeyPressed",value:function(){if(this.activeNode&&xe.getRange().cloneRange)try{var e=this.activeNode.parentNode,t=this.activeNode.parentNode.tagName,n=xe.getRange().cloneRange(),o=n.commonAncestorContainer.tagName;if("undefined"===G(o)&&(o=n.commonAncestorContainer.parentNode.tagName),["UL","OL","LI"].includes(t)||["UL","OL","LI"].includes(o))this.polyfillSafe&&(this.__tabTrap=!0,this.__indentTrap=!0,document.execCommand("outdent"));else{if(null!=e)for(;null!=e&&!this._validElementTest(e);)e=e.previousSibling;null!=e&&setTimeout((function(){e.focus()}),50)}}catch(e){console.warn(e)}}}],[{key:"tag",get:function(){return"hax-body"}},{key:"styles",get:function(){return[].concat(se(ie(K(v),"styles",this)),[o.css(ht||(ht=re(['\n        :host([edit-mode]),\n        :host([edit-mode]) * ::slotted(*) {\n          caret-color: var(--hax-ui-caret-color, auto);\n          line-height: 1.8;\n        }\n        :host([edit-mode]) ul,\n        :host([edit-mode]) ol {\n          padding-left: 20px;\n          margin-left: 20px;\n        }\n        :host([edit-mode]) ul {\n          list-style-type: disc;\n        }\n        :host([edit-mode]) code {\n          padding: 0.2em 0.4em;\n          margin: 0;\n          font-size: 12px;\n          background-color: var(\n            --hax-base-styles-code-background-color,\n            rgba(175, 184, 193, 0.2)\n          );\n          border-radius: 6px;\n          font-family: var(\n            --hax-base-styles-code-font-family,\n            ui-monospace,\n            monospace\n          );\n        }\n        :host([edit-mode]) pre {\n          padding: 16px;\n          overflow: auto;\n          line-height: 1.45;\n          background-color: var(\n            --hax-base-styles-pre-background-color,\n            rgba(175, 184, 193, 0.2)\n          );\n          border-radius: 6px;\n          margin-bottom: 0;\n          word-break: normal;\n          word-wrap: normal;\n          margin-top: 0;\n          font-family: var(\n            --hax-base-styles-pre-font-family,\n            ui-monospace,\n            monospace\n          );\n          font-size: 12px;\n        }\n        :host([edit-mode]) li {\n          margin-bottom: 6px;\n        }\n        :host([edit-mode][tray-status="full-panel"]) {\n          opacity: 0.2;\n          pointer-events: none;\n        }\n        :host {\n          display: block;\n          position: relative;\n          min-height: 32px;\n          min-width: 32px;\n          outline: none;\n          --hax-contextual-action-text-color: var(--hax-ui-background-color);\n          --hax-contextual-action-hover-color: var(--hax-ui-color-accent);\n          --hax-contextual-action-color: var(--hax-ui-color-accent-secondary);\n          --hax-body-editable-outline: 1px solid\n            var(--hax-ui-disabled-color, #ddd);\n          --hax-body-active-outline-hover: 2px solid\n            var(--hax-ui-color-faded, #444);\n          --hax-body-active-outline: 2px solid var(--hax-ui-color-focus, #000);\n          --hax-body-active-drag-outline: 1px solid\n            var(--hax-ui-color-accent, #009dc7);\n          --hax-body-target-background-color: var(\n            --hax-ui-background-color-accent\n          );\n          --hax-body-possible-target-background-color: inherit;\n        }\n        #topcontext {\n          z-index: calc(var(--hax-ui-focus-z-index) - 2);\n          min-width: 280px;\n        }\n        #topcontextmenu {\n          width: auto;\n          max-width: 100%;\n          position: absolute;\n          bottom: 0;\n          margin-bottom: 10px;\n          margin-left: -10px;\n        }\n        .hax-context-menu {\n          visibility: hidden;\n          opacity: 0;\n          z-index: -1;\n          pointer-events: none;\n          transition: 0.3s all ease-in-out;\n        }\n        .hax-context-menu:hover {\n          z-index: calc(var(--hax-ui-focus-z-index) + 1);\n        }\n        .hax-context-visible,\n        .hax-context-menu-active {\n          display: flex;\n          pointer-events: auto;\n          visibility: visible;\n          z-index: 1;\n          opacity: 1;\n        }\n        /* this helps ensure editable-table doesn\'t try internal text editor; all others should */\n        :host([edit-mode])\n          #bodycontainer\n          ::slotted(*[contenteditable]:not(editable-table)) {\n          -webkit-appearance: textfield;\n          cursor: text;\n          -moz-user-select: text;\n          -khtml-user-select: text;\n          -webkit-user-select: text;\n          -o-user-select: text;\n        }\n        :host([edit-mode])\n          #bodycontainer\n          ::slotted([contenteditable][data-hax-ray]:empty)::before {\n          content: attr(data-hax-ray);\n          opacity: 0.2;\n          transition: 0.2s all ease-in-out;\n        }\n\n        :host([edit-mode])\n          #bodycontainer\n          ::slotted([contenteditable][data-hax-ray]:hover:empty)::before {\n          opacity: 0.4;\n          cursor: text;\n        }\n\n        :host([edit-mode])\n          #bodycontainer\n          ::slotted([contenteditable][data-hax-ray]:empty:focus)::before {\n          content: "";\n        }\n        :host([edit-mode]) #bodycontainer ::slotted(p) {\n          min-height: var(--hax-base-styles-p-min-height, 1rem);\n          font-size: var(--hax-base-styles-p-font-size);\n          line-height: var(--hax-base-styles-p-line-height);\n          letter-spacing: var(--hax-base-styles-p-letter-spacing);\n        }\n        :host([edit-mode]) #bodycontainer ::slotted(a) {\n          color: var(--hax-base-styles-a-color);\n          font-size: var(\n            --hax-base-styles-a-font-size,\n            var(--hax-base-styles-p-font-size)\n          );\n          font-weight: var(--hax-base-styles-a-font-weight);\n        }\n        :host([edit-mode]) #bodycontainer ::slotted(a:visited) {\n          color: var(--hax-base-styles-a-color-visited);\n        }\n        :host([edit-mode]) #bodycontainer ::slotted(a:active),\n        :host([edit-mode]) #bodycontainer ::slotted(a:focus),\n        :host([edit-mode]) #bodycontainer ::slotted(a:hover) {\n          color: var(--hax-base-styles-a-color-active);\n          font-weight: var(--hax-base-styles-a-font-weight-active);\n        }\n        :host([edit-mode]) #bodycontainer ::slotted(ol),\n        :host([edit-mode]) #bodycontainer ::slotted(ul),\n        :host([edit-mode]) #bodycontainer ::slotted(li) {\n          padding-bottom: var(--hax-base-styles-list-padding-bottom);\n          line-height: var(\n            --hax-base-styles-list-line-height,\n            var(--hax-base-styles-p-line-height)\n          );\n          font-size: var(\n            --hax-base-styles-list-font-size,\n            var(--hax-base-styles-p-font-size)\n          );\n        }\n        :host([edit-mode]) #bodycontainer ::slotted([data-hax-active]),\n        :host([edit-mode]) #bodycontainer ::slotted(*.hax-hovered) {\n          outline-offset: 8px;\n        }\n        :host([edit-mode]) #bodycontainer ::slotted(ol > li:last-child),\n        :host([edit-mode]) #bodycontainer ::slotted(ul > li:last-child) {\n          padding-bottom: var(--hax-base-styles-list-last-child-padding-bottom);\n        }\n        :host([edit-mode]) #bodycontainer ::slotted(img[contenteditable]) {\n          max-width: 100%;\n        }\n        :host([edit-mode]) #bodycontainer ::slotted(*[contenteditable]) {\n          caret-color: var(--hax-ui-caret-color, auto);\n        }\n        :host([edit-mode]) #bodycontainer ::slotted(*.blinkfocus) {\n          outline: 2px solid var(--hax-contextual-action-hover-color);\n        }\n        :host([edit-mode]) #bodycontainer ::slotted(*[data-hax-lock]) {\n          opacity: 0.5;\n          transition: 0.2s all ease-in-out;\n        }\n        :host([edit-mode]) #bodycontainer ::slotted(*[data-hax-lock]:hover) {\n          opacity: 0.9;\n        }\n        :host([edit-mode]) #bodycontainer ::slotted(*[data-hax-lock])::after {\n          width: 28px;\n          height: 28px;\n          content: "";\n          display: flex;\n          float: right;\n          z-index: 1;\n          position: relative;\n          background-position: center;\n          background-repeat: no-repeat;\n          background-color: #fffafa;\n        }\n        :host([edit-mode])\n          #bodycontainer\n          ::slotted(*:not([data-hax-layout]):hover) {\n          outline: var(--hax-body-active-outline-hover);\n          caret-color: var(--hax-ui-caret-color, auto);\n        }\n        :host(.hax-add-content-visible[edit-mode])\n          #bodycontainer\n          ::slotted([data-hax-active]) {\n          margin-bottom: 30px;\n        }\n        :host([edit-mode]) #bodycontainer ::slotted([data-hax-active]:hover) {\n          cursor: text !important;\n          caret-color: var(--hax-ui-caret-color, auto);\n          outline: var(--hax-body-active-outline-hover);\n        }\n        :host([edit-mode])\n          #bodycontainer\n          ::slotted(*:not([data-hax-layout]) [data-hax-active]:hover) {\n          cursor: text !important;\n          caret-color: var(--hax-ui-caret-color, auto);\n          outline: var(--hax-body-active-outline-hover);\n        }\n        :host([edit-mode])\n          #bodycontainer\n          ::slotted(code[data-hax-active][contenteditable]) {\n          display: block;\n        }\n        :host([edit-mode])\n          #bodycontainer\n          ::slotted([data-hax-active][contenteditable]) {\n          outline: var(--hax-body-active-outline) !important;\n          caret-color: var(--hax-ui-caret-color, auto);\n        }\n        :host([edit-mode]) #bodycontainer ::slotted(hr[contenteditable]) {\n          height: 2px;\n          background-color: #eeeeee;\n          padding-top: 4px;\n          padding-bottom: 4px;\n        }\n        /** Fix to support safari as it defaults to none */\n        :host([edit-mode]) #bodycontainer ::slotted(*[contenteditable]) {\n          -webkit-user-select: text;\n          cursor: pointer;\n        }\n\n        :host([edit-mode])\n          #bodycontainer\n          ::slotted(*[contenteditable]::-moz-selection),\n        :host([edit-mode])\n          #bodycontainer\n          ::slotted(*[contenteditable] *::-moz-selection) {\n          background-color: var(--hax-body-highlight, #ffffac);\n          color: black;\n        }\n        :host([edit-mode])\n          #bodycontainer\n          ::slotted(*[contenteditable]::selection),\n        :host([edit-mode])\n          #bodycontainer\n          ::slotted(*[contenteditable] *::selection) {\n          background-color: var(--hax-body-highlight, #ffffac);\n          color: black;\n        }\n        #bodycontainer {\n          -webkit-user-select: text;\n          user-select: text;\n        }\n        absolute-position-behavior:not(:defined),\n        .hax-context-menu:not(:defined) {\n          display: none;\n        }\n        /* drag and drop */\n        :host([edit-mode][hax-mover]) #bodycontainer ::slotted(*)::before {\n          background-color: var(--hax-body-possible-target-background-color);\n          content: " ";\n          width: 100%;\n          display: block;\n          position: relative;\n          margin: -12px 0 0 0;\n          z-index: 2;\n          height: 12px;\n          transition: 0.2s all ease-in-out;\n        }\n        :host([edit-mode][hax-mover]) #bodycontainer ::slotted(img) {\n          outline: var(--hax-body-editable-outline);\n        }\n        :host([edit-mode]) #bodycontainer ::slotted(img.hax-hovered),\n        :host([edit-mode]) #bodycontainer ::slotted(*.hax-hovered)::before {\n          background-color: var(--hax-body-target-background-color) !important;\n        }\n        :host([edit-mode]) #bodycontainer ::slotted(img.hax-hovered) {\n          border-top: 8px\n            var(--hax-contextual-action-hover-color, var(--hax-ui-color-accent));\n          margin-top: -8px;\n        }\n        [hidden],\n        :host([hidden]),\n        #textcontextmenu.not-text {\n          display: none !important;\n        }\n        /** This is mobile layout for controls */\n        @media screen and (max-width: 800px) {\n          .hax-context-menu {\n            height: 0px;\n          }\n          .hax-context-visible {\n            height: auto;\n          }\n          :host(:not([tray-status="collapsed"])) {\n            /*z-index: -1; */\n          }\n          :host([edit-mode]) #bodycontainer,\n          :host([edit-mode]) #bodycontainer[element-align="left"],\n          :host([edit-mode]) #bodycontainer[element-align="right"] {\n            margin: calc(100px + var(--hax-tray-menubar-min-height)) 0 0 0;\n          }\n        }\n\n        @media screen and (min-color-index: 0) and(-webkit-min-device-pixel-ratio:0) {\n          /*\n            Define here the CSS styles applied only to Safari browsers\n            (any version and any device) via https://solvit.io/bcf61b6\n          */\n          :host([edit-mode][hax-mover]) #bodycontainer ::slotted(*) {\n            outline: var(--hax-body-editable-outline);\n            background-color: var(--hax-body-possible-target-background-color);\n          }\n          :host([edit-mode]) #bodycontainer ::slotted(*.hax-hovered) {\n            background-color: var(\n              --hax-body-target-background-color\n            ) !important;\n            outline: var(--hax-body-active-outline);\n          }\n        }\n      '])))])}},{key:"properties",get:function(){return I(I({},ie(K(v),"properties",this)),{},{allowLinkTarget:{type:Boolean},_useristyping:{type:Boolean},haxMover:{type:Boolean,attribute:"hax-mover",reflect:!0},editMode:{type:Boolean,reflect:!0,attribute:"edit-mode"},elementAlign:{type:String,reflect:!0,attribute:"element-align"},trayDetail:{type:String,reflect:!0,attribute:"tray-detail"},trayStatus:{type:String,reflect:!0,attribute:"tray-status"},activeNode:{type:Object},canMoveElement:{type:Boolean},viewSourceToggle:{type:Boolean,reflect:!0}})}}]),v}(u.I18NMixin(i.UndoManagerBehaviors(a.SimpleColors)));customElements.define(bt.tag,bt),e.HaxBody=bt,Object.defineProperty(e,"__esModule",{value:!0})}));
