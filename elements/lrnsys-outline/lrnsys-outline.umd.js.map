{"version":3,"file":"lrnsys-outline.umd.js","sources":["lrnsys-outline.umd.js"],"sourcesContent":["/**\n * Copyright 2018 The Pennsylvania State University\n * @license Apache-2.0, see License.md for full text.\n */\nimport { html, PolymerElement } from \"@polymer/polymer/polymer-element.js\";\nimport { afterNextRender } from \"@polymer/polymer/lib/utils/render-status.js\";\nimport * as async from \"@polymer/polymer/lib/utils/async.js\";\nimport \"@lrnwebcomponents/simple-modal/simple-modal.js\";\n/**\n * `lrnsys-outline`\n * @element lrnsys-outline\n * `Outline that items can be shuffled around in`\n *\n * @demo demo/index.html\n * @microcopy - the mental model for this element\n *  -\n */\nclass LrnsysOutline extends PolymerElement {\n  constructor() {\n    super();\n    import(\"@polymer/paper-input/paper-input.js\");\n    import(\"@polymer/paper-icon-button/paper-icon-button.js\");\n    import(\"@polymer/paper-button/paper-button.js\");\n    import(\"@lrnwebcomponents/lrnsys-outline/lib/lrnsys-outline-item.js\");\n  }\n  static get template() {\n    return html`\n      <style>\n        :host {\n          display: block;\n        }\n        :host kbd {\n          display: inline-block;\n          background: #333;\n          color: white;\n          border-radius: 4px;\n          margin: 4px 4px 4px 0;\n          padding: 8px;\n          font-family: Verdana, Geneva, Tahoma, sans-serif;\n          font-size: 85%;\n        }\n      </style>\n      <div id=\"itemslist\">\n        <template is=\"dom-repeat\" items=\"{{items}}\" as=\"item\">\n          <lrnsys-outline-item\n            disable-down=\"[[item.disableDown]]\"\n            disable-left=\"[[item.disableLeft]]\"\n            disable-right=\"[[item.disableRight]]\"\n            disable-up=\"[[item.disableUp]]\"\n            id$=\"[[item.id]]\"\n            index$=\"[[item.index]]\"\n            indent-level=\"{{item.indent}}\"\n            parent=\"{{item.parent}}\"\n            title=\"{{item.title}}\"\n          >\n          </lrnsys-outline-item>\n        </template>\n      </div>\n    `;\n  }\n  static get tag() {\n    return \"lrnsys-outline\";\n  }\n  static get properties() {\n    return {\n      data: {\n        type: Array,\n        value: null\n      },\n      items: {\n        type: Array,\n        value: null,\n        notify: true\n      },\n      activeItem: {\n        type: Object,\n        notify: true\n      }\n    };\n  }\n  /**\n   * Attached lifecycle\n   */\n  connectedCallback() {\n    super.connectedCallback();\n    window.SimpleModal.requestAvailability();\n    // fix stack order\n    afterNextRender(this, function() {\n      this.addEventListener(\"delete-item\", this._handleRemoveItem.bind(this));\n      this.addEventListener(\"indent-item\", this._handleIndentItem.bind(this));\n      this.addEventListener(\"add-item\", this._handleAddItem.bind(this));\n      this.addEventListener(\"move-item\", this._handleMoveItem.bind(this));\n      this.addEventListener(\"change-item\", this._handleChangeItem.bind(this));\n      this.addEventListener(\"focus-item\", this._handleFocusItem.bind(this));\n      this.addEventListener(\"blur-item\", this._handleBlurItem.bind(this));\n    });\n  }\n  disconnectedCallback() {\n    this.removeEventListener(\"delete-item\", this._handleRemoveItem.bind(this));\n    this.removeEventListener(\"indent-item\", this._handleIndentItem.bind(this));\n    this.removeEventListener(\"add-item\", this._handleAddItem.bind(this));\n    this.removeEventListener(\"move-item\", this._handleMoveItem.bind(this));\n    this.removeEventListener(\"change-item\", this._handleChangeItem.bind(this));\n    this.removeEventListener(\"focus-item\", this._handleFocusItem.bind(this));\n    this.removeEventListener(\"blur-item\", this._handleBlurItem.bind(this));\n    super.disconnectedCallback();\n  }\n  ready() {\n    super.ready();\n    if (this.data === null || this.data.length < 1) {\n      this.__tempid = this.__tempid === undefined ? 0 : this.__tempid + 1;\n      this.data = [\n        {\n          id: \"outline-item-\" + this.__tempid,\n          title: \"\",\n          order: 0,\n          parent: null\n        }\n      ];\n    }\n    this.setData(this.data);\n  }\n  /**\n   * gets a nested array of items to convert & updates the dom-repeat\n   */\n  setData(data) {\n    if (data !== undefined && data.length > 0) {\n      let prevIndent = -1;\n      for (var i in data) {\n        let indent = parseInt(this._getIndent(data, i));\n        this.__tempid = this.__tempid === undefined ? 0 : this.__tempid + 1;\n        data[i].index = parseInt(i);\n        data[i].indent = indent;\n        data[i].prevSibling = this._getSibling(parseInt(i), indent, true);\n        data[i].nextSibling = this._getSibling(parseInt(i), indent, false);\n        data[i].disableUp = data[i].prevSibling === null;\n        data[i].disableDown = data[i].nextSibling === null;\n        data[i].disableLeft = indent === 0;\n        data[i].disableRight = indent > prevIndent;\n        data[i].id =\n          data[i].id === undefined\n            ? \"outline-item-\" + this.__tempid\n            : data[i].id;\n        prevIndent = indent;\n      }\n    }\n    this.set(\"items\", []);\n    this.set(\"items\", data);\n  }\n  /**\n   * gets a flat array of items to convert & updates it to a nested array\n   */\n  getData() {\n    for (var i in this.items) {\n      this.items[i].order = this._getOrder(this.items[i]);\n      this.notifyPath(`items.${i}.order`);\n    }\n    return this.items;\n  }\n  /**\n   * adds a new item\n   */\n  addItem(detail) {\n    let item = detail.item;\n    let title = detail.new;\n    let spliceIndex = this.items.findIndex(j => j.id === item.id) + 1;\n    this.__tempid = this.__tempid + 1;\n    this.splice(\"items\", spliceIndex, 0, {\n      id: \"outline-item-\" + this.__tempid,\n      title: title,\n      indent: item.indent,\n      parent: item.parent\n    });\n    this.items[spliceIndex].indentLevel = item.indent;\n    this.notifyPath(`items.${spliceIndex}.indentLevel`);\n    this.setData(this.items);\n    if (this.__focusedItem !== undefined && this.__focusedItem !== null) {\n      async.microTask.run(() => {\n        setTimeout(() => {\n          this.__focusedItem = item.nextElementSibling;\n          this.__focusedItem.focus();\n        }, 50);\n      });\n    }\n  }\n  /**\n   * removes an item\n   */\n  removeItem(item) {\n    let i = this.items.findIndex(j => j.id === item.id);\n    let b = document.createElement(\"paper-button\");\n    b.raised = true;\n    b.addEventListener(\"click\", this._deleteItemConfirm.bind(this));\n    b.appendChild(document.createTextNode(\"Yes, delete\"));\n    const evt = new CustomEvent(\"simple-modal-show\", {\n      bubbles: true,\n      cancelable: true,\n      detail: {\n        title: `Do you really want to delete ${this.items[i].title}?`,\n        elements: {\n          buttons: b\n        },\n        invokedBy: item.shadowRoot.querySelector(\"#delete\"),\n        clone: false\n      }\n    });\n    this.dispatchEvent(evt);\n  }\n  /**\n   * Delete item confirmation\n   */\n  _deleteItemConfirm(e) {\n    let i = this.items.findIndex(j => j.id === this.activeItem.id);\n    this.activeItem.classList.add(\"collapse-to-remove\");\n    const evt = new CustomEvent(\"simple-modal-hide\", {\n      bubbles: true,\n      cancelable: true,\n      detail: {}\n    });\n    this.dispatchEvent(evt);\n    setTimeout(() => {\n      this.__focusedItem = this.activeItem.previousElementSibling;\n      for (var k in this.items) {\n        if (this.items[k].parent == this.items[i].id) {\n          this.items[k].parent = this.items[i].parent;\n        }\n      }\n      this.activeItem.classList.remove(\"collapse-to-remove\");\n      this.splice(\"items\", i, 1);\n      if (this.__focusedItem !== undefined && this.__focusedItem !== null) {\n        async.microTask.run(() => {\n          setTimeout(() => {\n            this.__focusedItem.focus();\n          }, 50);\n        });\n      }\n    }, 300);\n  }\n  /**\n   * moves an grop of items down\n   */\n  moveItem(item, moveUp) {\n    let sourceStart = item.index,\n      sourceEnd = this._getLastChild(item),\n      sourceCount = sourceEnd - sourceStart + 1;\n    let target = moveUp\n      ? this.items[sourceStart].prevSibling\n      : this._getLastChild(this.items[sourceEnd + 1]) - sourceCount + 1;\n    if (target > -1 && target < this.items.length) {\n      if ((moveUp && !item.disableUp) || (!moveUp && !item.disableDown)) {\n        let item2 = this.splice(\"items\", sourceStart, sourceCount);\n        this.splice(\"items\", target, 0, item2);\n        this.__focusedItem = this.shadowRoot\n          .querySelector(\"#itemslist\")\n          .querySelectorAll(\"lrnsys-outline-item\")[target];\n        this.setData(this.items);\n        if (this.__focusedItem !== undefined && this.__focusedItem !== null) {\n          async.microTask.run(() => {\n            setTimeout(() => {\n              this.__focusedItem.focus();\n            }, 50);\n          });\n        }\n      }\n    }\n  }\n  /**\n   * adjust indent\n   */\n  _adjustIndent(item, amount) {\n    if (\n      (amount > 0 && !item.disableRight) ||\n      (amount < 0 && !item.disableLeft)\n    ) {\n      let i = parseInt(item.index),\n        oldIndent = item.indent,\n        indent = item.indent + amount,\n        n = i + 1;\n      let prevParent =\n        item.prevSibling !== null &&\n        typeof item.prevSibling !== typeof undefined\n          ? item.prevSibling.id\n          : null;\n      let grandParent =\n        this._getItemById(item.parent) && this._getItemById(item.parent).parent\n          ? this._getItemById(item.parent).parent.id\n          : null;\n      item.indent = indent;\n      item.parent = amount > 0 ? prevParent : grandParent;\n      item.prevSibling = this._getSibling(i, indent, true);\n      item.nextSibling = this._getSibling(i, indent, false);\n      item.disableUp = item.prevSibling === null;\n      item.disableDown = item.nextSibling === null;\n      item.disableLeft = indent === 0;\n      item.disableRight =\n        this.items[i - 1] === null ||\n        typeof this.items[i - 1] === typeof undefined ||\n        indent > this.items[i - 1].indentLevel;\n      this.set(`items.${i}`, item);\n      this.notifyPath(`items.${i}.*`);\n      while (\n        this.items[n] !== null &&\n        this.items[n] !== undefined &&\n        oldIndent < this.items[n].indentLevel\n      ) {\n        this.items[n].indentLevel = this.items[n].indentLevel + amount;\n        this.notifyPath(`items.${n}.indentLevel`);\n        n++;\n        next = this.items[n];\n      }\n    }\n  }\n  /**\n   * gets all children of an item\n   */\n  _getLastChild(item) {\n    let next =\n      item !== undefined && item !== null\n        ? this._getSibling(item.index, item.indent, false)\n        : null;\n    if (next !== null && next !== undefined) {\n      return next - 1;\n    } else if (\n      typeof item !== typeof undefined &&\n      item.parent !== null &&\n      item.parent !== null &&\n      this._getItemById(item.parent) !== null\n    ) {\n      return this._getLastChild(this._getItemById(item.parent));\n    } else {\n      return this.items.length - 1;\n    }\n  }\n\n  /**\n   * converts a nested array of items and returns a flat list with indents\n   */\n  _getIndent(data, i) {\n    if (typeof data[i].parent !== typeof undefined) {\n      let k = data.findIndex(j => j.id === data[i].parent);\n      if (\n        k !== -1 &&\n        typeof data[k] !== typeof undefined &&\n        data[k].indent !== undefined\n      ) {\n        return data[k].indent + 1;\n      }\n    }\n    return 0;\n  }\n  /**\n   * returns order relative to siblings\n   */\n  _getOrder(item) {\n    let ctr = 0,\n      order = 0;\n    for (var i in this.items) {\n      if (this.items[i].parent == item.parent && this.items[i].id == item.id) {\n        order = ctr;\n      } else if (this.items[i].parent == item.parent) {\n        ctr++;\n      }\n    }\n    return order;\n  }\n  /**\n   * returns previous or next sibling\n   */\n  _getSibling(index, indent, prev) {\n    let inc = prev ? -1 : 1,\n      i = index + inc,\n      sib = null;\n    if (this.items !== null) {\n      while (i < this.items.length && i > -1) {\n        if (\n          sib === null &&\n          typeof this.items[i] !== typeof undefined &&\n          typeof this.items[index] !== typeof undefined &&\n          this.items[i].parent === this.items[index].parent\n        ) {\n          sib = i;\n        }\n        i += inc;\n      }\n    }\n    return sib;\n  }\n  /**\n   * get an item by item id\n   */\n  _getItemById(id, offset) {\n    let i = this.items.findIndex(j => j.id === id);\n    offset = offset === undefined ? 0 : offset;\n    if (this.items[i + offset] !== undefined) {\n      return this.items[i + offset];\n    } else {\n      return null;\n    }\n  }\n  /**\n   * listener to add an item\n   */\n  _handleAddItem(e) {\n    this.addItem(e.detail);\n  }\n  /**\n   * listener to delete an item\n   */\n  _handleRemoveItem(e) {\n    this.activeItem = e.detail.item;\n    this.removeItem(e.detail.item);\n  }\n  /**\n   * listener to move an item\n   */\n  _handleMoveItem(e) {\n    this.activeItem = e.detail.item;\n    this.moveItem(e.detail.item, e.detail.moveUp, e.detail.byGroup);\n  }\n  /**\n   * listener to move focus up or down\n   */\n  _handleFocusItem(e) {\n    let item = e.detail.moveUp\n      ? e.detail.item.previousElementSibling\n      : e.detail.item.nextElementSibling;\n    item.setSelection();\n  }\n  /**\n   * listener to increase or decrease indent\n   */\n  _handleIndentItem(e) {\n    let amt = e.detail.increase ? 1 : -1;\n    this._adjustIndent(this._getItemById(e.detail.item.id), amt);\n    this.setData(this.items);\n  }\n  /**\n   * listener to handle changes to text inputs\n   */\n  _handleChangeItem(e) {\n    if (this._getItemById(e.detail.item.id) != null) {\n      let i = this.items.findIndex(j => j.id === e.detail.item.id);\n      if (typeof this.items[i] !== typeof undefined) {\n        this.items[i].title = e.detail.value;\n        this.notifyPath(`items.${i}.title`);\n      }\n    }\n  }\n  /**\n   * listener for focus or mouseover\n   */\n  _handleFocusItem(e) {\n    this.__focusedItem = e.srcElement;\n  }\n  /**\n   * listener for blur or mouseout\n   */\n  _handleBlurItem(e) {}\n}\nwindow.customElements.define(LrnsysOutline.tag, LrnsysOutline);\nexport { LrnsysOutline };\n"],"names":["LrnsysOutline","PolymerElement","html","data","type","Array","value","items","notify","activeItem","Object","window","SimpleModal","requestAvailability","afterNextRender","this","addEventListener","_handleRemoveItem","bind","_handleIndentItem","_handleAddItem","_handleMoveItem","_handleChangeItem","_handleFocusItem","_handleBlurItem","removeEventListener","length","__tempid","undefined","id","title","order","parent","setData","prevIndent","i","indent","parseInt","_getIndent","index","prevSibling","_getSibling","nextSibling","disableUp","disableDown","disableLeft","disableRight","set","_getOrder","notifyPath","detail","item","spliceIndex","findIndex","j","splice","indentLevel","__focusedItem","async","run","setTimeout","_this2","nextElementSibling","focus","b","document","createElement","raised","_deleteItemConfirm","appendChild","createTextNode","evt","CustomEvent","bubbles","cancelable","elements","buttons","invokedBy","shadowRoot","querySelector","clone","dispatchEvent","e","_this3","classList","add","k","previousElementSibling","remove","moveUp","sourceStart","sourceEnd","_getLastChild","sourceCount","target","item2","querySelectorAll","_this4","amount","oldIndent","n","prevParent","_typeof","grandParent","_getItemById","next","ctr","prev","inc","sib","offset","addItem","removeItem","moveItem","byGroup","setSelection","amt","increase","_adjustIndent","srcElement","customElements","define","tag"],"mappings":"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"}