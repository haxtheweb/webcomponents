define(["exports","./node_modules/@polymer/polymer/polymer-element.js","./lib/a11y-media-player-behaviors.js","./node_modules/@polymer/paper-slider/paper-slider.js","./node_modules/@polymer/iron-icons/iron-icons.js","./node_modules/@polymer/iron-icons/av-icons.js","./lib/screenfull-lib.js","./lib/a11y-media-controls.js","./lib/a11y-media-html5.js","./lib/a11y-media-play-button.js","./lib/a11y-media-transcript.js","./lib/a11y-media-transcript-controls.js","./lib/a11y-media-state-manager.js","./lib/a11y-media-youtube.js"],function(_exports,_polymerElement,_a11yMediaPlayerBehaviors,_paperSlider,_ironIcons,_avIcons,_screenfullLib,_a11yMediaControls,_a11yMediaHtml,_a11yMediaPlayButton,_a11yMediaTranscript,_a11yMediaTranscriptControls,_a11yMediaStateManager,_a11yMediaYoutube){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.A11yMediaPlayer=void 0;function _templateObject_0bc87bb029d211e9b7653d5790b75dfc(){var data=babelHelpers.taggedTemplateLiteral(["\n<style>\n:host {\n  display: block;\n  width: calc(100% - 2px);\n  border: 1px solid var(--simple-colors-default-theme-grey-3);\n  --a11y-media-color: var(--simple-colors-default-theme-grey-11);\n  --a11y-media-bg-color: var(--simple-colors-default-theme-grey-2);\n  --a11y-media-hover-color: var(--simple-colors-default-theme-grey-12);\n  --a11y-media-hover-bg-color: var(--simple-colors-default-theme-grey-2);\n  --a11y-media-accent-color: var(--simple-colors-default-theme-accent-9);\n  --a11y-media-faded-accent-color: var(--simple-colors-default-theme-accent-8);\n\n  \n  --a11y-media-settings-menu-color: var(--a11y-media-color);\n  --a11y-media-settings-menu-bg-color: var(--a11y-media-bg-color);\n  --a11y-media-settings-menu-hover-color: var(--a11y-media-hover-color);\n  --a11y-media-settings-menu-hover-bg-color: var(--a11y-media-hover-bg-color);\n\n  \n  --a11y-media-button-color: var(--a11y-media-color);\n  --a11y-media-button-bg-color: var(--a11y-media-bg-color);\n  --a11y-media-button-hover-color: var(--a11y-media-accent-color);\n  --a11y-media-button-hover-bg-color: var(--a11y-media-hover-bg-color);\n  --a11y-media-button-toggle-color: var(--a11y-media-faded-accent-color);\n\n  \n  --paper-toggle-button-unchecked-bar-color: var(--a11y-media-color);\n  --paper-toggle-button-unchecked-button-color: var(--a11y-media-color);\n  --paper-toggle-button-checked-bar-color: var(--a11y-media-accent-color);\n  --paper-toggle-button-checked-button-color: var(--a11y-media-accent-color);\n\n  \n  --paper-slider-active-color: var(--a11y-media-accent-color);\n  --paper-slider-secondary-color: var(--a11y-media-faded-accent-color);\n  --paper-slider-pin-color: var(--a11y-media-faded-bg-color);\n  --paper-slider-pin-start-color: var(--a11y-media-faded-bg-color);\n  --paper-slider-pin-end-color: var(--a11y-media-faded-bg-color);\n  --paper-slider-knob-color: var(--a11y-media-accent-color);\n  --paper-slider-knob-start-color: var(--a11y-media-bg-color);\n  --paper-slider-knob-end-color: var(--a11y-media-bg-color);\n  --paper-slider-knob-border-color: var(--a11y-media-accent-color);\n  --paper-slider-knob-start-border-color: var(--a11y-media-bg-color);\n  --paper-slider-knob-end-border-color: var(--a11y-media-bg-color);\n  \n  \n  --a11y-media-transcript-color: var(--simple-colors-default-theme-grey-7);\n  --a11y-media-transcript-bg-color: var(--simple-colors-default-theme-grey-1);\n  --a11y-media-transcript-accent-color: var(--simple-colors-default-theme-accent-8);\n  --a11y-media-transcript-faded-accent-color: var(--simple-colors-default-theme-accent-10);\n  --a11y-media-transcript-cue-color: var(--simple-colors-light-theme-grey-12);\n  --a11y-media-transcript-cue-bg-color: var(--simple-colors-light-theme-grey-1);\n  --a11y-media-transcript-active-cue-color: var(--simple-colors-light-theme-grey-12);\n  --a11y-media-transcript-active-cue-bg-color: var(--simple-colors-light-theme-accent-1);\n  --a11y-media-transcript-focused-cue-color: var(--simple-colors-light-theme-grey-12);\n  --a11y-media-transcript-focused-cue-bg-color: var(--simple-colors-light-theme-grey-2);\n  --a11y-media-transcript-match-color: var(--simple-colors-light-theme-grey-1);\n  --a11y-media-transcript-match-bg-color: var(--simple-colors-light-theme-accent-10);\n  --a11y-media-transcript-match-border-color: var(--simple-colors-light-theme-accent-12);\n}\n:host([dark]) {\n  border: 1px solid var(--simple-colors-default-theme-grey-1);\n}\n:host([dark-transcript]) {\n  --a11y-media-transcript-bg-color: var(--simple-colors-dark-theme-grey-1);\n  --a11y-media-transcript-cue-color: var(--simple-colors-dark-theme-grey-12);\n  --a11y-media-transcript-cue-bg-color: var(--simple-colors-dark-theme-grey-1);\n  --a11y-media-transcript-active-cue-color: var(--simple-colors-dark-theme-accent-10);\n  --a11y-media-transcript-active-cue-bg-color: var(--simple-colors-dark-theme-grey-1);\n  --a11y-media-transcript-match-color: var(--simple-colors-dark-theme-grey-1);\n  --a11y-media-transcript-match-bg-color: var(--simple-colors-dark-theme-accent-10);\n  --a11y-media-transcript-match-border-color: var(--simple-colors-dark-theme-accent-12);\n  --a11y-media-transcript-focused-cue-color: var(--simple-colors-dark-theme-grey-12);\n  --a11y-media-transcript-focused-cue-bg-color: var(--simple-colors-dark-theme-grey-2);\n}\n:host,\n:host #outerplayer {\n  color: var(--simple-colors-default-theme-grey-12);\n  background-color: var(--simple-colors-default-theme-grey-2);\n}\n:host > * {\n  transition: all 0.5s;\n}\n:host,\n:host #outerplayer,\n:host #player,\n:host #outertranscript,\n:host #innertranscript {\n  display: flex;\n  flex-flow: column;\n  align-items: stretch;\n  align-content: stretch;\n} \n:host #innerplayer {\n  display: flex;\n}\n:host([hidden]),\n:host *[hidden] {\n  display: none !important;\n}\n:host #innerplayer,\n:host #player, \n:host #player > *,\n:host #customcc,\n:host #customcctxt,\n:host #slider,\n:host #controls,\n:host #outertranscript,\n:host #innertranscript,\n:host #innertranscript > * {\n  width: 100%;\n}\n:host > *,\n:host #innerplayer,\n:host #player,\n:host #player > *,\n:host #customcctxt {\n  flex: 1 1 auto;\n}\n:host #controls,\n:host #tcontrols {\n  flex: 0 0 44px;\n}\n:host #innerplayer {\n  margin: 0 auto;\n}\n:host #player {\n  position: relative;\n}\n:host #player > * {\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: 100%;\n  max-height: calc(100vh - 100px);\n}\n:host #playbutton,\n:host #slider,\n:host #controls {\n  z-index: 2;\n}\n:host([audio-only]) #playbutton {\n  opacity: 0;\n}\n:host #slider {\n  flex: 0 0 32px;\n  height: 32px;\n}\n:host([thumbnail-src]) #youtube {\n  opacity: 0;\n}\n:host #youtube[elapsed] {\n  opacity: 1;\n  transition: opacity 0.5s;\n}\n:host #customcc:not([hidden]) {\n  font-size: 20px;\n  transition: font-size 0.25s;\n  display: flex;\n}\n:host #customcctxt:not(:empty) {\n  align-self: flex-end;\n  font-family: sans-serif;\n  color: white;\n  margin: 4px 10px;\n  padding: 0.15em 4px;\n  background-color: black;\n  background-color: rgba(0, 0, 0, 0.8);\n  transition: all 0.5s;\n}\n:host([audio-only]:not([thumbnail-src])) #customcctxt {\n  align-self: center;\n  color: var(--a11y-media-color);\n  background-color: transparent;\n}\n:host #printthumb {\n  width: 100%;\n  margin: 0;\n  display: block;\n  border-top: 1px solid #aaaaaa;\n}\n:host .media-caption:not(:empty) {\n  width: calc(100% - 30px);\n  padding: 5px 15px;\n}\n:host .media-type {\n  font-style: italic;\n}\n:host #outertranscript {\n  padding: 0 1px 0 0;\n}\n:host #innertranscript {\n  flex: 1 0 194px;\n}\n:host #transcript {\n  flex: 1 0 150px;\n}\n:host .sr-only {\n  position: absolute;\n  left: -9999px;\n  font-size: 0;\n  height: 0;\n  width: 0;\n  overflow: hidden;\n}\n@media screen {\n  :host([flex-layout]:not([responsive-size*=\"s\"])) {\n    flex-flow: row;\n    padding: 0;\n  }\n  :host([flex-layout]:not([responsive-size*=\"s\"])) #outerplayer {\n    flex: 1 0 auto;\n  }\n  :host #printthumb,\n  :host([height]) #outertranscript,\n  :host([stand-alone]) #outertranscript,\n  :host([hide-transcript]) #outertranscript {\n    display: none;\n  }\n  :host([sticky]:not([sticky-corner=\"none\"])) #outerplayer {\n    position: fixed;\n    top: 5px;\n    right: 5px;\n    width: 200px;\n    max-width: 200px;\n    z-index: 999999;\n    border: 1px solid var(--a11y-media-bg-color);\n    box-shadow: 1px 1px 20px 1px rgba(125, 125, 125);\n    border-radius: 3.2px;\n  }\n  :host([dark][sticky]:not([sticky-corner=\"none\"])) #outerplayer {\n    border: 1px solid var(--a11y-media-bg-color);\n  }\n  :host([sticky][sticky-corner=\"top-left\"]) #outerplayer {\n    right: unset;\n    left: 5px;\n  }\n  :host([flex-layout]:not([responsive-size*=\"s\"])) > div {\n    width: 50%;\n    flex: 1 1 auto;\n  }\n  :host #innertranscript {\n    position: relative;\n  }\n  :host([hide-transcript]) #outerplayer {\n    min-width: 50%;\n    max-width: 100%;\n  }\n  :host([hide-transcript]) #outertranscript {\n    display: none;\n  }\n  :host(:not([no-height]):not([stacked-layout]):not([responsive-size*=\"s\"]))\n    #transcript {\n    position: absolute;\n    top: 44px;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    overflow-y: scroll;\n  }\n  :host(:not([no-height]):not([stacked-layout]):not([responsive-size*=\"s\"]))\n    #innerplayer.totop {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 200px !important;\n    z-index: 9999;\n  }\n  :host([sticky][sticky-corner=\"bottom-left\"]) #innerplayer {\n    top: unset;\n    right: unset;\n    bottom: 5px;\n  }\n  :host([sticky][sticky-corner=\"bottom-right\"]) #innerplayer {\n    top: unset;\n    bottom: 5px;\n  }\n  :host([sticky]:not([sticky-corner=\"none\"]):not([no-height]):not([stacked-layout]):not([responsive-size*=\"s\"]))\n    #controls {\n    display: none;\n  }\n  :host([responsive-size=\"lg\"]) #customcc {\n    font-size: 16px;\n  }\n  :host([responsive-size=\"md\"]) #customcc,\n  :host([flex-layout][responsive-size=\"xl\"]) #customcc {\n    font-size: 14px;\n  }\n  :host([responsive-size=\"sm\"]) #customcc,\n  :host([flex-layout][responsive-size=\"lg\"]) #customcc {\n    font-size: 12px;\n  }\n  :host([responsive-size=\"xs\"]) #customcc,\n  :host([flex-layout][responsive-size=\"md\"]) #customcc,\n  :host([flex-layout][responsive-size=\"sm\"]) #customcc {\n    font-size: 10px;\n  }\n  :host([sticky]:not([sticky-corner=\"none\"])) #customcc {\n    display: none;\n  }\n  :host .media-caption {\n    color: var(--a11y-media-bg-color);\n    background-color: var(--a11y-media-accent-color);\n  }\n  :host #audio-only {\n    text-align: center;\n    font-style: italic;\n    width: 100%;\n    line-height: 160%;\n  }\n  :host .print-only {\n    display: none;\n  }\n}\n\n@media print {\n  :host,\n  :host([dark]) {\n    outline: 1px solid #aaaaaa;\n    background-color: #ffffff;\n  }\n  :host .screen-only,\n  :host #printthumb:not([src]),\n  :host(:not([thumbnail-src])) #player {\n    display: none;\n  }\n  :host #searchbar {\n    display: none;\n  }\n  :host .media-caption {\n    background-color: #cccccc;\n    color: #000000;\n    font-size: 120%;\n  }\n}</style>\n<style is=\"custom-style\" include=\"simple-colors\"></style>\n\n    <div class=\"sr-only\">[[mediaCaption]]</div>\n  <div id=\"outerplayer\">\n    <div id=\"innerplayer\">\n      <div id=\"player\"\n        style$=\"[[_getThumbnailCSS(thumbnailSrc,isYoutube,audioOnly)]]\">\n        <a11y-media-play-button\n          id=\"playbutton\"\n          action$=\"[[playPause.action]]\"\n          audio-only$=\"[[audioOnly]]\"\n          disabled=\"true\"\n          elapsed$=\"[[_hidePlayButton(thumbnailSrc, isYoutube, __elapsed)]]\"\n          hidden$=\"[[audioNoThumb]]\"\n          disabled$=\"[[audioNoThumb]]\"\n          on-controls-change=\"_onControlsChanged\"\n          localization$=\"[[localization]]\">\n        </a11y-media-play-button>\n        <a11y-media-html5\n          id=\"html5\"\n          audio-only$=\"[[audioOnly]]\"\n          autoplay$=\"[[autoplay]]\"\n          cc$=\"[[cc]]\"\n          crossorigin$=\"[[crossorigin]]\"\n          hidden$=\"[[isYoutube]]\"\n          media-lang$=\"[[mediaLang]]\"\n          loop$=\"[[loop]]\"\n          muted$=\"[[muted]]\"\n          manifest$=\"[[manifest]]\"\n          on-media-loaded=\"_handleMediaLoaded\"\n          playing$=\"[[__playing]]\"\n          playback-rate$=\"[[playbackRate]]\"\n          thumbnail-src$=\"[[thumbnailSrc]]\"\n          preload$=\"[[preload]]\"\n          volume$=\"[[volume]]\"\n        >\n          <slot></slot>\n        </a11y-media-html5>\n        <div id=\"youtube\" \n          elapsed$=\"[[__elapsed]]\" \n          lang$=\"[[mediaLang]]\"\n          video-id$=\"[[videoId]]\">\n        </div>\n        <div id=\"customcc\" \n          class=\"screen-only\" \n          hidden$=\"[[!showCustomCaptions]]\">\n          <div id=\"customcctxt\"></div>\n        </div>\n      </div>\n    </div>\n    <paper-slider id=\"slider\"\n      class=\"screen-only\"\n      max$=\"[[__duration]]\"\n      on-dragging-changed=\"_handleSliderDragging\"\n      on-focused-changed=\"_handleSliderKeyboard\"\n      secondary-progress$=\"[[__buffered]]\"\n      value$=\"[[__elapsed]]\"\n    >\n    </paper-slider>\n    <a11y-media-controls id=\"controls\"\n      cc$=\"[[cc]]\"\n      fixed-height$=\"[[height]]\"\n      has-captions$=\"[[hasCaptions]]\"\n      has-transcript$=\"[[hasTranscript]]\"\n      hide-transcript$=\"[[hideTranscript]]\"\n      localization$=\"[[localization]]\"\n      muted$=\"[[muted]]\"\n      on-controls-change=\"_onControlsChanged\"\n      on-print-transcript=\"_handlePrinting\"\n      playing$=\"[[__playing]]\"\n      search-transcript$=\"[[searchTranscript]]\"\n      stand-alone$=\"[[standAlone]]\"\n      volume=\"[[__volume]]\">\n    </a11y-media-controls>\n    <div\n      aria-hidden=\"true\"\n      class=\"screen-only media-caption\"\n      hidden$=\"[[!_hasAttribute(mediaCaption)]]\">\n      [[mediaCaption]]\n    </div>\n    <div class=\"print-only media-caption\">[[printCaption]]</div>\n  </div>\n  <img id=\"printthumb\" aria-hidden=\"true\" src$=\"[[thumbnailSrc]]\" />\n  <div id=\"outertranscript\" hidden$=\"[[standAlone]]\">\n    <div id=\"innertranscript\" hidden$=\"[[hideTranscript]]\">\n      <a11y-media-transcript-controls id=\"tcontrols\"\n        accent-color$=\"[[accentColor]]\"\n        localization$=\"[[localization]]\"\n        dark$=\"[[darkTranscript]]\"\n        disable-print-button$=\"[[disablePrintButton]]\"\n        disable-scroll$=\"[[disableScroll]]\"\n        disable-search$=\"[[disableSearch]]\"\n        on-searchbar-added=\"_handleSearchAdded\"\n        on-toggle-scroll=\"_handleTranscriptScrollToggle\"\n        on-print-transcript=\"_handlePrinting\"\n        stand-alone$=\"[[standAlone]]\">\n      </a11y-media-transcript-controls>\n      <a11y-media-transcript id=\"transcript\"\n        accent-color$=\"[[accentColor]]\"\n        dark$=\"[[darkTranscript]]\"\n        disable-scroll$=\"[[disableScroll]]\"\n        disable-search$=\"[[disableSearch]]\"\n        disable-interactive$=\"[[disableInteractive]]\"\n        hide-timestamps$=\"[[hideTimestamps]]\"\n        on-cue-seek=\"_handleCueSeek\"\n        localization$=\"[[localization]]\"\n        search=\"[[search]]\"\n        selected-transcript$=\"[[__selectedTrack]]\">\n      </a11y-media-transcript>\n    </div>\n  </div>"]);_templateObject_0bc87bb029d211e9b7653d5790b75dfc=function _templateObject_0bc87bb029d211e9b7653d5790b75dfc(){return data};return data}var A11yMediaPlayer=function(_A11yMediaPlayerBehav){var _Mathmax=Math.max;babelHelpers.inherits(A11yMediaPlayer,_A11yMediaPlayerBehav);function A11yMediaPlayer(){babelHelpers.classCallCheck(this,A11yMediaPlayer);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(A11yMediaPlayer).apply(this,arguments))}babelHelpers.createClass(A11yMediaPlayer,[{key:"connectedCallback",value:function connectedCallback(){babelHelpers.get(babelHelpers.getPrototypeOf(A11yMediaPlayer.prototype),"connectedCallback",this).call(this);var root=this;root.__playerAttached=!0;window.A11yMediaStateManager.requestAvailability();root._addResponsiveUtility();window.dispatchEvent(new CustomEvent("a11y-player",{detail:root}));if(root.isYoutube){root._youTubeRequest()}}},{key:"ready",value:function ready(){var _this=this;babelHelpers.get(babelHelpers.getPrototypeOf(A11yMediaPlayer.prototype),"ready",this).call(this);var root=this,aspect=16/9,tracks=[],tdata=[],selected=0;root.__playerReady=!0;root.__interactive=!root.disableInteractive;root.target=root.shadowRoot.querySelector("#transcript");root.__status=root.loadingLabel;root.__slider=root.$.slider;root.__volume=root.muted?0:_Mathmax(this.volume,10);root.__resumePlaying=!1;root.__showFullscreen=!this.disableFullscreen&&screenfull.enabled;root.__duration=0;root.$.controls.setStatus(root.__status);root.width=null!==root.width?root.width:"100%";root.style.maxWidth=null!==root.width?root.width:"100%";root._setPlayerHeight(aspect);if(root.isYoutube){root._youTubeRequest()}else{root.media=root.$.html5;root._addSourcesAndTracks()}root.$.transcript.setMedia(root.$.innerplayer);if(root.__showFullscreen){screenfull.on("change",function(){_this.fullscreen=screenfull.isFullscreen})}}},{key:"play",value:function play(e){var root=this;root.__playing=!0;if(e===void 0||e.detail===root.$.playbutton){root.__playProgress=setInterval(function(){root.__elapsed=0<root.media.getCurrentTime()?root.media.getCurrentTime():0;root.__duration=0<root.media.duration?root.media.duration:0;root._updateCustomTracks();root.__status=root._getHHMMSS(root.media.getCurrentTime(),root.__duration)+"/"+root._getHHMMSS(root.__duration);root.$.controls.setStatus(root.__status);if(root.__elapsed===root.__duration&&!root.loop){root.__playing=!1;clearInterval(root.__playProgress)}root.__buffered=root.media.getBufferedTime},1);window.dispatchEvent(new CustomEvent("a11y-player-playing",{detail:root}));root.media.play()}}},{key:"pause",value:function pause(){var root=this;root.__playing=!1;root.media.pause();clearInterval(root.__playProgress)}},{key:"stop",value:function stop(){this.pause();this.seek(0)}},{key:"restart",value:function restart(){this.seek(0);this.play()}},{key:"rewind",value:function rewind(amt){amt=amt!==void 0?amt:1;this.seek(_Mathmax(this.media.getCurrentTime()-amt,0))}},{key:"forward",value:function forward(amt){amt=amt!==void 0?amt:1;this.seek(Math.min(this.media.getCurrentTime()+amt,this.__duration))}},{key:"seek",value:function seek(time){var seekable=this.media!==void 0&&null!==this.media?this.media.seekable:[];if(0<seekable.length&&time>=seekable.start(0)&&time<=seekable.end(0)){this.media.seek(time);this.__elapsed=time;this.__status=this._getHHMMSS(this.media.getCurrentTime(),this.__duration)+"/"+this._getHHMMSS(this.__duration);this.$.controls.setStatus(this.__status);this._updateCustomTracks();if(this.__resumePlaying)this.play()}}},{key:"selectTrack",value:function selectTrack(index){this.__selectedTrack=index;this.$.html5.selectTrack(index)}},{key:"setVolume",value:function setVolume(value){this.volume=null!==value?value:70;this.media.setVolume(this.volume);this.muted=0===this.volume}},{key:"setPlaybackRate",value:function setPlaybackRate(value){value=null!==value?value:1;this.media.setPlaybackRate(value)}},{key:"toggleCC",value:function toggleCC(mode){this.cc=mode===void 0?!this.cc:mode;this.$.html5.setCC(this.cc)}},{key:"toggleLoop",value:function toggleLoop(mode){if(this.isYoutube){}else{this.loop=mode===void 0?!this.loop:mode;this.media.setLoop(this.loop)}}},{key:"toggleMute",value:function toggleMute(mode){this.muted=mode===void 0?!this.muted:mode;this.__volume=this.muted?0:_Mathmax(this.volume,10);this.media.setMute(this.muted)}},{key:"toggleSticky",value:function toggleSticky(mode){mode=mode===void 0?!this.sticky:mode;this.sticky=mode;this.dispatchEvent(new CustomEvent("player-sticky",{detail:this}))}},{key:"toggleTranscript",value:function toggleTranscript(mode){mode=mode===void 0?this.hideTranscript:mode;this.hideTranscript=!mode;if(this.$.transcript!==void 0&&null!==this.$.transcript){this.dispatchEvent(new CustomEvent("transcript-toggle",{detail:this}))}}},{key:"_appendToPlayer",value:function _appendToPlayer(data,type){var root=this,arr=babelHelpers.typeof(data)===Array?data:JSON.parse(data);if(arr!==void 0&&null!==arr){for(var i=0,el;i<arr.length;i++){el=document.createElement(type);for(var key in arr[i]){el.setAttribute(key,arr[i][key])}root.$.html5.media.appendChild(el)}}}},{key:"_setPlayerHeight",value:function _setPlayerHeight(aspect){var root=this;if(root.audioOnly&&null===root.thumbnailSrc&&null===root.height){root.$.player.style.height="60px"}else if(null===root.height){root.$.player.style.paddingTop=100/aspect+"%";root.$.innerplayer.style.maxWidth="calc("+100*aspect+"vh - "+80*aspect+"px)"}else{root.$.outerplayer.style.height=root.height}}},{key:"_getMediaCaption",value:function _getMediaCaption(audioOnly,localization,mediaTitle){var audioLabel=this._getLocal(localization,"audio","label"),hasMediaTitle=mediaTitle!==void 0&&null!==mediaTitle&&""!==mediaTitle;if(audioOnly&&hasMediaTitle){return mediaTitle+" ("+audioLabel+")"}else if(audioOnly){return audioLabel}else if(hasMediaTitle){return mediaTitle}else{return null}}},{key:"_getPrintCaption",value:function _getPrintCaption(audioOnly,localization,mediaTitle){var audioLabel=this._getLocal(localization,"audio","label"),videoLabel=this._getLocal(localization,"video","label"),hasMediaTitle=mediaTitle!==void 0&&null!==mediaTitle&&""!==mediaTitle;if(audioOnly&&hasMediaTitle){return mediaTitle+" ("+audioLabel+")"}else if(audioOnly){return audioLabel}else if(hasMediaTitle){return mediaTitle+" ("+videoLabel+")"}else{return videoLabel}}},{key:"_getThumbnailCSS",value:function _getThumbnailCSS(thumbnailSrc,isYoutube,audioOnly){return null!=thumbnailSrc&&(isYoutube||audioOnly)?"background-image: url("+thumbnailSrc+"); background-size: cover;":null}},{key:"_addSourcesAndTracks",value:function _addSourcesAndTracks(){var root=this,counter=0;root.querySelectorAll("source,track").forEach(function(node){root.$.html5.media.appendChild(node)});root._appendToPlayer(root.tracks,"track");root._appendToPlayer(root.sources,"source");root.$.html5.media.textTracks.onaddtrack=function(e){root.hasCaptions=!0;root.hasTranscript=!root.standAlone;root._getTrackData(e.track,counter++)}}},{key:"_getTrackData",value:function _getTrackData(track,id){var root=this,selected=!0===track.default||root.__selectedTrack===void 0,loadCueData;if(selected)root.selectTrack(id);track.mode=selected&&!0===this.cc?"showing":"hidden";loadCueData=setInterval(function(){if(track.cues!==void 0&&null!==track.cues&&0<track.cues.length){clearInterval(loadCueData);var cues=Object.keys(track.cues).map(function(key){return{order:""!==track.cues[key].id?track.cues[key].id:key,seek:track.cues[key].startTime,seekEnd:track.cues[key].endTime,start:root._getHHMMSS(track.cues[key].startTime,root.media.duration),end:root._getHHMMSS(track.cues[key].endTime,root.media.duration),text:track.cues[key].text}});if(root.__tracks===void 0)root.__tracks=[];root.push("__tracks",{value:id,language:track.language,text:track.label!==void 0?track.label:track.language!==void 0?track.language:"Track "+id,cues:cues});root.$.controls.setTracks(root.__tracks);root.$.transcript.setTracks(root.__tracks);root.push("__tracks");track.oncuechange=function(e){root.$.transcript.setActiveCues(Object.keys(e.currentTarget.activeCues).map(function(key){return e.currentTarget.activeCues[key].id}))}}},1)}},{key:"_handleCueSeek",value:function _handleCueSeek(e){var root=this;if(!root.standAlone&&root.$.transcript!==void 0&&null!==root.$.transcript){root.__resumePlaying=root.__playing;root.seek(e.detail)}}},{key:"_handleMediaLoaded",value:function _handleMediaLoaded(e){var root=this,aspect=root.media.aspectRatio;root._setPlayerHeight(aspect);root.$.playbutton.removeAttribute("disabled");root.__duration=0<root.media.duration?root.media.duration:0;root.__status=root._getHHMMSS(0,root.media.duration)+"/"+root._getHHMMSS(root.media.duration);root.$.controls.setStatus(root.__status);root._getTrackData(root.$.html5.media)}},{key:"_handlePrinting",value:function _handlePrinting(e){var root=this;root.dispatchEvent(new CustomEvent("printing-transcript",{detail:root}));root.$.transcript.print(root.mediaTitle)}},{key:"_handleSearchAdded",value:function _handleSearchAdded(e){this.search=e.detail}},{key:"_handleSliderDragging",value:function _handleSliderDragging(e){var root=this;root._toggleSliderSeek(root.$.slider.dragging,root.$.slider.immediateValue)}},{key:"_handleSliderKeyboard",value:function _handleSliderKeyboard(e){var root=this;root._toggleSliderSeek(root.$.slider.focused,root.$.slider.value)}},{key:"_handleTranscriptScrollToggle",value:function _handleTranscriptScrollToggle(e){this.disableScroll=!this.disableScroll}},{key:"_onControlsChanged",value:function _onControlsChanged(e){var root=this,action=e.detail.action!==void 0?e.detail.action:e.detail.id;if("backward"===action){root.rewind(root.__duration/20)}else if("captions"===action){root.toggleCC()}else if("transcript"===action||"transcript-toggle"===action){root.toggleTranscript()}else if("tracks"===e.detail.id){if(""===e.detail.value){root.toggleCC(!1)}else{root.toggleCC(!0);root.selectTrack(e.detail.value)}}else if("forward"===action){root.forward(root.__duration/20)}else if("fullscreen"===action){this.toggleTranscript(this.fullscreen);screenfull.toggle(root.$.outerplayer)}else if("loop"===action){root.toggleLoop()}else if("mute"===action||"unmute"===action){root.toggleMute()}else if("pause"===action){root.pause()}else if("play"===action){root.play()}else if("restart"===action){root.seek(0);root.play()}else if("speed"===action){root.setPlaybackRate(e.detail.value)}else if("volume"===action){root.setVolume(e.detail.value)}}},{key:"_hidePlayButton",value:function _hidePlayButton(thumbnailSrc,isYoutube,__elapsed){return isYoutube&&null===thumbnailSrc||!(__elapsed===void 0||0===__elapsed)}},{key:"_showCustomCaptions",value:function _showCustomCaptions(isYoutube,audioOnly,hasCaptions,cc){return(isYoutube||audioOnly)&&hasCaptions&&cc}},{key:"_toggleSliderSeek",value:function _toggleSliderSeek(seeking,value){if(seeking){if(this.__playing)this.__resumePlaying=!0;this.pause()}else{this.seek(value);this.__resumePlaying=!1}}},{key:"_useYoutubeIframe",value:function _useYoutubeIframe(thumbnailSrc,isYoutube,__elapsed){return isYoutube&&(null===thumbnailSrc||__elapsed===void 0||0===__elapsed)}},{key:"_youTubeRequest",value:function _youTubeRequest(){window.A11yMediaYoutube.requestAvailability();var root=this,ytUtil=window.A11yMediaYoutube.instance;root.disableInteractive=!0;if(root.__playerAttached&&root.__playerReady){var ytInit=function ytInit(){root.media=ytUtil.initYoutubePlayer({width:"100%",height:"100%",videoId:root.youtubeId});root.$.youtube.appendChild(root.media.a);root.__ytAppended=!0;root._updateCustomTracks();var int=setInterval(function(){if(root.media.getDuration!==void 0){clearInterval(int);root.__duration=root.media.duration=root.media.getDuration();root.__status=root._getHHMMSS(0,root.media.duration)+"/"+root._getHHMMSS(root.media.duration);root.$.controls.setStatus(root.__status);root.disableInteractive=!root.__interactive;root._addSourcesAndTracks()}},100)},checkApi=function checkApi(e){if(ytUtil.apiReady){document.removeEventListener("youtube-api-ready",checkApi);if(!root.__ytAppended){ytInit()}}};if(ytUtil.apiReady){if(!root.__ytAppended){ytInit()}}else{document.addEventListener("youtube-api-ready",checkApi)}}}},{key:"_updateCustomTracks",value:function _updateCustomTracks(){if(this._hasCustomCaptions(this.isYoutube,this.audioOnly,this.tracks)){var root=this,track=root.tracks[this.$.transcript.selectedTranscript],active=[],caption="";if(track!==void 0&&null!==track&&track.cues!==void 0&&null!==track.cues){for(var i=0;i<track.cues.length;i++){if(track.cues[i].seek<root.__elapsed&&track.cues[i].seekEnd>root.__elapsed){active.push(track.cues[i].order);caption=""===caption?track.cues[i].text:caption}}root.$.customcctxt.innerText=caption;root.$.transcript.setActiveCues(active)}}}}],[{key:"template",get:function get(){return(0,_polymerElement.html)(_templateObject_0bc87bb029d211e9b7653d5790b75dfc())}},{key:"properties",get:function get(){return{mediaCaption:{type:"String",computed:"_getMediaCaption(audioOnly,localization,mediaTitle)"},printCaption:{type:"String",computed:"_getPrintCaption(audioOnly,audioLabel,videoLabel,mediaTitle)"},showCustomCaptions:{type:"Boolean",computed:"_showCustomCaptions(isYoutube,audioOnly,hasCaptions,cc)"},sources:{type:"Array",value:[]},sticky:{type:"Boolean",value:!1,reflectToAttribute:!0},stickyCorner:{type:"String",value:"top-right",reflectToAttribute:!0},tracks:{type:"Array",value:[]},__playing:{type:"Boolean",value:!1,notify:!0,reflectToAttribute:!0}}}},{key:"tag",get:function get(){return"a11y-media-player"}},{key:"behaviors",get:function get(){return[_a11yMediaPlayerBehaviors.A11yMediaPlayerBehaviors]}}]);return A11yMediaPlayer}(_a11yMediaPlayerBehaviors.A11yMediaPlayerBehaviors);_exports.A11yMediaPlayer=A11yMediaPlayer;window.customElements.define(A11yMediaPlayer.tag,A11yMediaPlayer)});