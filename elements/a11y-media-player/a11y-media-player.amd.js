define(["exports","./node_modules/@polymer/polymer/polymer-element.js","./lib/a11y-media-player-properties.js","./node_modules/@polymer/paper-slider/paper-slider.js","./node_modules/@polymer/iron-icons/iron-icons.js","./node_modules/@polymer/iron-icons/av-icons.js","./lib/screenfull-lib.js","./lib/a11y-media-controls.js","./lib/a11y-media-loader.js","./lib/a11y-media-play-button.js","./lib/a11y-media-transcript.js","./lib/a11y-media-transcript-controls.js","./lib/a11y-media-utility.js","./lib/a11y-media-youtube-utility.js"],function(_exports,_polymerElement,_a11yMediaPlayerProperties,_paperSlider,_ironIcons,_avIcons,_screenfullLib,_a11yMediaControls,_a11yMediaLoader,_a11yMediaPlayButton,_a11yMediaTranscript,_a11yMediaTranscriptControls,_a11yMediaUtility,_a11yMediaYoutubeUtility){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.A11yMediaPlayer=void 0;function _templateObject_a2c40ec0fe4011e8b441311dd5f23f3e(){var data=babelHelpers.taggedTemplateLiteral(["\n      <style is=\"custom-style\" include=\"simple-colors\">\n        :host {\n          width: 100%;\n          display: block;\n          color: var(--simple-colors-default-theme-grey-12);\n          background-color: var(--simple-colors-default-theme-grey-2);\n          outline: 1px solid var(--simple-colors-default-theme-grey-3);\n        }\n        :host([dark]) {\n          outline: 1px solid var(--simple-colors-default-theme-grey-1);\n        }\n        :host #outerplayer,\n        :host #outerplayer * {\n          --a11y-media-color: var(--simple-colors-default-theme-grey-11);\n          --a11y-media-bg-color: var(--simple-colors-default-theme-grey-2);\n          --a11y-media-hover-color: var(--simple-colors-default-theme-grey-12);\n          --a11y-media-hover-bg-color: var(\n            --simple-colors-default-theme-grey-2\n          );\n          --a11y-media-accent-color: var(\n            --simple-colors-default-theme-accent-9\n          );\n          --a11y-media-faded-accent-color: var(\n            --simple-colors-default-theme-accent-8\n          );\n\n          /* settings */\n          --a11y-media-settings-menu-color: var(--a11y-media-color);\n          --a11y-media-settings-menu-bg-color: var(--a11y-media-bg-color);\n          --a11y-media-settings-menu-hover-color: var(--a11y-media-hover-color);\n          --a11y-media-settings-menu-hover-bg-color: var(\n            --a11y-media-hover-bg-color\n          );\n\n          /* buttons */\n          --a11y-media-button-color: var(--a11y-media-color);\n          --a11y-media-button-bg-color: var(--a11y-media-bg-color);\n          --a11y-media-button-hover-color: var(--a11y-media-accent-color);\n          --a11y-media-button-hover-bg-color: var(--a11y-media-hover-bg-color);\n          --a11y-media-button-toggle-color: var(\n            --a11y-media-faded-accent-color\n          );\n\n          /* toggle button */\n          --paper-toggle-button-unchecked-bar-color: var(--a11y-media-color);\n          --paper-toggle-button-unchecked-button-color: var(--a11y-media-color);\n          --paper-toggle-button-checked-bar-color: var(\n            --a11y-media-accent-color\n          );\n          --paper-toggle-button-checked-button-color: var(\n            --a11y-media-accent-color\n          );\n\n          /* slider */\n          --paper-slider-active-color: var(--a11y-media-accent-color);\n          --paper-slider-secondary-color: var(--a11y-media-faded-accent-color);\n          --paper-slider-pin-color: var(--a11y-media-faded-bg-color);\n          --paper-slider-pin-start-color: var(--a11y-media-faded-bg-color);\n          --paper-slider-pin-end-color: var(--a11y-media-faded-bg-color);\n          --paper-slider-knob-color: var(--a11y-media-accent-color);\n          --paper-slider-knob-start-color: var(--a11y-media-bg-color);\n          --paper-slider-knob-end-color: var(--a11y-media-bg-color);\n          --paper-slider-knob-border-color: var(--a11y-media-accent-color);\n          --paper-slider-knob-start-border-color: var(--a11y-media-bg-color);\n          --paper-slider-knob-end-border-color: var(--a11y-media-bg-color);\n        }\n        :host #outertranscript,\n        :host #outertranscript *,\n        :host #transcript {\n          --a11y-media-transcript-color: var(\n            --simple-colors-default-theme-grey-12\n          );\n          --a11y-media-transcript-bg-color: var(\n            --simple-colors-default-theme-grey-1\n          );\n          --a11y-media-transcript-accent-color: var(\n            --simple-colors-default-theme-accent-8\n          );\n          --a11y-media-transcript-faded-accent-color: var(\n            --simple-colors-default-theme-accent-10\n          );\n          --a11y-media-transcript-active-cue-color: var(\n            --simple-colors-default-theme-grey-12\n          );\n          --a11y-media-transcript-active-cue-bg-color: var(\n            --simple-colors-default-theme-accent-1\n          );\n          --a11y-media-transcript-focused-cue-color: var(\n            --simple-colors-default-theme-grey-12\n          );\n          --a11y-media-transcript-focused-cue-bg-color: var(\n            --simple-colors-default-theme-grey-2\n          );\n          --a11y-media-transcript-match-color: var(\n            --simple-colors-default-theme-grey-1\n          );\n          --a11y-media-transcript-match-bg-color: var(\n            --simple-colors-default-theme-accent-10\n          );\n          --a11y-media-transcript-match-border-color: var(\n            --simple-colors-default-theme-accent-12\n          );\n          --a11y-media-hover-color: var(--simple-colors-default-theme-grey-12);\n          --a11y-media-hover-bg-color: var(\n            --simple-colors-default-theme-grey-2\n          );\n        }\n        :host([dark-transcript]) #outertranscript,\n        :host([dark-transcript]) #outertranscript *,\n        :host([dark-transcript]) #transcript {\n          --a11y-media-transcript-active-cue-color: var(\n            --simple-colors-default-theme-accent-10\n          );\n          --a11y-media-transcript-active-cue-bg-color: var(\n            --simple-colors-default-theme-grey-1\n          );\n        }\n        :host #player {\n          display: block;\n          max-width: 100%;\n          transition: position 0.5s ease, max-width 1s ease;\n          background-color: var(--simple-colors-default-theme-grey-2);\n        }\n        :host #innerplayer {\n          z-index: 1;\n        }\n        :host #outeraudiocc:not([hidden]) {\n          display: flex;\n          align-items: center;\n          padding: 5px 16px;\n          min-height: 4em;\n          transition: all 0.5s;\n        }\n        :host #sources {\n          display: flex;\n          align-items: stretch;\n          position: relative;\n        }\n        :host([no-height]) #sources {\n          display: none;\n        }\n        :host #controls,\n        :host #slider,\n        :host #sources,\n        :host #sources > * {\n          width: 100%;\n        }\n        :host #loader,\n        :host #youtube,\n        :host #customcc,\n        :host #customcctxt {\n          position: absolute;\n          top: 0;\n          left: 0;\n        }\n        :host #youtube {\n          height: 100%;\n        }\n        :host #customcc {\n          font-size: 20px;\n          width: 100%;\n          height: 100%;\n          transition: font-size 0.25s;\n        }\n        :host([responsive-size*=\"lg\"]) #customcc {\n          font-size: 14px;\n        }\n        :host([responsive-size*=\"md\"]) #customcc {\n          font-size: 14px;\n        }\n        :host([responsive-size*=\"sm\"]) #customcc {\n          font-size: 12px;\n        }\n        :host([responsive-size*=\"xs\"]) #customcc {\n          font-size: 10px;\n        }\n        :host([sticky]:not([sticky-corner=\"none\"])) #customcc {\n          display: none;\n        }\n        :host #customcctxt:not(:empty) {\n          top: unset;\n          bottom: 8px;\n          display: inline-block;\n          margin: 0 10px;\n          color: white;\n          background-color: black;\n          background-color: rgba(0, 0, 0, 0.8);\n          padding: 0.15em 4px;\n        }\n        :host #innerplayer,\n        :host #sources > * {\n          max-height: 80vh;\n        }\n        :host #controls,\n        :host #slider {\n          z-index: 2 !important;\n        }\n        :host #audio-only {\n          text-align: center;\n          font-style: italic;\n          width: 100%;\n          line-height: 160%;\n        }\n        :host .media-caption:not(:empty) {\n          padding: 5px 15px;\n        }\n        :host #printthumb {\n          width: 100%;\n          margin: 0;\n          display: block;\n          border-top: 1px solid #aaaaaa;\n        }\n        :host .sr-only {\n          position: absolute;\n          left: -9999px;\n          font-size: 0;\n          height: 0;\n          width: 0;\n          overflow: hidden;\n        }\n        @media screen {\n          :host #printthumb {\n            display: none;\n          }\n          :host([flex-layout]:not([responsive-size*=\"s\"])) {\n            display: inline-flex;\n            align-items: stretch;\n            outline: 1px solid;\n            color: var(--simple-colors-default-theme-grey-12);\n            background-color: var(--simple-colors-default-theme-grey-2);\n            outline-color: var(--simple-colors-default-theme-grey-3);\n            padding: 0;\n          }\n          :host([dark][flex-layout]:not([responsive-size*=\"s\"])) {\n            outline-color: var(--simple-colors-default-theme-grey-1);\n          }\n          :host > div {\n            transition: all 0.5s;\n          }\n          :host([sticky]:not([sticky-corner=\"none\"])) #player {\n            position: fixed;\n            top: 5px;\n            right: 5px;\n            width: 200px;\n            max-width: 200px;\n            z-index: 999999;\n            border: 1px solid;\n            box-shadow: 1px 1px 20px 1px rgba(125, 125, 125);\n            border-radius: 3.2px;\n            border-color: var(--a11y-media-bg-color);\n          }\n          :host([dark][sticky]:not([sticky-corner=\"none\"])) #player {\n            border-color: var(--a11y-media-bg-color);\n          }\n          :host([sticky][sticky-corner=\"top-left\"]) #player {\n            right: unset;\n            left: 5px;\n          }\n          :host([flex-layout]:not([responsive-size*=\"s\"])) > div {\n            width: 50%;\n            flex-grow: 1;\n            flex-shrink: 1;\n          }\n          :host #innertranscript {\n            position: relative;\n            height: 100%;\n          }\n          :host([hide-transcript]) #outerplayer {\n            min-width: 50%;\n            max-width: 100%;\n          }\n          :host([hide-transcript]) #outertranscript {\n            display: none;\n          }\n          :host #transcript {\n            padding-top: 48px;\n          }\n          :host(:not([no-height]):not([stacked-layout]):not([responsive-size*=\"s\"]))\n            #transcript {\n            position: absolute;\n            top: 0;\n            left: 0;\n            right: 0;\n            bottom: 0;\n            overflow-y: scroll;\n          }\n          :host(:not([no-height]):not([stacked-layout]):not([responsive-size*=\"s\"]))\n            #player.totop {\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 200px !important;\n            z-index: 9999;\n          }\n          :host #tcontrols {\n            z-index: 1000;\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            display: flex;\n          }\n          :host([sticky][sticky-corner=\"bottom-left\"]) #player {\n            top: unset;\n            right: unset;\n            bottom: 5px;\n          }\n          :host([sticky][sticky-corner=\"bottom-right\"]) #player {\n            top: unset;\n            bottom: 5px;\n          }\n          :host([sticky]:not([sticky-corner=\"none\"]):not([no-height]):not([stacked-layout]):not([responsive-size*=\"s\"]))\n            #controls {\n            display: none;\n          }\n          :host .print-only {\n            display: none;\n          }\n          :host .media-caption {\n            color: var(--simple-colors-default-theme-grey-1);\n            background-color: var(--simple-colors-default-theme-accent-10);\n          }\n        }\n\n        @media print {\n          :host,\n          :host([dark]) {\n            outline: 1px solid #aaaaaa;\n            background-color: #ffffff;\n          }\n          :host([sticky]:not([sticky-corner=\"none\"])) #outerplayer {\n            height: unset !important;\n          }\n          :host .screen-only,\n          :host #player,\n          :host #outeraudiocc,\n          :host #printthumb:not([src]) {\n            display: none;\n          }\n          :host(:not([thumbnail-src])) #sources,\n          :host #slider,\n          :host #loader,\n          :host #youtube,\n          :host #controls {\n            display: none;\n          }\n          :host .media-type {\n            font-style: italic;\n          }\n          :host #searchbar {\n            display: none;\n          }\n          :host .media-caption {\n            background-color: #cccccc;\n            color: #000000;\n            font-size: 120%;\n            padding: 5px 15px;\n          }\n        }\n      </style>\n      <div class=\"sr-only\">[[mediaCaption]]</div>\n      <div id=\"outerplayer\" lang$=\"[[uiLanguage]]\">\n        <div id=\"outeraudiocc\" hidden$=\"[[!showCustomCaptions]]\">\n          <div id=\"audiocc\" hidden$=\"[[!noHeight]]\"></div>\n        </div>\n        <div id=\"player\">\n          <div id=\"innerplayer\">\n            <div id=\"sources\" hidden$=\"[[noHeight]]\">\n              <a11y-media-play-button\n                id=\"playbutton\"\n                audio-only$=\"[[audioOnly]]\"\n                disabled=\"true\"\n                hidden$=\"[[noPlayButton]]\"\n                disabled$=\"[[noPlayButton]]\"\n                on-controls-change=\"_onControlsChanged\"\n                pause-label$=\"[[pauseLabel]]\"\n                playing$=\"[[__playing]]\"\n                play-label$=\"[[playLabel]]\"\n              >\n              </a11y-media-play-button>\n              <a11y-media-loader\n                id=\"loader\"\n                audio-only$=\"[[audioOnly]]\"\n                autoplay$=\"[[autoplay]]\"\n                cc$=\"[[cc]]\"\n                crossorigin$=\"[[crossorigin]]\"\n                hidden$=\"[[isYoutube]]\"\n                lang$=\"[[lang]]\"\n                loop$=\"[[loop]]\"\n                muted$=\"[[muted]]\"\n                manifest$=\"[[manifest]]\"\n                on-media-loaded=\"_handleMediaLoaded\"\n                playback-rate$=\"[[playbackRate]]\"\n                style$=\"[[_getThumbnailCSS(thumbnailSrc)]]\"\n                preload$=\"[[preload]]\"\n                volume$=\"[[volume]]\"\n              >\n                <slot></slot>\n              </a11y-media-loader>\n              <div\n                id=\"youtube\"\n                hidden$=\"[[!isYoutube]]\"\n                video-id$=\"[[videoId]]\"\n              ></div>\n              <div id=\"customcc\" hidden$=\"[[!showCustomCaptions]]\">\n                <span id=\"customcctxt\" hidden$=\"[[noHeight]]\"></span>\n              </div>\n            </div>\n          </div>\n          <paper-slider\n            id=\"slider\"\n            max$=\"[[__duration]]\"\n            on-dragging-changed=\"_handleSliderDragging\"\n            on-focused-changed=\"_handleSliderKeyboard\"\n            pin=\"\"\n            secondary-progress$=\"[[__buffered]]\"\n            value$=\"[[__elapsed]]\"\n          >\n          </paper-slider>\n        </div>\n        <a11y-media-controls\n          id=\"controls\"\n          audio-only$=\"[[audioOnly]]\"\n          audio-label$=\"[[audioLabel]]\"\n          captions-icon$=\"[[captionsIcon]]\"\n          captions-label$=\"[[captionsLabel]]\"\n          captions-menu-label$=\"[[captionsMenuLabel]]\"\n          captions-menu-off$=\"[[captionsMenuOff]]\"\n          cc$=\"[[cc]]\"\n          forward-icon$=\"[[forwardIcon]]\"\n          forward-label$=\"[[forwardLabel]]\"\n          fullscreen-icon$=\"[[fullscreenIcon]]\"\n          fullscreen-label$=\"[[fullscreenLabel]]\"\n          has-captions$=\"[[hasCaptions]]\"\n          has-transcript$=\"[[hasTranscript]]\"\n          lang$=\"[[uiLanguage]]\"\n          loop-icon$=\"[[loopIcon]]\"\n          loop-label$=\"[[loopLabel]]\"\n          mute-icon$=\"[[muteIcon]]\"\n          mute-label$=\"[[muteLabel]]\"\n          muted$=\"[[muted]]\"\n          on-controls-change=\"_onControlsChanged\"\n          pause-icon$=\"[[pauseIcon]]\"\n          pause-label$=\"[[pauseLabel]]\"\n          play-icon$=\"[[playIcon]]\"\n          play-label$=\"[[playLabel]]\"\n          playing$=\"[[__playing]]\"\n          restart-icon$=\"[[restartIcon]]\"\n          restart-label$=\"[[restartLabel]]\"\n          rewind-icon$=\"[[rewindIcon]]\"\n          rewind-label$=\"[[rewindLabel]]\"\n          search-transcript$=\"[[searchTranscript]]\"\n          settings-icon$=\"[[settingsIcon]]\"\n          settings-label$=\"[[settingsLabel]]\"\n          speed-label$=\"[[speedLabel]]\"\n          stand-alone$=\"[[standAlone]]\"\n          transcript-icon$=\"[[transcriptIcon]]\"\n          transcript-label$=\"[[transcriptLabel]]\"\n          transcript-menu-label$=\"[[transcriptMenuLabel]]\"\n          unmute-icon$=\"[[unmuteIcon]]\"\n          unmute-label$=\"[[unmuteLabel]]\"\n          video-label$=\"[[videoLabel]]\"\n          volume=\"[[__volume]]\"\n          volume-icon$=\"[[volumeIcon]]\"\n          volume-label$=\"[[volumeLabel]]\"\n        >\n        </a11y-media-controls>\n        <div\n          class=\"screen-only media-caption\"\n          aria-hidden=\"true\"\n          hidden$=\"[[!_hasAttribute(mediaCaption)]]\"\n        >\n          [[mediaCaption]]\n        </div>\n        <div class=\"print-only media-caption\">[[printCaption]]</div>\n      </div>\n      <img id=\"printthumb\" aria-hidden=\"true\" src$=\"[[thumbnailSrc]]\" />\n      <div id=\"outertranscript\" hidden$=\"[[standAlone]]\" lang$=\"[[uiLanguage]]\">\n        <div id=\"innertranscript\">\n          <a11y-media-transcript-controls\n            id=\"tcontrols\"\n            accent-color$=\"[[accentColor]]\"\n            auto-scroll-icon$=\"[[autoScrollIcon]]\"\n            auto-scroll-label$=\"[[autoScrollLabel]]\"\n            dark$=\"[[darkTranscript]]\"\n            disable-print-button$=\"[[disablePrintButton]]\"\n            disable-scroll$=\"[[disableScroll]]\"\n            disable-search$=\"[[disableSearch]]\"\n            lang$=\"[[uiLanguage]]\"\n            on-searchbar-added=\"_handleSearchAdded\"\n            on-toggle-scroll=\"_handleTranscriptScrollToggle\"\n            on-print-transcript=\"_handlePrinting\"\n            print-icon$=\"[[printIcon]]\"\n            print-label$=\"[[printLabel]]\"\n            stand-alone$=\"[[standAlone]]\"\n            search-label$=\"[[searchLabel]]\"\n            search-prev-label$=\"[[searchPrevLabel]]\"\n            search-prev-icon$=\"[[searchPrevIcon]]\"\n            search-next-label$=\"[[searchNextLabel]]\"\n            search-next-icon$=\"[[searchNextIcon]]\"\n            skip-transcript-link$=\"[[skipTranscriptLink]]\"\n          >\n          </a11y-media-transcript-controls>\n          <a11y-media-transcript\n            id=\"transcript\"\n            accent-color$=\"[[accentColor]]\"\n            dark$=\"[[darkTranscript]]\"\n            disable-scroll$=\"[[disableScroll]]\"\n            disable-search$=\"[[disableSearch]]\"\n            disable-interactive$=\"[[disableInteractive]]\"\n            hide-timestamps$=\"[[hideTimestamps]]\"\n            on-cue-seek=\"_handleCueSeek\"\n            search=\"[[search]]\"\n          >\n          </a11y-media-transcript>\n        </div>\n      </div>\n    "]);_templateObject_a2c40ec0fe4011e8b441311dd5f23f3e=function _templateObject_a2c40ec0fe4011e8b441311dd5f23f3e(){return data};return data}var A11yMediaPlayer=function(_A11yMediaPlayerPrope){var _Mathmax=Math.max;babelHelpers.inherits(A11yMediaPlayer,_A11yMediaPlayerPrope);function A11yMediaPlayer(){babelHelpers.classCallCheck(this,A11yMediaPlayer);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(A11yMediaPlayer).apply(this,arguments))}babelHelpers.createClass(A11yMediaPlayer,[{key:"connectedCallback",value:function connectedCallback(){babelHelpers.get(babelHelpers.getPrototypeOf(A11yMediaPlayer.prototype),"connectedCallback",this).call(this);var root=this;root.__playerAttached=!0;window.A11yMediaUtility.requestAvailability();root._addResponsiveUtility();window.dispatchEvent(new CustomEvent("a11y-player",{detail:root}));if(root.isYoutube){window.A11yMediaYoutubeUtility.requestAvailability();root._youTubeRequest()}}},{key:"ready",value:function ready(){var _this=this;babelHelpers.get(babelHelpers.getPrototypeOf(A11yMediaPlayer.prototype),"ready",this).call(this);var root=this,aspect=16/9,tracks=[];root.__playerReady=!0;root.__interactive=!root.disableInteractive;root.target=root.shadowRoot.querySelector("#transcript");root.__status=root.loadingLabel;root.__slider=root.$.slider;root.__volume=root.muted?0:_Mathmax(this.volume,10);root.__resumePlaying=!1;root.__showFullscreen=!this.disableFullscreen&&screenfull.enabled;root.__duration=0;root.$.controls.setStatus(root.__status);root.width=null!==root.width?root.width:"100%";root.style.maxWidth=null!==root.width?root.width:"100%";root.$.sources.style.paddingTop=100/aspect+"%";root.querySelectorAll("source,track").forEach(function(node){root.$.loader.media.appendChild(node)});if(this.isYoutube){root.disableInteractive=!0;this._youTubeRequest()}else{root.media=root.$.loader}root.$.transcript.setMedia(root.$.player);if(root.__showFullscreen){screenfull.on("change",function(){_this.fullscreen=screenfull.isFullscreen})}}},{key:"play",value:function play(e){var root=this;root.__playing=!0;if(e===void 0||e.detail===root.$.playbutton){root.__playProgress=setInterval(function(){root.__elapsed=0<root.media.getCurrentTime()?root.media.getCurrentTime():0;root.__duration=0<root.media.duration?root.media.duration:0;root._updateCustomTracks();root.__status=root._getHHMMSS(root.media.getCurrentTime(),root.__duration)+"/"+root._getHHMMSS(root.__duration);root.$.controls.setStatus(root.__status);if(root.__elapsed===root.__duration&&!root.loop){root.__playing=!1;clearInterval(root.__playProgress)}root.__buffered=root.media.getBufferedTime},1);window.dispatchEvent(new CustomEvent("a11y-player-playing",{detail:root}));root.media.play()}}},{key:"pause",value:function pause(){var root=this;root.__playing=!1;root.media.pause();clearInterval(root.__playProgress)}},{key:"stop",value:function stop(){this.pause();this.seek(0)}},{key:"restart",value:function restart(){this.seek(0);this.play()}},{key:"rewind",value:function rewind(amt){amt=amt!==void 0?amt:1;this.seek(_Mathmax(this.media.getCurrentTime()-amt,0))}},{key:"forward",value:function forward(amt){amt=amt!==void 0?amt:1;this.seek(Math.min(this.media.getCurrentTime()+amt,this.__duration))}},{key:"seek",value:function seek(time){var seekable=this.media!==void 0&&null!==this.media?this.media.seekable:[];if(0<seekable.length&&time>=seekable.start(0)&&time<=seekable.end(0)){this.media.seek(time);this.__elapsed=time;this.__status=this._getHHMMSS(this.media.getCurrentTime(),this.__duration)+"/"+this._getHHMMSS(this.__duration);this.$.controls.setStatus(this.__status);this._updateCustomTracks();if(this.__resumePlaying)this.play()}}},{key:"selectTrack",value:function selectTrack(index){this.$.loader.selectTrack(index);this.$.transcript.setActiveTranscript(index)}},{key:"setVolume",value:function setVolume(value){this.volume=null!==value?value:70;this.media.setVolume(this.volume);this.muted=0===this.volume}},{key:"setPlaybackRate",value:function setPlaybackRate(value){value=null!==value?value:1;this.media.setPlaybackRate(value)}},{key:"toggleCC",value:function toggleCC(mode){this.cc=mode===void 0?!this.cc:mode;this.$.loader.setCC(this.cc)}},{key:"toggleLoop",value:function toggleLoop(mode){if(this.isYoutube){}else{this.loop=mode===void 0?!this.loop:mode;this.media.setLoop(this.loop)}}},{key:"toggleMute",value:function toggleMute(mode){this.muted=mode===void 0?!this.muted:mode;this.__volume=this.muted?0:_Mathmax(this.volume,10);this.media.setMute(this.muted)}},{key:"toggleSticky",value:function toggleSticky(mode){mode=mode===void 0?!this.sticky:mode;this.sticky=mode;this.dispatchEvent(new CustomEvent("player-sticky",{detail:this}))}},{key:"toggleTranscript",value:function toggleTranscript(mode){mode=mode===void 0?this.hideTranscript:mode;this.hideTranscript=!mode;if(this.$.transcript!==void 0&&null!==this.$.transcript){this.dispatchEvent(new CustomEvent("transcript-toggle",{detail:this}));this.$.transcript.toggleHidden(this.hideTranscript)}}},{key:"_getMediaCaption",value:function _getMediaCaption(audioOnly,audioLabel,mediaTitle){var hasMediaTitle=mediaTitle!==void 0&&null!==mediaTitle&&""!==mediaTitle;if(audioOnly&&hasMediaTitle){return mediaTitle+" ("+audioLabel+")"}else if(audioOnly){return audioLabel}else if(hasMediaTitle){return mediaTitle}else{return null}}},{key:"_getPrintCaption",value:function _getPrintCaption(audioOnly,audioLabel,videoLabel,mediaTitle){var hasMediaTitle=mediaTitle!==void 0&&null!==mediaTitle&&""!==mediaTitle;if(audioOnly&&hasMediaTitle){return mediaTitle+" ("+audioLabel+")"}else if(audioOnly){return audioLabel}else if(hasMediaTitle){return mediaTitle+" ("+videoLabel+")"}else{return videoLabel}}},{key:"_getThumbnailCSS",value:function _getThumbnailCSS(thumbnailSrc){return null!=thumbnailSrc?"background-image: url("+thumbnailSrc+"); background-size: cover;":null}},{key:"_getTrackData",value:function _getTrackData(){var root=this,media=root.$.loader.media,tdata=[],selected=0;root.hasTranscript=!root.standAlone;for(var _loop=function _loop(i){if(null!==media.textTracks[i]){var track=media.textTracks[i],tidata={},loaded=track.cues!==void 0,complete=0,label=track.label,lang=track.language,text=label!==void 0?label:lang!==void 0?lang:"Track "+i,cues,loadCueData=setInterval(function(){track.mode="showing";if(track.cues!==void 0&&0<track.cues.length){track.mode="hidden";getCueData();clearInterval(loadCueData)}},1),getCueData=function getCueData(){track.mode="hidden";var cues=Object.keys(track.cues).map(function(key){return{order:""!==track.cues[key].id?track.cues[key].id:key,seek:track.cues[key].startTime,seekEnd:track.cues[key].endTime,start:root._getHHMMSS(track.cues[key].startTime,root.media.duration),end:root._getHHMMSS(track.cues[key].endTime,root.media.duration),text:track.cues[key].text}});tidata={text:text,language:lang,value:i,cues:cues};tdata.push(tidata);root.set("tracks",tdata);root.$.controls.setTracks(tdata);root.$.transcript.setTracks(tdata);root.selectTrack(track.default?i:0);track.oncuechange=function(e){root.$.transcript.setActiveCues(Object.keys(e.currentTarget.activeCues).map(function(key){return e.currentTarget.activeCues[key].id}))}}}},i=0;i<media.textTracks.length;i++){_loop(i)}if(0<media.textTracks.length){root.hasCaptions=!0}else{root.standAlone=!0}}},{key:"_handleCueSeek",value:function _handleCueSeek(e){var root=this;if(!root.standAlone&&root.$.transcript!==void 0&&null!==root.$.transcript){root.__resumePlaying=root.__playing;root.seek(e.detail)}}},{key:"_handleMediaLoaded",value:function _handleMediaLoaded(e){var root=this,aspect=root.media.aspectRatio;root.$.sources.style.paddingTop=100/aspect+"%";root.$.playbutton.removeAttribute("disabled");root.__duration=0<root.media.duration?root.media.duration:0;root.__status=root._getHHMMSS(0,root.media.duration)+"/"+root._getHHMMSS(root.media.duration);root.$.controls.setStatus(root.__status);root._getTrackData(root.$.loader.media)}},{key:"_handlePrinting",value:function _handlePrinting(e){var root=this;root.dispatchEvent(new CustomEvent("printing-transcript",{detail:root}));root.$.transcript.print(root.mediaTitle)}},{key:"_handleSearchAdded",value:function _handleSearchAdded(e){this.search=e.detail}},{key:"_handleSliderDragging",value:function _handleSliderDragging(e){var root=this;root._toggleSliderSeek(root.$.slider.dragging,root.$.slider.immediateValue)}},{key:"_handleSliderKeyboard",value:function _handleSliderKeyboard(e){var root=this;root._toggleSliderSeek(root.$.slider.focused,root.$.slider.value)}},{key:"_handleTranscriptScrollToggle",value:function _handleTranscriptScrollToggle(e){this.disableScroll=!this.disableScroll}},{key:"_onControlsChanged",value:function _onControlsChanged(e){var root=this,action=e.detail.label!==void 0?e.detail.label:e.detail.id;if("backward"===action||action===root.rewindLabel){root.rewind(root.__duration/20)}else if("closed captions"===action||"captions"===action||action===root.captionsLabel||action===root.captionsMenuLabel){root.toggleCC()}else if("transcript"===action||"transcript-toggle"===action||action===root.transcriptLabel||action===root.transcriptMenuLabel){root.toggleTranscript()}else if("tracks"===e.detail.id){if(""===e.detail.value){root.toggleCC(!1)}else{root.toggleCC(!0);root.selectTrack(e.detail.value)}}else if("forward"===action||action===root.forwardLabel){root.forward(root.__duration/20)}else if("full screen"===action||action===root.fullscreenLabel){this.toggleTranscript(this.fullscreen);screenfull.toggle(root.$.outerplayer)}else if("loop"===action||action===root.loopLabel){root.toggleLoop()}else if("mute"===action||"unmute"===action||action===root.muteLabel||action===root.unmuteLabel){root.toggleMute()}else if("pause"===action||action===root.pauseLabel){root.pause()}else if("play"===action||action===root.playLabel){root.play()}else if("restart"===action||action===root.restartLabel){root.seek(0);root.play()}else if("speed"===action||action===root.speedLabel){root.setPlaybackRate(e.detail.value)}else if("volume"===action||action===root.volumeLabel){root.setVolume(e.detail.value)}}},{key:"_toggleSliderSeek",value:function _toggleSliderSeek(seeking,value){if(seeking){if(this.__playing)this.__resumePlaying=!0;this.pause()}else{this.seek(value);this.__resumePlaying=!1}}},{key:"_youTubeRequest",value:function _youTubeRequest(){var root=this,ytUtil=window.A11yMediaYoutubeUtility.instance;if(root.__playerAttached&&root.__playerReady){var ytInit=function ytInit(){root.media=ytUtil.initYoutubePlayer({width:"100%",height:"100%",videoId:root.youtubeId});root.$.youtube.appendChild(root.media.a);root._getTrackData(root.$.loader.media);root._updateCustomTracks();var int=setInterval(function(){if(root.media.getDuration!==void 0){clearInterval(int);root.__duration=root.media.duration=root.media.getDuration();root.__status=root._getHHMMSS(0,root.media.duration)+"/"+root._getHHMMSS(root.media.duration);root.$.controls.setStatus(root.__status);root.disableInteractive=!root.__interactive}},100)},checkApi=function checkApi(e){if(ytUtil.apiReady){document.removeEventListener("youtube-api-ready",checkApi);ytInit()}};if(ytUtil.apiReady){ytInit()}else{document.addEventListener("youtube-api-ready",checkApi)}}}},{key:"_updateCustomTracks",value:function _updateCustomTracks(){if(this._hasCustomCaptions(this.isYoutube,this.audioOnly,this.tracks)){var root=this,track=root.tracks[this.$.transcript.selectedTranscript],active=[],caption="";if(track!==void 0&&null!==track&&track.cues!==void 0&&null!==track.cues){for(var i=0;i<track.cues.length;i++){if(track.cues[i].seek<root.__elapsed&&track.cues[i].seekEnd>root.__elapsed){active.push(track.cues[i].order);caption=""===caption?track.cues[i].text:caption}}root.$.customcctxt.innerText=caption;root.$.audiocc.innerText=caption;root.$.transcript.setActiveCues(active)}}}}],[{key:"tag",get:function get(){return"a11y-media-player"}},{key:"properties",get:function get(){return{mediaCaption:{type:String,computed:"_getMediaCaption(audioOnly,audioLabel,mediaTitle)"},printCaption:{type:String,computed:"_getPrintCaption(audioOnly,audioLabel,videoLabel,mediaTitle)"},sticky:{type:Boolean,value:!1,reflectToAttribute:!0},stickyCorner:{type:String,value:"top-right",reflectToAttribute:!0}}}},{key:"behaviors",get:function get(){return[_a11yMediaPlayerProperties.A11yMediaPlayerProperties]}},{key:"template",get:function get(){return(0,_polymerElement.html)(_templateObject_a2c40ec0fe4011e8b441311dd5f23f3e())}}]);return A11yMediaPlayer}(_a11yMediaPlayerProperties.A11yMediaPlayerProperties);_exports.A11yMediaPlayer=A11yMediaPlayer;window.customElements.define(A11yMediaPlayer.tag,A11yMediaPlayer)});